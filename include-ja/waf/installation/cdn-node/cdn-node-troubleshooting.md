### CDNノードのステータスは何を意味しますか?

CDNノードには、Wallarm Console → **Nodes**に次のステータスが表示される場合があります:

* **Registering**: WallarmがクラウドプロバイダにCDNノードを登録しています。

    必要な対応:**Requires CNAME**ステータスになり、保護対象ドメインのDNSレコードにWallarmのCNAMEレコードを追加できるようになるまでお待ちください。
* **Requires CNAME**: 保護対象ドメインのDNSレコードにWallarmのCNAMEレコードが追加されていないか、追加済みでもまだ伝播していません。

    必要な対応:Wallarmが提供するCNAMEレコードを保護対象ドメインのDNSレコードに追加するか、変更がインターネット上で有効になるまでお待ちください。
    
    変更が24時間以上経過しても有効にならない場合は、ドメインプロバイダでDNSレコードが正常に更新されたことを確認してください。正しく更新されているのにWallarm Consoleに**Not propagated yet**ステータスが引き続き表示される場合は、[Wallarmテクニカルサポート](mailto:support@wallarm.com)にご連絡ください。

    次に遷移する想定のステータスは**Active**です。
* **Configuring**: Wallarmが変更されたオリジンアドレスまたはSSL/TLS証明書を処理しています。

    必要な対応:**Active**ステータスになるまでお待ちください。
* **Active**: WallarmのCDNノードが悪意のあるトラフィックをブロックします。

    必要な対応:ありません。CDNノードが検知した[イベント][events-docs]を監視できます。
* **Deleting**: WallarmがCDNノードを削除しています。

    必要な対応:ありません。削除の完了までお待ちください。

### CNAMEレコードが伝播したかどうかはどのように確認しますか?

Wallarm Consoleの**Nodes**セクションには、WallarmのCNAMEレコードがインターネット上で有効になっているかどうかの実際の状態が表示されます。CNAMEレコードが伝播している場合、CDNノードのステータスは**Active**です。

加えて、次のリクエストでHTTPレスポンスヘッダーを確認できます:

```bash
curl -v <PROTECTED_DOMAIN>
```

WallarmのCNAMEレコードが伝播している場合、レスポンスには`section-io-*`ヘッダーが含まれます。

CNAMEレコードが24時間以上伝播しない場合は、ドメインプロバイダでDNSレコードが正常に更新されたことを確認してください。正しく更新されているのにWallarm Consoleに**Not propagated yet**ステータスが引き続き表示される場合は、[Wallarmテクニカルサポート](mailto:support@wallarm.com)にご連絡ください。

### **Nodes**セクションでCDNノードが赤く強調表示されています。これは何を意味しますか?

**Nodes**セクションでCDNノードが赤く強調表示されている場合、次のような理由により、登録または構成の処理中にエラーが発生しています:

* サードパーティのクラウドプロバイダでノードを登録する際の不明なエラー

    必要な対応:[Wallarmテクニカルサポート](mailto:support@wallarm.com)にご連絡ください。
* 無効なカスタムSSL/TLS証明書

    必要な対応:アップロードした証明書が有効であることを確認してください。有効でない場合は、有効な証明書をアップロードしてください。

赤く強調表示されているCDNノードはリクエストをプロキシしないため、結果として悪意のあるトラフィックをブロックしません。

### なぜWallarm Consoleのノード一覧からCDNノードが消えることがあるのですか?

Wallarmは、ノード作成時から10日以上CNAMEレコードが未変更のCDNノードを削除します。

CDNノードが消えている場合は、新しいノードを作成してください。

### CDNノードで保護されているコンテンツの更新に遅延が発生するのはなぜですか?

サイトがCDNノードで保護されていて、データを変更してからサイトの更新に明らかな遅延がある場合、その原因として、コンテンツ配信を高速化する[Varnish Cache][using-varnish-cache]により、CDN上のキャッシュコピーの更新が遅れることが考えられます。

例:

1. CDNノードでVarnish Cacheを有効にしています。
1. サイトの価格を更新しました。
1. すべてのリクエストはCDN経由でプロキシされ、キャッシュはすぐには更新されません。
1. サイトの利用者はしばらくの間、古い価格を目にします。

この問題を解消するには、Varnish Cacheを無効化できます。その場合は、**Nodes** → CDN node menu → **Disable Varnish Cache**に進んでください。