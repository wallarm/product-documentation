ابتداءً من الإصدار 3.6، يمكنك تهيئة كشف الهجمات `overlimit_res` باستخدام القاعدة في وحدة التحكم Wallarm.

في السابق، تم استخدام التوجيهات NGINX [`wallarm_process_time_limit`][nginx-process-time-limit-docs] و [`wallarm_process_time_limit_block`][nginx-process-time-limit-block-docs]. تُعتبر التوجيهات المذكورة مهجورة مع إصدار القاعدة الجديدة وسيتم حذفها في الإصدارات المستقبلية.

إذا تم تخصيص إعدادات كشف الهجمات `overlimit_res` عبر التوجيهات المذكورة، يُوصى بنقلها إلى القاعدة على النحو التالي:

1. افتح وحدة التحكم Wallarm → **القواعد** وتابع لتهيئة القاعدة [**تهيئة كشف الهجمات overlimit_res**][overlimit-res-rule-docs].
1. قم بتكوين القاعدة كما تم عبر التوجيهات NGINX:

    * يجب أن تطابق شرط القاعدة كتلة تكوين NGINX بالتوجيهات `wallarm_process_time_limit` و `wallarm_process_time_limit_block` المحددة.
    * الوقت المحدد للعقدة لمعالجة طلب واحد (بالمللي ثانية): قيمة `wallarm_process_time_limit`.
    * معالجة الطلب: يُوصى بخيار **إيقاف المعالجة**.
    
        !!! تحذير "خطر نفاد ذاكرة النظام"
            يمكن أن يؤدي الحد الزمني المرتفع و/أو استمرار معالجة الطلب بعد تجاوز الحد إلى استنفاد الذاكرة أو معالجة الطلب خارج الوقت المحدد.
    
    * تسجيل هجوم overlimit_res: يُوصى بخيار **تسجيل وعرض في الأحداث**.

        إذا كانت قيمة `wallarm_process_time_limit_block` أو `process_time_limit_block` هي `off`، اختر خيار **عدم إنشاء حدث هجوم**.
    
    * القاعدة لا تمتلك خيارًا مكافئًا صريحًا لتوجيه `wallarm_process_time_limit_block`. إذا قامت القاعدة بتعيين **تسجيل وعرض في الأحداث**، سوف تقوم العقدة إما بحظر أو تمرير هجوم `overlimit_res` بناءً على [وضع تصفية العقدة][waf-mode-instr]:

        * في وضع **المراقبة**، تقوم العقدة بتوجيه الطلب الأصلي إلى عنوان التطبيق. للتطبيق خطر التعرض للاستغلال من قبل الهجمات المتضمنة في كل من أجزاء الطلب المعالجة وغير المعالجة.
        * في وضع **الحظر الآمن**، تقوم العقدة بحظر الطلب إذا كان مصدره من عنوان IP في [القائمة الرمادية][graylist-docs]. وإلا، تقوم العقدة بتوجيه الطلب الأصلي إلى عنوان التطبيق. للتطبيق خطر التعرض للاستغلال من قبل الهجمات المتضمنة في كل من أجزاء الطلب المعالجة وغير المعالجة.
        * في وضع **الحظر**، تقوم العقدة بحظر الطلب.
1. احذف التوجيهات `wallarm_process_time_limit` و `wallarm_process_time_limit_block` NGINX من ملف تكوين NGINX.

    إذا تم تهيئة كشف الهجمات `overlimit_res` باستخدام كل من التوجيهات والقاعدة، فإن العقدة ستعالج الطلبات كما تحدد القاعدة.