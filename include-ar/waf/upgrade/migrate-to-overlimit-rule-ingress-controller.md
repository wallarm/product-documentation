ابتداءً من الإصدار 3.6، يمكنك تهيئة كشف هجمات `overlimit_res` باستخدام القاعدة في واجهة Wallarm.

قبلاً، تم استخدام تعليمات NGINX [`wallarm_process_time_limit`][nginx-process-time-limit-docs] و [`wallarm_process_time_limit_block`][nginx-process-time-limit-block-docs]. يُعتبر التوجيهات المذكورة منتهية الصلاحية مع إصدار القاعدة الجديدة وسيتم حذفها في الإصدارات المستقبلية.

إذا تم تخصيص إعدادات كشف هجمات `overlimit_res` عبر التوجيهات المذكورة، يُنصح بنقلها إلى القاعدة كالتالي:

1. افتح واجهة Wallarm → **القواعد** وتابع إلى إعداد قاعدة [**تهيئة كشف هجمات overlimit_res**][overlimit-res-rule-docs].
1. قم بتهيئة القاعدة كما هو متوقع عبر توجيهات NGINX:

    * يجب أن تتطابق شروط القاعدة مع كتلة التكوين NGINX مع تحديد التوجيهات `wallarm_process_time_limit` و `wallarm_process_time_limit_block`.
    * الحد الزمني للعقدة لمعالجة طلب واحد (بالميللي ثانية): قيمة `wallarm_process_time_limit`.
    * معالجة الطلب: تُنصح بخيار **إيقاف المعالجة**.
    
        !!! تحذير "خطر نفاد ذاكرة النظام"
             الحد الزمني المرتفع و/أو استمرار معالجة الطلب بعد تجاوز الحد قد يؤدي إلى استنزاف الذاكرة أو معالجة الطلب خارج الزمن المحدد.
    
    * تسجيل هجمات overlimit_res: يُنصح بخيار **التسجيل والعرض في الأحداث**.

        إذا كانت قيمة `wallarm_process_time_limit_block` أو `process_time_limit_block` هي `off`، اختر خيار **عدم إنشاء حدث هجمة**.
    
    * القاعدة لا تملك خيارًا مكافئًا صريحًا لتوجيه `wallarm_process_time_limit_block`. إذا ضبطت القاعدة على **التسجيل والعرض في الأحداث**، فإن العقدة إما ستحجب أو تسمح بهجمات `overlimit_res` حسب [وضع ترشيح العقدة][waf-mode-instr]:

        * في وضع **المراقبة**، تقوم العقدة بتمرير الطلب الأصلي إلى عنوان التطبيق. للتطبيق خطر أن يتم استغلاله بواسطة الهجمات المتضمنة في أجزاء الطلب المعالجة وغير المعالجة.
        * في وضع **الحجب الآمن**، تحجب العقدة الطلب إذا كان مصدره من عنوان IP مدرج في القائمة الرمادية. وإلا، تقوم العقدة بتمرير الطلب الأصلي إلى عنوان التطبيق. للتطبيق خطر أن يتم استغلاله بواسطة الهجمات المتضمنة في أجزاء الطلب المعالجة وغير المعالجة.
        * في وضع **الحجب**، تحجب العقدة الطلب.
1. احذف توجيهات `wallarm_process_time_limit` و `wallarm_process_time_limit_block` NGINX من ملف تكوين  `values.yaml`.

    إذا تم تهيئة كشف هجمات `overlimit_res` باستخدام كل من التوجيهات والقاعدة، فإن العقدة ستعالج الطلبات حسب ما تضعه القاعدة.