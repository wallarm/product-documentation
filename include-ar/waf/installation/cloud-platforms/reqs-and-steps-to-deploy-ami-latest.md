## المتطلبات

* حساب AWS
* فهم لخصائص AWS EC2 ومجموعات الأمان
* أي منطقة AWS من اختيارك، لا توجد قيود محددة على المنطقة لنشر عقدة Wallarm
* الوصول للحساب بدور **المدير** والتوثيق الثنائي معطل في وحدة تحكم Wallarm لـ[السحابة الأمريكية](https://us1.my.wallarm.com/) أو [السحابة الأوروبية](https://my.wallarm.com/)
* الوصول إلى `https://us1.api.wallarm.com:444` للعمل مع سحابة Wallarm الأمريكية أو إلى `https://api.wallarm.com:444` للعمل مع سحابة Wallarm الأوروبية. إذا كان يمكن تكوين الوصول عبر خادم بروكسي فقط، استخدم [التعليمات][wallarm-api-via-proxy]
* تنفيذ جميع الأوامر على عينة Wallarm كمستخدم متفوق (مثل `root`)

## 1. إنشاء زوج من مفاتيح SSH في AWS

أثناء عملية النشر، ستحتاج إلى الاتصال بالجهاز الافتراضي عبر SSH. يسمح Amazon EC2 بإنشاء زوج من المفاتيح العمومية والخاصة باسم محدد يُستخدم للاتصال بالمثال.

لإنشاء زوج المفاتيح:

1. انتقل إلى تبويب **مفاتيح زوجية** على لوحة معلومات Amazon EC2.
2. انقر على زر **إنشاء زوج المفاتيح**.
3. أدخل اسم زوج المفاتيح وانقر على زر **إنشاء**.

سيبدأ تحميل المفتاح الخاص بتنسيق PEM تلقائيًا. احفظ المفتاح للاتصال بالمثال المُنشأ في المستقبل.

لرؤية معلومات مفصلة حول إنشاء مفاتيح SSH، انتقل إلى [وثائق AWS][link-ssh-keys].

## 2. إنشاء مجموعة أمان

تحدد مجموعة الأمان الاتصالات الواردة والصادرة المسموح بها والممنوعة للأجهزة الافتراضية. يعتمد القائمة النهائية للاتصالات على التطبيق المحمي (مثل السماح بجميع الاتصالات الواردة إلى منافذ TCP/80 وTCP/443).

لإنشاء مجموعة أمان لعقدة التصفية:

1. انتقل إلى تبويب **مجموعات الأمان** على لوحة معلومات Amazon EC2 وانقر على زر **إنشاء مجموعة أمان**.
2. أدخل اسم لمجموعة الأمان ووصف اختياري في نافذة الحوار التي تظهر.
3. حدد VPC المطلوب.
4. قم بتكوين قواعد الاتصالات الواردة والصادرة على التبويبات **الوارد** و**الصادر**.
5. انقر على زر **إنشاء** لإنشاء مجموعة الأمان.

![إنشاء مجموعة أمان][img-create-sg]

!!! تحذير "قواعد الاتصالات الصادرة من مجموعة الأمان"
    عند إنشاء مجموعة أمان، جميع الاتصالات الصادرة مسموح بها بشكل افتراضي. إذا كنت تقيد الاتصالات الصادرة من عقدة التصفية، تأكد من منحها الوصول إلى خادم API Wallarm. اختيار خادم API Wallarm يعتمد على السحابة Wallarm التي تستخدمها:

    * إذا كنت تستخدم السحابة الأمريكية، يجب أن تُمنَح عقدتك الوصول إلى `us1.api.wallarm.com`.
    * إذا كنت تستخدم السحابة الأوروبية، يجب أن تُمنَح عقدتك الوصول إلى `api.wallarm.com`.
    
    تحتاج عقدة التصفية للوصول إلى خادم API Wallarm للعمل بشكل صحيح.

لرؤية معلومات مفصلة حول إنشاء مجموعة أمان، انتقل إلى [وثائق AWS][link-sg].

## 3. إطلاق عينة عقدة Wallarm

لإطلاق عينة بعقدة تصفية Wallarm، انتقل إلى هذا [الرابط](https://aws.amazon.com/marketplace/pp/B073VRFXSD) واشترك في عقدة التصفية.

عند إنشاء عينة، تحتاج إلى تحديد [مجموعة الأمان التي تم إنشاؤها سابقًا][anchor1] على النحو التالي:

1. أثناء العمل مع معالج إطلاق العينة، انتقل إلى خطوة إطلاق عينة **6. تكوين مجموعة الأمان** عبر النقر على التبويب المناسب.
2. اختر خيار **اختيار مجموعة أمان موجودة** في إعداد **تعيين مجموعة أمان**.
3. حدد مجموعة الأمان من القائمة التي تظهر.

بعد تحديد جميع إعدادات العينة المطلوبة، انقر على زر **مراجعة وإطلاق**، تأكد من صحة تكوين العينة، وانقر على زر **إطلاق**.

في النافذة التي تظهر، حدد [زوج المفاتيح الذي تم إنشاؤه مسبقًا][anchor2] بأداء الإجراءات التالية:

1. في القائمة المنسدلة الأولى، حدد خيار **اختيار زوج مفاتيح موجود**.
2. في القائمة المنسدلة الثانية، حدد اسم زوج المفاتيح.
3. تأكد من الوصول إلى المفتاح الخاص بتنسيق PEM من زوج المفاتيح الذي حددته في القائمة المنسدلة الثانية واختر المربع لتأكيد ذلك.
4. انقر على زر **إطلاق العينات**.

سيتم إطلاق العينة بعقدة التصفية المثبتة مسبقًا.

لرؤية معلومات مفصلة حول إطلاق العينات في AWS، انتقل إلى [وثائق AWS][link-launch-instance].

## 4. الاتصال بعينة عقدة التصفية عبر SSH

لرؤية معلومات مفصلة حول طرق الاتصال عبر SSH بالعينة، انتقل إلى [وثائق AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstances.html).

تحتاج إلى استخدام اسم المستخدم `admin` للاتصال بالعينة.

!!! معلومات "استخدام المفتاح للاتصال عبر SSH"
    استخدم المفتاح الخاص بتنسيق PEM الذي [أنشأته سابقًا][anchor2] للاتصال بالعينة عبر SSH. يجب أن يكون هذا المفتاح الخاص من زوج مفاتيح SSH الذي حددته عند إنشاء عينة.

## 5. توليد رمز لربط عينة بسحابة Wallarm

تحتاج العقدة المحلية لتصفية Wallarm إلى الاتصال بسحابة Wallarm باستخدام رمز Wallarm من [النوع المناسب][wallarm-token-types]. يتيح رمز API إنشاء مجموعة عقد في واجهة مستخدم وحدة تحكم Wallarm، مما يساعد في تنظيم عينات العقد الخاصة بك بفعالية.

![عقد مجمعة][img-grouped-nodes]

ولتوليد رمز:

=== "رمز API"

    1. افتح وحدة تحكم Wallarm → **الإعدادات** → **رموز API** في [السحابة الأمريكية](https://us1.my.wallarm.com/settings/api-tokens) أو [السحابة الأوروبية](https://my.wallarm.com/settings/api-tokens).
    1. ابحث أو أنشئ رمز API بدور المصدر `Deploy`.
    1. انسخ هذا الرمز.
=== "رمز العقدة"

    1. افتح وحدة تحكم Wallarm → **العقد** في [السحابة الأمريكية](https://us1.my.wallarm.com/nodes) أو [السحابة الأوروبية](https://my.wallarm.com/nodes).
    1. قم بإحدى الإجراءات التالية: 
        * أنشئ عقدة من نوع **عقدة Wallarm** وانسخ الرمز الذي تم توليده.
        * استخدم مجموعة عقد موجودة - انسخ الرمز باستخدام قائمة العقدة → **انسخ الرمز**.