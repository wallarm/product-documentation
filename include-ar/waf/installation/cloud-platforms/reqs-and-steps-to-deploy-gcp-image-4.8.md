## المتطلبات

* حساب GCP
* الوصول إلى الحساب بدور **المدير** وتعطيل المصادقة الثنائية في واجهة Wallarm لـ [السحابة الأمريكية](https://us1.my.wallarm.com/) أو [السحابة الأوروبية](https://my.wallarm.com/)
* الوصول إلى `https://us1.api.wallarm.com:444` للعمل مع سحابة Wallarm الأمريكية أو إلى `https://api.wallarm.com:444` للعمل مع سحابة Wallarm الأوروبية.  إذا يمكن تكوين الوصول فقط عبر خادوم الوكيل، فيُرجى استخدام [التعليمات][wallarm-api-via-proxy]
* تنفيذ جميع الأوامر على كيان Wallarm كالمستخدم الأعلى صلاحيات (مثلاً `root`)

## 1. إطلاق كيان عُقدة التصفية

### إطلاق الكيان عبر واجهة Google Cloud

لإطلاق كيان عُقدة التصفية عبر واجهة Google Cloud، يُرجى فتح [صورة عُقدة Wallarm على سوق Google Cloud](https://console.cloud.google.com/launcher/details/wallarm-node-195710/wallarm-node) والنقر على **ابدأ**.

سيتم إطلاق الكيان مع عُقدة تصفية مُثبتة مُسبقًا. لمشاهدة معلومات مفصلة عن إطلاق الكيانات في Google Cloud، يُرجى المُتابعة إلى [وثائق Google Cloud Platform الرسمية][link-launch-instance].

### إطلاق الكيان عبر Terraform أو أدوات أخرى

عند استخدام أداة مثل Terraform لإطلاق كيان عُقدة التصفية باستخدام صورة Wallarm GCP، قد تحتاج إلى تزويد اسم هذه الصورة في تكوين Terraform.

* لاسم الصورة يكون بالتنسيق التالي:

    ```bash
    wallarm-node-195710/wallarm-node-<إصدار_الصورة>-build
    ```
* لإطلاق الكيان بإصدار عُقدة التصفية 4.8، يُرجى استخدام اسم الصورة التالي:

    ```bash
    wallarm-node-195710/wallarm-node-4-8-20231019-221905
    ```

للحصول على اسم الصورة، يُمكنك أيضاً اتباع الخطوات التالية:

1. تثبيت [Google Cloud SDK](https://cloud.google.com/sdk/docs/install).
2. تنفيذ الأمر [`gcloud compute images list`](https://cloud.google.com/sdk/gcloud/reference/compute/images/list) مع الباراميترات التالية:

    ```bash
    gcloud compute images list --project wallarm-node-195710 --filter="name~'wallarm-node-4-8-*'" --no-standard-images
    ```
3. نسخ قيمة الإصدار من اسم أحدث صورة متاحة ولصق القيمة المنسوخة في تنسيق اسم الصورة المُزود. على سبيل المثال، سيكون لإصدار عُقدة التصفية 4.8 الاسم التالي:

    ```bash
    wallarm-node-195710/wallarm-node-4-8-20231019-221905
    ```

## 2. تكوين كيان عُقدة التصفية

قم بالإجراءات التالية لتكوين الكيان الذى تم إطلاقه لعُقدة التصفية:

1.  التوجه إلى صفحة **VM instances** في قسم **Compute Engine** من القائمة.
2.  تحديد كيان عُقدة التصفية المُطلق والنقر على زر **تحرير**.
3.  السماح بأنواع الحركة الواردة المطلوبة عن طريق وضع علامة في المربعات المقابلة في إعداد **جدران الحماية**.
4.  إذا لزم الأمر، يُمكنك تقييد الاتصال بالكيان باستخدام مفاتيح SSH الخاصة بالمشروع واستخدام زوج من مفاتيح SSH المخصصة للاتصال بهذا الكيان. للقيام بذلك، قم بالإجراءات التالية:
    1.  وضع علامة في المربع **حظر على مستوى المشروع** في إعداد **مفاتيح SSH**.
    2.  النقر على زر **إظهار وتعديل** في إعداد **مفاتيح SSH** لتوسيع الحقل لإدخال مفتاح SSH.
    3.  توليد زوج من مفاتيح SSH العامة والخاصة. على سبيل المثال، يُمكنك استخدام أدوات `ssh-keygen` و`PuTTYgen`.
       
        ![توليد مفاتيح SSH باستخدام PuTTYgen][img-ssh-key-generation]

    4.  نسخ مفتاح مفتوح بتنسيق OpenSSH من واجهة مولد المفاتيح المستخدمة (في المثال الحالي، يجب نسخ المفتاح العام من منطقة **مفتاح عام للصق في ملف OpenSSH authorized_keys** بواجهة PuTTYgen) ولصقه في الحقل الذي يحتوي على تلميح **أدخل بيانات المفتاح كاملة**.
    5.  حفظ المفتاح الخاص. سيكون مطلوب للاتصال بالكيان المُكون في المستقبل.
5.  النقر على زر **حفظ** في أسفل الصفحة لتطبيق التغييرات.

## 3. الاتصال بكيان عُقدة التصفية عبر SSH

لمشاهدة معلومات مفصلة عن طرق الاتصال بالكيانات، يُرجى الانتقال إلى هذا [الرابط](https://cloud.google.com/compute/docs/instances/connecting-to-instance).

--8<-- "../include/gcp-autoscaling-connect-ssh.md"

## 4. ربط عُقدة التصفية بسحابة Wallarm

--8<-- "../include/waf/installation/connect-waf-and-cloud-4.6-only-with-postanalytics.md"