## المتطلبات

* حساب AWS
* فهم لـ AWS EC2، ومجموعات الأمان
* أي منطقة AWS من اختيارك، ليس هناك قيود محددة على المنطقة لنشر عقدة Wallarm
* الوصول إلى الحساب بدور **المدير** والمصادقة الثنائية معطلة في وحدة تحكم Wallarm لـ[السحابة الأمريكية](https://us1.my.wallarm.com/) أو [السحابة الأوروبية](https://my.wallarm.com/)
* الوصول إلى `https://us1.api.wallarm.com:444` للعمل مع سحابة Wallarm الأمريكية أو إلى `https://api.wallarm.com:444` للعمل مع سحابة Wallarm الأوروبية. إذا كان يمكن تكوين الوصول عبر خادم الوكيل فقط، فاستخدم [التعليمات][wallarm-api-via-proxy]
* تنفيذ جميع الأوامر على عقدة Wallarm كمستخدم ذو صلاحيات عليا (مثل `root`)

## 1. إنشاء زوج من مفاتيح SSH في AWS

أثناء عملية النشر، ستحتاج إلى الاتصال بالجهاز الافتراضي عبر SSH. يتيح Amazon EC2 إنشاء زوج مسمى من المفاتيح العامة والخاصة لـ SSH والتي يمكن استخدامها للاتصال بالعقدة.

لإنشاء زوج من المفاتيح:

1. انتقل إلى علامة التبويب **مفاتيح الزوج** على لوحة تحكم Amazon EC2.
2. اضغط على زر **إنشاء زوج مفاتيح**.
3. أدخل اسم زوج المفاتيح واضغط على زر **إنشاء**.

سيبدأ تلقائيًا تنزيل مفتاح SSH الخاص بتنسيق PEM. احفظ المفتاح للاتصال بالعقدة التي تم إنشاؤها في المستقبل.

للاطلاع على معلومات مفصلة حول إنشاء مفاتيح SSH، انتقل إلى [وثائق AWS][link-ssh-keys].

## 2. إنشاء مجموعة أمان

تحدد مجموعة الأمان الاتصالات الواردة والصادرة المسموح بها والممنوعة للأجهزة الافتراضية. تعتمد القائمة النهائية للاتصالات على التطبيق المحمي (مثل، السماح بجميع الاتصالات الواردة إلى منافذ TCP/80 و TCP/443).

لإنشاء مجموعة أمان لعقدة التصفية:

1. انتقل إلى علامة التبويب **مجموعات الأمان** على لوحة تحكم Amazon EC2 واضغط على زر **إنشاء مجموعة أمان**.
2. أدخل اسم مجموعة الأمان ووصف اختياري في نافذة الحوار التي تظهر.
3. اختر VPC المطلوبة.
4. قم بتكوين قواعد الاتصالات الواردة والصادرة على علامات التبويب **الوارد** و**الصادر**.
5. اضغط على زر **إنشاء** لإنشاء مجموعة الأمان.

![إنشاء مجموعة أمان][img-create-sg]

!!! تحذير "قواعد الاتصالات الصادرة من مجموعة الأمان"
    عند إنشاء مجموعة أمان، تُسمح جميع الاتصالات الصادرة بشكل افتراضي. إذا كنت تقيد الاتصالات الصادرة من عقدة التصفية، تأكد من أنه تم منحها الوصول إلى خادم API Wallarm. يعتمد اختيار خادم API Wallarm على السحابة Wallarm التي تستخدمها:

    *   إذا كنت تستخدم السحابة الأمريكية، تحتاج عقدتك إلى الوصول إلى `us1.api.wallarm.com`.
    *   إذا كنت تستخدم السحابة الأوروبية، تحتاج عقدتك إلى الوصول إلى `api.wallarm.com`.
    
    تحتاج عقدة التصفية إلى الوصول إلى خادم API Wallarm للعمل بشكل صحيح.

للاطلاع على معلومات مفصلة حول إنشاء مجموعة أمان، انتقل إلى [وثائق AWS][link-sg].

## 3. إطلاق عقدة Wallarm

لإطلاق عقدة بخاصية تصفية Wallarm، انتقل إلى هذا [الرابط](https://aws.amazon.com/marketplace/pp/B073VRFXSD) واشترك في عقدة التصفية.

عند إنشاء عقدة، تحتاج إلى تحديد [مجموعة الأمان المُنشأة مسبقًا][anchor1] كما يلي:

1. أثناء العمل مع معالج إطلاق العقدة، انتقل إلى خطوة إطلاق العقدة **6. تكوين مجموعة الأمان** بالنقر على علامة التبويب المقابلة.
2. اختر خيار **تحديد مجموعة أمان موجودة** في إعداد **تعيين مجموعة أمان**.
3. حدد مجموعة الأمان من القائمة التي تظهر.

بعد تحديد جميع إعدادات العقدة المطلوبة، اضغط على زر **مراجعة وإطلاق**، تأكد من تكوين العقدة بشكل صحيح، واضغط على زر **إطلاق**.

في النافذة التي تظهر، حدد مفتاح [الزوج المُنشأ مسبقًا][anchor2] من خلال القيام بالإجراءات التالية:

1. في القائمة المنسدلة الأولى، حدد خيار **اختيار زوج مفاتيح موجود**.
2. في القائمة المنسدلة الثانية، حدد اسم زوج المفاتيح.
3. تأكد من أن لديك الوصول إلى المفتاح الخاص بتنسيق PEM من زوج المفاتيح الذي حددته في القائمة المنسدلة الثانية وضع علامة في المربع لتأكيد ذلك.
4. اضغط على زر **إطلاق العقد**.

سيتم إطلاق العقدة مع عقدة التصفية المثبتة مسبقًا.

للاطلاع على معلومات مفصلة حول إطلاق العقد في AWS، انتقل إلى [وثائق AWS][link-launch-instance].

## 4. الاتصال بعقدة التصفية عبر SSH

للاطلاع على معلومات مفصلة حول طرق الاتصال بعقدة عبر SSH، انتقل إلى [وثائق AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstances.html).

تحتاج إلى استخدام اسم المستخدم `admin` للاتصال بالعقدة.

!!! معلومات "استخدام المفتاح للاتصال عبر SSH"
    استخدم المفتاح الخاص بتنسيق PEM الذي [أنشأته سابقًا][anchor2] للاتصال بالعقدة عبر SSH. يجب أن يكون هذا هو المفتاح الخاص من زوج مفاتيح SSH الذي حددته عند إنشاء عقدة.

## 5. ربط عقدة التصفية بسحابة Wallarm

--8<-- "../include/waf/installation/connect-waf-and-cloud-4.6-only-with-postanalytics.md"