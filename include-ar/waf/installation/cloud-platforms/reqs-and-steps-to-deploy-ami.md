## المتطلبات

* حساب AWS
* فهم لـ AWS EC2، مجموعات الأمان
* أي منطقة AWS من اختيارك، لا توجد قيود محددة على المنطقة لنشر عقدة Wallarm
* الوصول إلى الحساب بدور **المدير** وتعطيل المصادقة الثنائية في وحدة التحكم الخاصة بـ Wallarm لـ [السحابة الأمريكية](https://us1.my.wallarm.com/) أو [السحابة الأوروبية](https://my.wallarm.com/)
* الوصول إلى `https://us1.api.wallarm.com:444` للعمل مع سحابة Wallarm الأمريكية أو إلى `https://api.wallarm.com:444` للعمل مع سحابة Wallarm الأوروبية. إذا يُمكن تكوين الوصول عبر خادم الوكيل فقط، فاستخدم [التعليمات][wallarm-api-via-proxy]
* تنفيذ جميع الأوامر على عقدة Wallarm كمستخدم متميز (مثل `root`)

## 1. إنشاء زوج من مفاتيح SSH في AWS

خلال عملية النشر، ستحتاج إلى الاتصال بالجهاز الافتراضي عبر SSH. يتيح Amazon EC2 إنشاء زوج من مفاتيح SSH العامة والخاصة باسم يُمكن استخدامه للاتصال بالنموذج.

لإنشاء زوج من المفاتيح:

1. التنقل إلى علامة التبويب **Key pairs** على لوحة تحكم Amazon EC2.
2. انقر على زر **Create Key Pair**.
3. أدخل اسم زوج المفاتيح وانقر على زر **Create**.

سيبدأ تنزيل مفتاح SSH الخاص بتنسيق PEM تلقائيًا. احفظ المفتاح للاتصال بالنموذج المُنشأ في المستقبل.

للاطلاع على معلومات مفصلة حول إنشاء مفاتيح SSH، تابع إلى [وثائق AWS][link-ssh-keys].

## 2. إنشاء مجموعة أمان

تُعرف مجموعة الأمان بالاتصالات الواردة والصادرة المسموح بها والمحظورة للأجهزة الافتراضية. تعتمد القائمة النهائية للاتصالات على التطبيق المحمي (مثل، السماح بجميع الاتصالات الواردة إلى المنافذ TCP/80 وTCP/443).

لإنشاء مجموعة أمان لعقدة التصفية:

1. التنقل إلى علامة التبويب **Security Groups** على لوحة تحكم Amazon EC2 وانقر على زر **Create Security Group**.
2. أدخل اسم مجموعة الأمان ووصف اختياري في نافذة الحوار التي تظهر.
3. اختر VPC المطلوب.
4. قم بتكوين قواعد الاتصالات الواردة والصادرة في علامتي التبويب **Inbound** و**Outbound**.
5. انقر على زر **Create** لإنشاء مجموعة الأمان.

![](../img/create-sg)

!!! warning "قواعد الاتصالات الصادرة من مجموعة الأمان"
    عند إنشاء مجموعة أمان، يُسمح بجميع الاتصالات الصادرة افتراضيًا. إذا كنت تقيد الاتصالات الصادرة من عقدة التصفية، تأكد من أنها قد تم منحها الوصول إلى خادم API الخاص بـ Wallarm. يعتمد اختيار خادم API الخاص بـ Wallarm على سحابة Wallarm التي تستخدمها:

    *   إذا كنت تستخدم السحابة الأمريكية، تحتاج عقدتك إلى الوصول إلى `us1.api.wallarm.com`.
    *   إذا كنت تستخدم السحابة الأوروبية، تحتاج عقدتك إلى الوصول إلى `api.wallarm.com`.
    
    تتطلب عقدة التصفية الوصول إلى خادم API الخاص بـ Wallarm لتشغيلها بشكل صحيح.

للاطلاع على معلومات مفصلة حول إنشاء مجموعة أمان، تابع إلى [وثائق AWS][link-sg].

## 3. إطلاق نموذج عقدة Wallarm

لإطلاق نموذج مع عقدة تصفية Wallarm، تابع إلى هذا [الرابط](https://aws.amazon.com/marketplace/pp/B073VRFXSD) واشترك في عقدة التصفية.

عند إنشاء نموذج، تحتاج إلى تحديد [مجموعة الأمان التي أنشأتها سابقًا][anchor1] على النحو التالي:

1. أثناء العمل مع معالج إطلاق النموذج، تابع إلى خطوة إطلاق النموذج **6. Configure Security Group** بالنقر على علامة التبويب المقابلة.
2. اختر خيار **Select an existing security group** في إعداد **Assign a security group**.
3. حدد مجموعة الأمان من القائمة التي تظهر.

بعد تحديد جميع إعدادات النموذج المطلوبة، انقر على زر **Review and Launch**، تأكد من أن النموذج مُكون بشكل صحيح، ثم انقر على زر **Launch**.

في النافذة التي تظهر، حدد [زوج المفاتيح الذي أنشأته سابقًا][anchor2] بأداء الإجراءات التالية:

1. في القائمة المنسدلة الأولى، حدد خيار **Choose an existing key pair**.
2. في القائمة المنسدلة الثانية، حدد اسم زوج المفاتيح.
3. تأكد من أن لديك الوصول إلى المفتاح الخاص بتنسيق PEM من زوج المفاتيح الذي حددته في القائمة المنسدلة الثانية وقم بوضع علامة في المربع لتأكيد ذلك.
4. انقر على زر **Launch Instances**.

سيتم إطلاق النموذج مع عقدة التصفية المثبتة مسبقًا.

للاطلاع على معلومات مفصلة حول إطلاق النماذج في AWS، تابع إلى [وثائق AWS][link-launch-instance].

## 4. الاتصال بنموذج عقدة التصفية عبر SSH

للاطلاع على معلومات مفصلة حول الطرق للاتصال بنموذج عبر SSH، تابع إلى [وثائق AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstances.html).

تحتاج إلى استخدام اسم المستخدم `admin` للاتصال بالنموذج.

!!! info "استخدام المفتاح للاتصال عبر SSH"
    استخدم المفتاح الخاص بتنسيق PEM الذي [أنشأته سابقًا][anchor2] للاتصال بالنموذج عبر SSH. يجب أن يكون هذا المفتاح الخاص من زوج مفاتيح SSH الذي حددته عند إنشاء النموذج.

## 5. توصيل عقدة التصفية بسحابة Wallarm

--8<-- "../include/waf/installation/connect-waf-and-cloud-4.6-only-with-postanalytics.md"