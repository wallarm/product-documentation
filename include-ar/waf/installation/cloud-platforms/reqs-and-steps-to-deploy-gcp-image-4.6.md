## الشروط

* حساب GCP
* الوصول للحساب بدور **المدير** وتعطيل المصادقة الثنائية في وحدة تحكم Wallarm لـ [السحابة الأمريكية](https://us1.my.wallarm.com/) أو [السحابة الأوروبية](https://my.wallarm.com/)
* الوصول إلى `https://us1.api.wallarm.com:444` للعمل مع سحابة Wallarm الأمريكية أو إلى `https://api.wallarm.com:444` للعمل مع سحابة Wallarm الأوروبية. إذا كان يمكن تهيئة الوصول عبر خادم الوكيل فقط، فاستخدم [التعليمات][wallarm-api-via-proxy]
* تنفيذ جميع الأوامر على نسخة Wallarm كمستخدم أعلى (مثل `root`)

## 1. إطلاق نسخة من عقدة التصفية

### إطلاق النسخة عبر واجهة Google Cloud

لإطلاق عقدة التصفية عبر واجهة Google Cloud، يُرجى فتح [صورة عقدة Wallarm على Google Cloud Marketplace](https://console.cloud.google.com/launcher/details/wallarm-node-195710/wallarm-node) والضغط على **ابدأ**.

سيتم إطلاق النسخة بعقدة التصفية المثبتة مسبقًا. لرؤية معلومات مفصلة حول إطلاق النسخ في Google Cloud، يُرجى الاستمرار إلى [وثائق منصة Google Cloud الرسمية][link-launch-instance].

### إطلاق النسخة عبر Terraform أو أدوات أخرى

عند استخدام أداة مثل Terraform لإطلاق عقدة التصفية باستخدام صورة GCP من Wallarm، قد تحتاج إلى توفير اسم هذه الصورة في تهيئة Terraform.

* اسم الصورة يكون بالتنسيق التالي:

    ```bash
    wallarm-node-195710/wallarm-node-<IMAGE_VERSION>-build
    ```
* لإطلاق النسخة بإصدار عقدة التصفية 4.6، يُرجى استخدام اسم الصورة التالي:

    ```bash
    wallarm-node-195710/wallarm-node-4-6-20230630-122224
    ```

للحصول على اسم الصورة، يمكنك اتباع الخطوات التالية أيضًا:

1. تثبيت [Google Cloud SDK](https://cloud.google.com/sdk/docs/install).
2. تنفيذ الأمر [`gcloud compute images list`](https://cloud.google.com/sdk/gcloud/reference/compute/images/list) بالمعاملات التالية:

    ```bash
    gcloud compute images list --project wallarm-node-195710 --filter="name~'wallarm-node-4-6-*'" --no-standard-images
    ```
3. نسخ قيمة الإصدار من اسم آخر صورة متوفرة ولصق القيمة المنسوخة في تنسيق اسم الصورة الموفر. على سبيل المثال، ستكون صورة إصدار عقدة التصفية 4.6 باسم التالي:

    ```bash
    wallarm-node-195710/wallarm-node-4-6-20230630-122224
    ```

## 2. تهيئة نسخة عقدة التصفية

قم بتنفيذ الإجراءات التالية لتهيئة النسخة المطلقة من عقدة التصفية:

1.  الانتقال إلى صفحة **النسخ الافتراضية** في قسم **محرك الحوسبة** من القائمة.
2.  تحديد النسخة المطلقة من عقدة التصفية والنقر على زر **تحرير**.
3.  السماح بأنواع الحركة الواردة المطلوبة عن طريق تحديد المربعات المناسبة في إعداد **الجدران النارية**.
4.  إذا لزم الأمر، يمكنك تقييد الاتصال بالنسخة باستخدام مفاتيح SSH للمشروع واستخدام زوج من المفاتيح الخاصة للاتصال بهذه النسخة. للقيام بذلك، نفّذ الإجراءات التالية:
    1.  تحديد خانة **حظر المشروع بأكمله** في إعداد **مفاتيح SSH**.
    2.  النقر على زر **إظهار وتحرير** في إعداد **مفاتيح SSH** لتوسيع الحقل لإدخال مفتاح SSH.
    3.  توليد زوج من مفاتيح SSH العامة والخاصة. على سبيل المثال، يمكن استخدام أدوات `ssh-keygen` و`PuTTYgen`.
       
        ![توليد مفاتيح SSH باستخدام PuTTYgen][img-ssh-key-generation]

    4.  نسخ مفتاح مفتوح بتنسيق OpenSSH من واجهة مولد المفاتيح المستخدم (في المثال الحالي، يجب نسخ المفتاح العام المولد من منطقة **المفتاح العام للصق في ملف authorized_keys من OpenSSH** لواجهة PuTTYgen) ولصقه في الحقل الذي يحتوي على تلميح **أدخل بيانات المفتاح بالكامل**.
    5.  حفظ المفتاح الخاص. سوف يُطلب في المستقبل للاتصال بالنسخة المهيأة.
5.  النقر على زر **حفظ** في أسفل الصفحة لتطبيق التغييرات.

## 3. الاتصال بنسخة عقدة التصفية عبر SSH

لرؤية معلومات مفصلة حول طرق الاتصال بالنسخ، تابع إلى هذا [الرابط](https://cloud.google.com/compute/docs/instances/connecting-to-instance).

--8<-- "../include/gcp-autoscaling-connect-ssh.md"

## 4. ربط عقدة التصفية بسحابة Wallarm

--8<-- "../include/waf/installation/connect-waf-and-cloud-4.6-only-with-postanalytics.md"