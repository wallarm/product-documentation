[link-ruby]:        http://ruby-doc.org/core-2.6.1/doc/regexp_rdoc.html
[link-yaml]:        https://yaml.org/spec/1.2/spec.html

# ポイント作成原則

!!! warning "予約語"
    予約語との衝突を避けるため、ベースライン要求要素に次の名前とキーを使用してはいけません:
        
    * パーサーの名前と一致する名前およびキー
    * フィルターの名前と一致する名前およびキー
    * `name`および`value`サービスワードと一致する名前およびキー 

カスタム拡張機能を開発する際に考慮すべき共通のポイント作成原則がいくつかあります。

* 全てのポイントは正規表現として扱われます。
    
    **例:**

    * 要求内に存在する場合、`HEADER_A.*_value`ポイントは、名前が`A`で始まるヘッダーを参照します。
    * `PATH_\d_value`ポイントは、要求URIパスの最初の10部分を参照します。

* ポイントの各部分は`_`記号で区切る必要があります。
    
    **例:** 
    
    `URI_value`.

* パーサーとフィルターの名前は大文字でポイントに追加する必要があります。
    
    **例:** 
    
    `ACTION_EXT_value`.

* 要求要素の名前は、ベースライン要求に記載されているのと全く同じ方法でポイントに追加する必要があります。
    
    **例:** 
    
    例えば、`GET http://example.com/login/?Uid=01234`要求の場合、`GET_Uid_value`ポイントは`Uid`クエリ文字列パラメーターを参照します。
    
    !!! info "特殊記号のエスケープ"
        ポイントで使用する場合、一部のサービス記号はエスケープが必要になることがあります。詳細は[Rubyプログラミング言語の正規表現][link-ruby]のドキュメントをご覧ください。

* ポイントは次の方法で拡張機能に配置できます:
    * `"`記号で囲む方法。
        
        **例:**
        
        `"PATH_.*_value"`.
    
    * `'`記号で囲む方法。
        
        **例:**
        
        `'GET_.*_value'`.
    
    * 何の記号にも囲まない方法。
        
        **例:**
        
        `HEADER_.*_value`.
    
    !!! info "記号でポイントを囲む"
        YAML構文はポイントを囲む際に使用する各種記号の違いを定義しています。詳細はこの[リンク][link-yaml]をご覧ください.

* `,`記号で区切られ、`[`および`]`記号で囲まれたポイントは、ポイントの配列として扱われます.
    
    **例:**
    
    `[GET_uid_value, GET_passwd_value]`.

* 拡張機能が要求要素の名前または値で動作するかを示すため、サービスワードは常にポイントの末尾に存在しなければなりません. 
    * 要求要素の名前で動作させるためには、`name`サービスワードを指定する必要があります.
        
        `name`サービスワードは次のフィルターと併用できます:
        
        * Xml_pi;
        * Xml_dtd_entity.
        
        **例:**
        
        例えば、`POST_XML_XML_DTD_ENTITY_0_name`ポイントは、要求本文内のXMLデータで指定された最初のDTDスキーマディレクティブの名前を参照します.
    
    * 要求要素の値で動作させるためには、`value`サービスワードを指定する必要があります.
        
        `value`サービスワードは利用可能なFAST DSLフィルターおよびパーサーと併用可能です.
        
        **例:**
        
        例えば、`PATH_0_value`ポイントは、要求URIパスの最初の部分の値を参照します.