# カスタムルールセットの構築とアンロード

カスタムルールセットは、特定のクライアントトラフィックの処理の詳細を定義します（例えば、カスタム攻撃検出ルールの設定や敏感なデータのマスキングが可能です）。Wallarmノードは、着信リクエストの分析時にカスタムルールセットに依存します。

カスタムルールの変更はすぐには効果がありません。変更は、カスタムルールセットの**構築**と**フィルタリングノードへのアンロード**が完了した後にのみ、リクエスト分析プロセスに適用されます。

## カスタムルールセットの構築

Wallarmコンソールの **ルール**で新規ルールを追加したり、既存のルールを削除したり変更したりすると、カスタムルールセットのビルドが開始されます。構築プロセスでは、ルールは最適化され、フィルタリングノードに適した形式にコンパイルされます。カスタムルールセットの構築プロセスは、ルール数が少ない場合は数秒から、複雑なルールツリーの場合は最大1時間程度掛かります。。

カスタムルールセットビルドの状態と予想される完了時間は、Wallarmコンソールに表示されます。構築中のものがない場合、インターフェースは最後に完成したビルドの日付を表示します。

![Build status](../../images/user-guides/rules/build-rules-status.png)

## カスタムルールセットをフィルタリングノードにアンロードする

カスタムルールセットビルドは、フィルタリングノードとWallarmクラウドの同期中にフィルタリングノードにアンロードされます。デフォルトでは、フィルタリングノードとWallarmクラウドの同期が2‑4分ごとに開始されます。[フィルタリングノードとWallarmクラウドの同期設定の詳細はこちら →](../../admin-en/configure-cloud-node-synchronization-en.md)

カスタムルールセットをフィルタリングノードにアンロードする状態は、`/var/log/wallarm/syncnode.log`ファイルに記録されます。