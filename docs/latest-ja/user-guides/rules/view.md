[img-rules-overview]:       ../../images/user-guides/rules/rules-overview.png
[img-view-rules]:           ../../images/user-guides/rules/view-rules.png

# アプリケーションプロファイルルールの検査

アプリケーション構造のルールを表示するには、Wallarm Consoleの**ルール**セクションに移動します。このセクションには、すでに知られているブランチとエンドポイントが表示されます。

![ルールタブの概要][img-rules-overview]

システムは、ブランチごとにルールを自動的にグループ分けし、共通の条件をハイライト表示し、ツリー構造を作成します。その結果、ブランチには子ブランチを持つことがあります。ネストしたブランチを表示または非表示にするには、ブランチの説明の左側にある青い円をクリックします。

ブランチの説明中の二つのアスタリスク`**`は、任意の数のネストしたパスを参照します。たとえば、ブランチ`/**/*.php`には`/index.php`と`/app/admin/install.php`の両方が含まれます。

青い円の大きさは、ネストしたブランチの相対的な数量を示します。その色は、ブランチ内およびそのサブブランチ内のルールの相対的な量を示します。各ネストレベルで、サークルのサイズと色は互いに独立しています。

ブランチの説明の右側には、そのブランチのルールの数（ネストされたルールではなく、直接の子ルールのみ）を示すオレンジ色の数字が表示される場合があります。数字が表示されない場合、そのブランチは「仮想」であり、同様のサブブランチをグループ化するためだけに使用されます。

ユーザーが利用できないルールを持つブランチ（権限モデルによれば）が自動的に非表示になります。


## ルールの表示

各ブランチでは、ユーザーはそれに添付されたルールのリストを確認できます。対応するブランチの説明をクリックして、ルールリストのページに切り替えます。

![ブランチのルールの表示][img-view-rules]

ブランチ内のルールは、*ポイント*フィールドでグループ化されます。リクエスト全体に影響を与えるルール、つまり個々のパラメーターではなく、が1行にまとめられます。リスト全体を見るには、その行をクリックします。

各ルールに対して、システムは次のパラメーターを表示します：最後の更新時間、数量、タイプ、とポイント。

## デフォルトルール

あなたは任意のアクションを指定してルールを作成することができますが、エンドポイントにはリンクしていません。これらは**デフォルトルール**と呼ばれます。そのようなルールはすべてのエンドポイントに適用されます。

* デフォルトルールを作成するには、[通常の手順](rules.md)に従いますが、URIを空白にしておきます。その結果、エンドポイントにリンクしていない新しいルールが作成されます。
* 作成したデフォルトルールのリストを表示するには、**デフォルトルール**ボタンをクリックします。

!!! info "トラフィックフィルタモードのデフォルトルール"
    Wallarmは自動的にすべてのクライアントの「フィルタリングモード設定」デフォルトルールを[作成](wallarm-mode-rule.md#default-instance-of-rule)し、その値を[一般的なフィルタモード](../../admin-en/configure-wallarm-mode.md#setting-up-the-general-filtration-rule-in-wallarm-console)設定に基づいて設定します。

デフォルトルールは、すべてのブランチが[継承](#独立したルールと継承されたルール)します。

## 独立したルールと継承されたルール

ルールは、ルールブランチを下って継承されます。原則：

* すべてのブランチが[デフォルト](#デフォルトルール)ルールを継承します。
* ブランチ内の子エンドポイントは、親からルールを継承します。
* 直接指定されたものは[正規表現](rules.md#condition-type-regex)の上位になります。
* [敏感](rules.md#condition-type-equal)は[非感受性](rules.md#condition-type-iequal-aa)より優先します。

ルールブランチの操作方法の詳細：

* エンドポイントを展開するには、青い円をクリックします。
* 明確なルールを持たないエンドポイントはグレー表示され、クリックできません。

    ![エンドポイントのブランチ](../../images/user-guides/rules/rules-branch.png)

* エンドポイントのルールを表示するには、それをクリックします。初めてこのエンドポイントの明確なルールが表示されます。
* 特定のエンドポイントのルールリストを表示しているときに、**独自のルールと継承されたルール**をクリックすると、継承されたルールが表示されます。継承されたルールは独自のルールと一緒に表示され、独自のルールに比べてグレーになります。

    ![エンドポイントの独自のルールと継承されたルール](../../images/user-guides/rules/rules-distinct-and-inherited.png)

## ルールを取得するためのAPIコール

カスタムルールを取得するために、Wallarm APIを[直接呼び出す](../../api/overview.md)ことも、Wallarm Console UIを使用することもできます。以下にそれに対応するAPIコールの例をいくつか示します。

**全ての設定ルールを取得**

--8<-- "../include-ja/api-request-examples/get-all-configured-rules.md"

**全てのルールの条件のみを取得**

--8<-- "../include-ja/api-request-examples/get-conditions.md"

**特定の条件に添付されたルールを取得**

特定の条件を指定するには、そのIDを使用します。IDは、全てのルールの条件をリクエストしたときに取得できます。

--8<-- "../include-ja/api-request-examples/get-rules-by-condition-id.md"
