# リクエストパーサの管理

ルール **リクエストパーサの無効化/有効化** は、分析中のリクエストに適用されるパーサのセットを管理することを可能にします。

デフォルトでは、リクエストの分析時にWallarmノードは、リクエストの各要素に対して適切な[パーサ](request-processing.md)を順番に適用しようと試みます。しかし、一部のパーサは誤って適用される場合があり、結果として、Wallarmノードはデコードされた値内の攻撃の兆候を検出することがあります。

例えば、Wallarmノードは、[Base64](https://en.wikipedia.org/wiki/Base64)にエンコードされたデータとして誤って未エンコードのデータを認識することがあります。なぜなら、Base64のアルファベットの記号は、通常のテキスト、トークン値、UUID値、その他のデータフォーマットでよく使用されるからです。未エンコードのデータをデコードして結果の値内の攻撃の兆候を検出すると、[偽陽性](../../about-wallarm/protecting-against-attacks.md#false-positives)が発生します。

このような場合の偽陽性を防ぐために、ルール **リクエストパーサの無効化/有効化** を使用して、誤って適用されたパーサを特定のリクエスト要素に対して無効化することができます。

## ルールの作成と適用

--8<-- "../include-ja/waf/features/rules/rule-creation-options.md"

**ルール**セクションでルールを作成して適用するには：

1. Wallarmコンソールの **ルール** セクションで、**リクエストパーサの無効化/有効化** のルールを作成します。ルールは次のコンポーネントで構成されます：

      * **条件**は、ルールを適用するエンドポイントを[記述](rules.md#rule-branches)します。
      * 指定されたリクエスト要素に対して無効化/有効化されるべきパーサ。
      * **リクエストの部分**は、選択されたパーサで解析する/解析しない元のリクエスト要素を指します。

         --8<-- "../include-ja/waf/features/rules/request-part-reference.md"
2. [ルールのコンパイルが完了する](rules.md)のを待ちます。

## ルールの例

リクエストが `https://example.com/users/`に送信され、認証ヘッダ `X-AUTHTOKEN`が必要とするとしましょう。ヘッダの値は、特定の記号組み合わせ（例えば、末尾の `=`）を含む可能性があり、Wallarmによって `base64` のパーサでデコードされる可能性があります。

`X-AUTHTOKEN`値における偽陽性を防ぐための**リクエストパーサの無効化/有効化** ルールは、次のように設定できます：

![リクエストパーサの無効化/有効化ルールの例](../../images/user-guides/rules/disable-parsers-example.png)