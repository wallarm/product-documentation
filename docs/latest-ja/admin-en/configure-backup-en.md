# フェイルオーバー方式の設定

[リバースプロキシ](../glossary-en.md#reverse-proxy)としてフィルタノードをデプロイするには、フィルタノードが高可用である必要があります。たとえば停電などでフィルタノードに障害が発生すると、APIの動作が制限されます。Wallarmの高可用性を確保するために、本セクションで説明するいずれかのフェイルオーバー方式を使用することを推奨します。

フェイルオーバー方式では、メインフィルタノードに障害が発生した際にトラフィックを自動的に転送するための追加ノードを用意します。

## データセンターのフェイルオーバー

APIとフィルタノードがデータセンター内にある場合は、データセンターの「Failover IP」サービスを使用してください。

## VRRPまたはCARP 

各フィルタノードで、ノードの可用性を監視し、ノードがダウンした場合にトラフィックの転送を開始する`keepalived`または`ucarp`デーモンを起動してください。これは標準的な高可用性方式であり、各ノードでfailover‑IPを起動し、DNSバランシングでトラフィックを分散することでトラフィックの負荷分散にも使用できます。

!!! info "NGINX Plusでの利用"
    WallarmはカスタムVRRPラッパーを用いることで[NGINX Plus](https://www.nginx.com/products/nginx/)上で動作するように設定できます。
    
    CentOSやDebianを含むほとんどのLinuxディストリビューションには、このビルドをインストールできるカスタムパッケージがあります。
    
    NGINX Plusと併用したWallarmのインストールはall-in-oneインストーラーを使用して実施します。詳しい手順は[こちら](../installation/nginx/all-in-one.md)をご覧ください。

## ハードウェアL3またはL4ロードバランサー

L3またはL4のロードバランサーは高可用性の優れたソリューションです。

## DNSロードバランシング

DNS設定で複数のIPアドレスを指定してください。この方法は負荷分散を目的としていますが、高可用性の手段としても有用です。