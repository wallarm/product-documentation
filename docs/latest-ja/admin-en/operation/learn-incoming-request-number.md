# アプリケーションが月ごとに処理するリクエスト数の学習

Wallarmの主なライセンス/請求方法は、あなたの環境にデプロイされたWallarmフィルタリングノードによって提供されるリクエストのレベルに基づいています。この文書では、アプリケーションが処理するリクエスト数を簡単に学ぶ方法を説明します。

## 情報へのアクセスを持つチーム

通常、企業内の次のチームは簡単に情報にアクセスできます。

* DevOps
* 技術運用
* クラウド運用
* プラットフォーム運用
* DevSecOps
* システム管理者
* アプリケーション管理者
* NOC

## リクエスト数を知るための方法

アプリケーションが処理するリクエスト数を探すにはいくつかの方法があります。

* AWSの顧客で、ELBまたはALBロードバランサーを使用している場合、ロードバランサーのAWS監視メトリクスを使用して、ロードバランサーによって提供されるアプリケーションの日別および週別リクエスト数を推定することができます。

    ![AWS monitoring example](../../images/operation/aws-requests-example.png)

    例えば、グラフが平均リクエスト数/分が350であることを示していて、平均的に月に730時間あると仮定すると、月間リクエスト数は`350 * 60 * 730 = 15,330,000`となります。

* GCPのHTTPロードバランサーのユーザーは、監視メトリクス **https/request_count** を使用できます。このメトリクスはネットワークロードバランサーでは利用できません。
* Microsoft IISのユーザーは、**Requests Per Sec** メトリクスに依存して、1秒あたりのリクエスト数を平均化し、1つのIISサーバーが1ヶ月で提供するリクエスト数を計算することができます。計算時には、平均的に月に`730 * 3,600`秒あると仮定します。
* New Relic、Datadog、AppDynamics、SignalFXなどのApplication Performance Monitoringサービスのユーザーは、それらのAPMコンソールから情報を取得できます（エッジ層の全てのサーバーに対する集約値を取得するように注意し、1つのサーバーだけではない）。
* Datadog、AWS CloudWatchなどのクラウドベースのインフラストラクチャ監視システムのユーザーや、PrometheusやNagiosなどの内部監視システムのユーザーは、最も可能性が高く、すでに彼らのエッジロケーション（ロードバランサーズ、ウェブサーバー、アプリケーションサーバー）で提供されるリクエストのレベルを監視しており、これらの情報を使用して平均的に扱われるリクエスト数を簡単に推定することができます。
* 別のアプローチは、エッジロードバランサーやウェブサーバーのログを使用して、特定の期間（理想的には - 24時間）のログレコード数を計算し、提供されたリクエストごとに1つのログレコードがあると仮定することです。例えば、このウェブサーバーは、ログファイルに653,525のリクエストが記録された状態で、NGINXアクセスログファイルを1日に1回ローテーションします。

    ```bash
    cd /var/log/nginx/
    zcat access.log.2.gz |wc -l
    # 653525
    ```

    * サーバーが1ヶ月間で提供するリクエストの推定値は`653,525 * 30 = 19,605,750`です。
    * 使用されるウェブサーバーの総数を知っていれば、全体のアプリケーションが処理するリクエスト数を推定することができます。

* Google Analyticsや類似のユーザー体験追跡および監視サービスを使用している純粋なウェブアプリケーションの場合、提供されたページと全ての埋め込みオブジェクトの数についての情報をサービスから抽出することができます。