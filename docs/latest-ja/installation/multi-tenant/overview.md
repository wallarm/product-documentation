# マルチテナンシーの概要

**マルチテナンシー**機能により、Wallarmを使用して複数の独立した企業インフラや分離された環境を同時に保護できます。

**テナント**（[**テナントアカウント**](#tenant-accounts)）は、次のいずれかを表します。

* Wallarmをパートナーとして統合する場合の独立した企業（クライアント）。
* Wallarmをクライアントとして統合する場合の分離された環境。

--8<-- "../include/waf/features/multi-tenancy/partner-client-term.md"

## マルチテナンシーが解決する課題

マルチテナンシー機能は、以下の課題に対処します。

* **Wallarmのパートナーになる。** パートナーとは、自社のシステムインフラ内にフィルタリングノードを導入し、クライアントに攻撃の緩和を提供する組織です。

    各クライアントにはWallarm Console内に個別のアカウントが割り当てられ、そのデータは分離され、当該クライアントのユーザーのみにアクセス可能になります。

* **保護対象の環境同士のデータを分離する。** 環境とは、個別のアプリケーション、データセンター、API、本番またはステージング環境などを指します。

    関連する課題の例:

    * 独立したチームが管理する本番およびステージング環境に送信されるリクエストをWallarmノードがフィルタリングしています。要件は、特定の環境を管理するチームのみがそのデータにアクセスできるようにすることです。
    * 異なる地域（例えば一方は欧州、もう一方はアジア）に位置し、独立したチームが管理する複数のデータセンターにWallarmノードがデプロイされています。要件は、特定のデータセンターを管理するユーザーのみがそのデータにアクセスできるようにすることです。

    各環境にはWallarm Console内に個別のアカウントが割り当てられ、そのデータは分離され、選択されたユーザーのみにアクセス可能になります。

    !!! info "分離しない環境"
        環境の分離が不要であれば、マルチテナンシーの代わりに、これらの環境ごとに設定や閲覧権限を分けるために[アプリケーション](../../user-guides/settings/applications.md)を使用できます。これにより、1つのアカウント内で環境を整理でき、そのアカウントのすべてのユーザーがアクセスできます。

## Wallarmコンポーネントのカスタマイズ

WallarmはWallarm Consoleおよびその他の一部コンポーネントをカスタマイズできます。マルチテナンシーを使用する場合、次のカスタマイズが役立ちます。

* Wallarm Consoleをブランディングします。
* カスタムドメインでWallarm Consoleをホストします。
* クライアントや同僚からのメッセージを受信するための技術サポート用メールアドレスを設定します。

## テナントアカウント {#tenant-accounts}

テナントアカウントの特長は次のとおりです。

* Wallarm Consoleでテナントアカウントを正しくグループ化するため、各テナントアカウントはグローバルアカウントにリンクされます。グローバルアカウントは、パートナーまたは分離された環境を持つクライアントを示します。
* ユーザーは各テナントアカウントへのアクセス権を個別に付与されます。
* 各テナントアカウントのデータは分離され、当該アカウントに追加されたユーザーだけがアクセスできます。
* **グローバル**[ロール](../../user-guides/settings/users.md#user-roles)を持つユーザーは、新しいテナントアカウントを作成し、すべてのテナントアカウントのデータを閲覧・編集できます。

テナントアカウントは次の構造で作成されます。

![!テナントアカウントの構造](../../images/partner-waf-node/accounts-scheme.png)

* **グローバルアカウント**は、パートナーまたはクライアントごとにテナントアカウントをグループ化するためだけに使用されます。
* **テクニカルテナントアカウント**は[グローバルユーザー](../../user-guides/settings/users.md#user-roles)を追加してテナントアカウントへのアクセスを付与するために使用されます。グローバルユーザーは通常、Wallarmのパートナー企業の従業員、または分離された環境のためにマルチテナンシーを使用するWallarmクライアントの従業員です。
* **テナントアカウント**は次の目的で使用されます。

    * 検出された攻撃に関するデータおよびトラフィックフィルタリング設定へのアクセスをテナントに提供します。
    * 特定のテナントアカウントのデータへのアクセスをユーザーに提供します。

[グローバルユーザー](../../user-guides/settings/users.md#user-roles)は次のことができます。 

* Wallarm Consoleでアカウントを切り替えます。
* テナントの[サブスクリプションとクォータ](../../about-wallarm/subscription-plans.md)を監視します。

![!Wallarm Consoleのテナントセレクター](../../images/partner-waf-node/clients-selector-in-console.png)

* `Technical tenant`はテクニカルテナントアカウントです
* `Tenant 1`と`Tenant 2`はテナントアカウントです

## マルチテナンシーの構成

マルチテナンシー機能はデフォルトでは無効です。有効化して構成するには、次の手順を実行します。

1. サブスクリプションプランに**Multi-tenant system**機能を追加するよう、[sales@wallarm.com](mailto:sales@wallarm.com)へリクエストを送信します。
2. Wallarm Consoleでテナントアカウントを[構成](configure-accounts.md)します。
3. マルチテナント対応のWallarmノードを[デプロイして構成](deploy-multi-tenant-node.md)します。