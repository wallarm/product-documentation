# フィルタリングノードのバージョニングポリシー

このポリシーは、異なるWallarmフィルタリングノードのアーティファクトのバージョニング方法を説明しています：Linuxパッケージ、Dockerコンテナ、Helmチャートなど。このドキュメントを使用して、インストール用のフィルタリングノードのバージョンを選択し、インストールしたパッケージの更新をスケジューリングできます。

!!! info "アーティファクト"
    ジアーティファクトはWallarmノードの開発結果で、プラットフォーム上でフィルタリングノードをインストールするために使用されます。例：Linuxパッケージ、Kong APIモジュール、Dockerコンテナなど。

## バージョンリスト

| ノードバージョン | リリース日   | サポート終了 |
|------------------|----------------|---------------|
|2.18およびそれ以下の2.x|                | 2021年11月 |
| 3.6およびそれ以下の3.x| 2021年10月   | 2022年11月 |
| 4.0              | 2022年6月      | 2023年2月 |
| 4.2              | 2022年8月    | 2023年6月     |
| 4.4              | 2022年11月  |               |
| 4.6              | 2023年4月     |               |

## バージョンフォーマット

Wallarmフィルタリングノードのアーティファクトのバージョンは以下のフォーマットを持っています：

```bash
<MAJOR_VERSION>.<MINOR_VERSION>.<PATCH_VERSION>[-<BUILD_NUMBER>]
```

| パラメータ                | 説明                                                                                                                                                                                                                                                                                                         | 平均リリース率            |
|--------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
| `<MAJOR_VERSION>`              | Wallarmノードのメジャーバージョン：<ul><li>コンポーネントの大幅な改訂</li><li>互換性のない変更</li></ul>初期値は `2`で、次のように1ずつ増加します：`3.6.0`, `4.0.0`。                                                                                                                                             | リリース予定なし           |
| `<MINOR_VERSION>`              | Wallarmノードのマイナーバージョン：<ul><li>新製品機能</li><li>重大なバグ修正</li><li>その他の互換性のある変更</li></ul>値は2ずつ増加します、例：`4.0`, `4.2`。                                                                                                                | 四半期ごと                   |
| `<PATCH_VERSION>`              | ノードのパッチバージョン：<ul><li>マイナーバグ修正</li><li>特別なリクエスト後に追加された新機能</li></ul>初期値は `0`で、次のように1ずつ増加します：`4.2.0`, `4.2.1`。                                                                                                                                         | 月1回                       |
| `<BUILD_NUMBER>` オプション | ノードビルドバージョン。値は使用されているパッケージビルドプラットフォームによって自動的に割り当てられます。手動のプロセスを使用してビルドしたアーティファクトには値は割り当てられません。<br />値は1ずつ増加します、例：`4.2.0-1`, `4.2.0-2`。最初のビルドが失敗した場合、ビルドは再度実行され、値が増加します  | 新しい`<PATCH_VERSION>`をリリースする際|

パッケージやイメージをダウンロードする際には、Wallarmノードのバージョンフォーマットを使うことを推奨します。フォーマットは [Wallarmノードのインストールフォーム](../installation/supported-deployment-options.md)によって異なります：

* Linuxパッケージの場合、`<MAJOR_VERSION>.<MINOR_VERSION>`
* Helmチャートの場合、`<MAJOR_VERSION>.<MINOR_VERSION>.<PATCH_VERSION>`
* Dockerとクラウドイメージの場合、`<MAJOR_VERSION>.<MINOR_VERSION>.<PATCH_VERSION>[-<BUILD_NUMBER>]`

    Wallarm Dockerイメージをプルする際には、フィルタリングノードのバージョンを`<MAJOR_VERSION>.<MINOR_VERSION>`の形式で指定することもできます。プルされたフィルタリングノードのバージョンには最新の利用可能なパッチバージョンの変更が含まれるため、同じ`<MAJOR_VERSION>.<MINOR_VERSION>`のイメージバージョンが異なる時間帯にプルされた場合の挙動は異なる場合があります。

同じアーティファクト内のWallarmノードパッケージのバージョンは異なる場合があります。例えば、更新が必要なパッケージが1つだけの場合、残りのパッケージは前のバージョンを保持します。

## バージョンサポート

Wallarmは、以下の方法でフィルタリングノードの最新3バージョンのみをサポートします：

* 最新バージョン（例：4.2）：パッケージのダウンロードを許可し、バグ修正をリリースし、使用されるバージョンに脆弱性が検出された場合は三者間のコンポーネントを更新します。特別なリクエスト後に新機能をリリースすることもあります。
* 前のバージョン（例：4.0）：パッケージのダウンロードを許可し、バグ修正をリリースします。
* サードバージョン（例：3.6）：最新バージョンのリリース日から3ヶ月間、パッケージのダウンロードとバグ修正のリリースを許可します。3ヶ月後には、そのバージョンは非推奨になります。

非推奨バージョンのノードアーティファクトはダウンロードとインストール可能ですが、バグ修正や新機能は非推奨バージョンにはリリースされません。

フィルタリングノードを初めてインストールする際には、最新の利用可能なバージョンを使用することを推奨します。既にノードがインストールされている環境にさらにフィルタリングノードをインストールする際には、全てのインストールで同じバージョンを使用して完全な互換性を確保することを推奨します。

## NGINXのアップグレード

ほとんどのWallarmモジュールは、各自のバージョンのNGINXコンポーネントとともに配布されます。Wallarmモジュールが最新バージョンのNGINXコンポーネントと共に動作するように、以下のように更新します：

* WallarmのDEBおよびRPMパッケージは、公式のNGINXおよびNGINX Plusモジュールに基づいています。新しいバージョンのNGINX/NGINX Plusがリリースされると、Wallarmはそのバージョンの更新を1日以内に提供することを約束します。Wallarmはこの更新をサポートされているノードバージョンの新しいマイナー/パッチバージョンとして公開します。
* Wallarm Ingress Controllerは [Community Ingress NGINX Controller](https://github.com/kubernetes/ingress-nginx)に基づいています。Community Ingress NGINX Controllerの新しいバージョンがリリースされたら、Wallarmはそのバージョンの更新を次の30日以内に提供することを約束します。Wallarmはこの更新を最新のIngressコントローラーの新しいマイナーバージョンとして公開します。

## バージョンの更新

製品をインストール、更新、または設定する際には、フィルタリングノードの最新の利用可能なバージョンを使用していることが想定されています。Wallarmノードの手順は、最新の利用可能なパッチとビルドを自動的にインストールするコマンドを説明しています。

### 新しいバージョンの通知

Wallarmは、新しいメジャーとマイナーバージョンについての情報を以下のソースに公開します：

* 公開ドキュメンテーション
* [News portal](https://changelog.wallarm.com/)
* Wallarm Console

    ![Wallarm Console内の新しいバージョンに関する通知](../images/updating-migrating/wallarm-console-new-version-notification.png)

メジャーおよびマイナーバージョンとWallarmノードのパッチバージョンの利用可能な更新についての情報も、Wallarm Console → **Nodes**のレギュラーノードに表示されます。各パッケージには**Up to date**のステータスまたは利用可能な更新のリストがあります。例えば、最新のコンポーネントバージョンがインストールされているフィルタリングノードのカードは以下のようになります：

![Node card](../images/user-guides/nodes/view-regular-node-comp-vers.png)

### 更新手順

新しいフィルタリングノードのメジャーおよびマイナーバージョンのリリースとともに、インストール手順も公開されます。インストールされたアーティファクトを更新するための手順については、**Updating and Migrating**セクションから適切な手順をご覧ください。