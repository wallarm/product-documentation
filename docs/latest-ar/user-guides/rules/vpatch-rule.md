[img-vpatch-example1]:      ../../images/user-guides/rules/vpatch-rule-1.png
[img-vpatch-example2]:      ../../images/user-guides/rules/vpatch-rule-2.png
[img-regex-example1]:       ../../images/user-guides/rules/regex-rule-1.png
[rule-creation-options]:    ../../user-guides/events/analyze-attack.md#analyze-requests-in-an-event
[request-processing]:       ../../user-guides/rules/request-processing.md

# التصحيح الافتراضي

في الحالات التي يكون فيها من المستحيل إصلاح ثغرة [أمنية](../../user-guides/vulnerabilities.md) حرجة في كود تطبيقك أو تثبيت التحديثات الضرورية بسرعة، يمكنك إنشاء تصحيح افتراضي لحظر جميع الطلبات أو الطلبات المحددة إلى نقاط النهاية التي قد تتيح استغلال هذه الثغرات الأمنية. سيحظر التصحيح الافتراضي الطلبات حتى في وضعيات المراقبة والحظر الآمنة، باستثناء تلك الصادرة من عناوين IP التي تم إدراجها في القائمة البيضاء.

توفر Wallarm القواعد التالية لإنشاء تصحيح افتراضي:

* **إنشاء قاعدة تصحيح افتراضي** - تسمح بإنشاء تصحيح افتراضي يحظر الطلبات التي تحتوي في جزئها المحدد على أحد علامات الهجوم [المعروفة](../../attacks-vulns-list.md)، مثل SQLi، SSTi، RCE، وغيرها. أيضًا، يمكنك اختيار **أي طلب** لحظر طلبات معينة دون أي علامات هجوم.
* **إنشاء قاعدة مؤشر هجوم مبني على التعبيرات النظامية** مع تحديد خيار **التصحيح الافتراضي** - يسمح بإنشاء تصحيح افتراضي يحظر الطلبات التي تحتوي على علامات هجوم الخاصة بك أو سببك الخاص للحظر (انظر [المثال](#blocking-all-requests-with-incorrect-x-authentication-header)) والتي يتم وصفها بالتعبيرات النظامية. التفاصيل حول العمل مع القاعدة المبنية على التعبير النظامي موصوفة [هنا](../../user-guides/rules/regex-rule.md).

## إنشاء وتطبيق القاعدة

--8<-- "../include/waf/features/rules/rule-creation-options.md"

## أمثلة القواعد

### حظر طلبات محددة لنقطة نهاية مختارة

لنقل إن قسم الشراء عبر الإنترنت في تطبيقك الذي يُمكن الوصول إليه عبر الرابط `example.com/purchase` يتوقف عن العمل عند معالجة معامل الاستعلام `refresh`. قبل إصلاح الخلل، تحتاج إلى حظر الطلبات التي تؤدي إلى التوقف عن العمل.

للقيام بذلك، قم بضبط قاعدة **إنشاء تصحيح افتراضي** كما هو معروض في اللقطة:

![تصحيح افتراضي لأي نوع طلب][img-vpatch-example2]

### حظر محاولات استغلال ثغرة أمنية تم اكتشافها ولكن لم يتم إصلاحها بعد

لنقل إن التطبيق الخاص بك الذي يُمكن الوصول إليه عبر النطاق `example.com` قد اكتشف ثغرة أمنية لم يتم إصلاحها بعد: معامل `id` في التطبيق عرضة لهجمات حقن SQL. في غضون ذلك، تم ضبط عقدة تصفية Wallarm على وضع المراقبة، ومع ذلك، تحتاج إلى حظر محاولات استغلال الثغرة الأمنية فورًا.

للقيام بذلك، قم بضبط قاعدة **إنشاء تصحيح افتراضي** كما هو معروض في اللقطة:

![تصحيح افتراضي لنوع طلب معين][img-vpatch-example1]

### حظر جميع الطلبات ذات الرأسية `X-AUTHENTICATION` غير صحيحة

--8<-- "../include/waf/features/rules/rule-vpatch-regex.md"

## استدعاءات API للتصحيحات الافتراضية

لإنشاء تصحيحات افتراضية، يمكنك استدعاء API Wallarm مباشرةً. ضع في اعتبارك الأمثلة:

* [إنشاء التصحيح الافتراضي لحظر جميع الطلبات المرسلة إلى `/my/api/*`](../../api/request-examples.md#create-the-virtual-patch-to-block-all-requests-sent-to-myapi)
* [إنشاء التصحيح الافتراضي لمعرف كيان تطبيق محدد لحظر جميع الطلبات المرسلة إلى `/my/api/*`](../../api/request-examples.md#create-the-virtual-patch-for-a-specific-application-instance-id-to-block-all-requests-sent-to-myapi)