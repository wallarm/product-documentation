# الشغل بالمشغلات

المشغلات هي أدوات تُستخدم لضبط استجابة Wallarm لأحداث مختلفة. المشغلات تجمع عدد كبير من الأحداث التي يمكن للنظام الاستجابة لها مع مجموعة متنوعة من الاستجابات الممكنة. هذه العملية شبيهة بالبناء تسمح بتكوين سلوكيات معقدة تتماشى مع احتياجات أمان شركتك الفريدة.

يتم تكوين المشغلات في قسم **المشغلات** في [السحابة الأمريكية](https://us1.my.wallarm.com/triggers) أو [السحابة الأوروبية](https://my.wallarm.com/triggers).

![قسم لضبط المشغلات](../../images/user-guides/triggers/triggers-section.png)

## كيف تعمل

كل مشغل يتكون من المكونات التالية التي يمكنك تكوينها:

* **الشرط**: حدث يجب أن يستجيب له Wallarm. مثال: الحصول على كمية معينة من الهجمات، عنوان IP في القائمة السوداء، وإضافة مستخدم جديد للحساب.
* [**الفلاتر**](#understanding-filters): تفاصيل الشرط. مثال: إذا كان الشرط هو "أكثر من 10,000 هجمة في اليوم"، إذا ضع فلتر **نوع** إلى "SQLi" و **حالة الاستجابة** إلى "200" وبالنسبة للمشغل سيعني ذلك "تصرف إذا كان هناك أكثر من 10,000 هجمة SQLi في اليوم التي حصلت على استجابة 200".
* **الاستجابة**: عمل يجب تنفيذه إذا تم استيفاء الشرط المحدد والفلاتر. مثال: إرسال الإشعار إلى Slack أو نظام آخر مُكوَّن كـ [تكامل](../settings/integrations/integrations-intro.md)، حظر عنوان IP، أو تمييز طلبات كهجمة brute-force.

## ما يمكنك فعله بالمشغلات

باستخدام المشغلات، يمكنك:

* توفير التدابير الوقائية التالية لتطبيقاتك وAPIs:

    * [الحماية من مرتكبي الهجمات المتعددة](../../admin-en/configuration-guides/protecting-with-thresholds.md)
    * [الحماية من القوة الغاشمة](../../admin-en/configuration-guides/protecting-against-bruteforce.md)
    * [حماية التصفح القسري](../../admin-en/configuration-guides/protecting-against-forcedbrowsing.md)
    * [حماية BOLA](../../admin-en/configuration-guides/protecting-against-bola-trigger.md)

* إعداد تنبيهات موسعة لـ [تكاملات](../../user-guides/settings/integrations/integrations-intro.md) مختلفة.
* تحسين تمثيل الهجمات والحوادث عبر [تجميع الضربات](../../user-guides/events/analyze-attack.md#grouping-of-hits).

## فهم الفلاتر

يتم استخدام الفلاتر لتفصيل [الشرط](#how-it-works). مثال، يمكنك ضبط الاستجابة لهجمات من أنواع معينة، مثل هجمات القوة الغاشمة، الحقن SQL وغيرها. يمكن إضافة فلتر واحد أو أكثر في واجهة Wallarm Console وتعيين قيم لها.

![الفلاتر المتاحة](../../images/user-guides/triggers/trigger-filters.png)

الفلاتر التالية متاحة:

* **URI** (للشروط **القوة الغاشمة**، **التصفح القسري** و **BOLA** فقط): عنوان URI الكامل الذي تم إرسال الطلب إليه. يمكن تكوين URI من خلال [منشئ URI](../../user-guides/rules/rules.md#uri-constructor) أو [نموذج التعديل المتقدم](../../user-guides/rules/rules.md#advanced-edit-form).
* **النوع** هو [نوع](../../attacks-vulns-list.md) الهجمة التي تم اكتشافها في الطلب أو نوع الثغرة التي يوجه الطلب إليها.
* **التطبيق** هو [التطبيق](../settings/applications.md) الذي يتلقى الطلب.
* **الـIP** هو عنوان IP الذي يتم إرسال الطلب منه.

    الفلتر يتوقع IPs فردية فقط، لا يسمح بالشبكات الفرعية، المواقع، وأنواع المصادر.
* **النطاق** هو النطاق الذي يتلقى الطلب.
* **حالة الاستجابة** هو رمز الاستجابة الذي يُرجَع إلى الطلب.
* **الهدف** هو جزء من هندسة التطبيق الذي يوجه إليه الهجوم أو الذي يتم اكتشاف الحادث فيه. يمكن أن يأخذ القيم التالية: `Server`، `Client`، `Database`.
* **دور المستخدم** هو [دور](../../user-guides/settings/users.md#user-roles) المستخدم المضاف. يمكن أن يأخذ القيم التالية: `Deploy`، `Analyst`، `Administrator`، `Read only`، `API developer`، وإذا تم تمكين ميزة [الاستخدام المتعدد](../../installation/multi-tenant/overview.md) - `Global Administrator`، `Global Analyst`، `Global Read Only`.

## المشغلات الافتراضية

حسابات الشركات الجديدة تتميز بالمشغلات الافتراضية (المُعدة مسبقًا) التالية:

* تجميع الضربات القادمة من نفس عنوان IP في هجمة واحدة

    يجمع المشغل كل [الضربات](../../glossary-en.md#hit) المُرسلة من نفس عنوان IP في هجمة واحدة في قائمة الأحداث. هذا يحسن قائمة الأحداث ويسمح بتحليل الهجوم بشكل أسرع.

    يُطلِق هذا المشغل عندما يُنشئ عنوان IP واحد أكثر من 50 ضربة خلال 15 دقيقة. فقط الضربات المُرسلة بعد تجاوز الحد الأقصى تُجمّع في الهجوم.

    يمكن أن تحتوي الضربات على أنواع هجوم مختلفة، حمولات ضارة وURLs. سيتم وسم هذه المعايير الهجومية بعلامة `[multiple]` في قائمة الأحداث.

    بسبب القيم المختلفة لمعايير الضربات المجمعة، زر [وسم كإيجابي خاطئ](../events/false-attack.md#mark-an-attack-as-a-false-positive) سيكون غير متاح للهجوم بأكمله، لكن ما زال بإمكانك وسم ضربات معينة كإيجابيات خاطئة. [التحقق النشط من الهجوم](../../about-wallarm/detecting-vulnerabilities.md#active-threat-verification) سيكون أيضًا غير متاح.
    
    الضربات بأنواع الهجمات القوة الغاشمة، التصفح القسري، تجاوز حد الموارد، قنبلة البيانات، أو التصحيح الافتراضي لا يتم اعتبارها في هذا المشغل.
* تصنيف IP في القائمة الرمادية لمدة ساعة عندما يُنشئ أكثر من 3 [حمولات ضارة](../../glossary-en.md#malicious-payload) مختلفة خلال ساعة واحدة

    [القائمة الرمادية](../ip-lists/overview.md) هي قائمة بعناوين IP المشكوك فيها التي يعالجها العقدة كالتالي: إذا أصدر IP في القائمة الرمادية طلبات ضارة، يحجبها العقدة بينما يسمح بالطلبات الشرعية. بخلاف القائمة الرمادية، [القائمة السوداء](../ip-lists/overview.md) تُشير إلى عناوين IP التي لا يُسمح لها بالوصول إلى تطبيقاتك على الإطلاق - العقدة تحجب حتى الحركة المرورية الشرعية التي ينتجها مصادر في القائمة السوداء. تصنيف IP في القائمة الرمادية هو واحدة من الخيارات الهادفة إلى تقليل [الإيجابيات الخاطئة](../../about-wallarm/protecting-against-attacks.md#false-positives).

    يُطلِق المشغل في أي نمط تصفية للعقدة، حتى يقوم بتصنيف IPs في القائمة الرمادية بغض النظر عن نمط العقدة.

    ومع ذلك، العقدة تحلل القائمة الرمادية فقط في نمط **الحظر الآمن**. لحجب الطلبات الضارة الصادرة عن IPs في القائمة الرمادية، قُم بتبديل نمط العقدة [الوضع](../../admin-en/configure-wallarm-mode.md#available-filtration-modes) إلى الحظر الآمن بعد معرفة ميزاته أولاً.

    الضربات بأنواع الهجمات القوة الغاشمة، التصفح القسري، تجاوز حد الموارد، قنبلة البيانات، أو التصحيح الافتراضي لا يتم اعتبارها في هذا المشغل.

يمكنك تعطيل أي مشغل افتراضي مؤقتًا. يمكنك أيضًا تعديل السلوك الذي يوفره المشغل الافتراضي - للقيام بذلك، أنشئ مشغلات مخصصة من نفس النوع. إنشاء أي مشغل مخصص يحذف الافتراضي، إذا حذفت جميع مشغلاتك المخصصة، يتم استعادة الافتراضي.

## تعطيل وحذف المشغلات

* لوقف إرسال الإشعارات والاستجابات للأحداث مؤقتًا، يمكنك تعطيل المشغل. سوف يُعرض المشغل المعطل في القوائم مع **الكل** و**المعطلة**. لإعادة تفعيل إرسال الإشعارات والاستجابات للأحداث، يُستخدم خيار **تفعيل**.
* لوقف إرسال الإشعارات والاستجابات للأحداث بشكل دائم، يمكنك حذف المشغل. لا يمكن التراجع عن حذف المشغل. سوف يتم إزالة المشغل بشكل دائم من قائمة المشغلات.

لتعطيل أو حذف المشغل، يُرجى اختيار الخيار المناسب من قائمة المشغل وتأكيد الإجراء إذا لزم الأمر.