# فلترة حسب الـ IP

في قسم **قوائم الـ IP** في واجهة Wallarm، يمكنك التحكم بالوصول إلى تطبيقاتك عن طريق السماح للعناوين، حجبها، وإضافتها إلى القائمة الرمادية.

* **القائمة البيضاء** هي قائمة بالمصادر الموثوقة التي تتجاوز حماية Wallarm وتصل إلى تطبيقاتك دون أي فحوصات.
* **القائمة السوداء** هي قائمة بالمصادر التي لا يمكنها الوصول إلى تطبيقاتك - سيتم حظر جميع الطلبات القادمة منها.
* **القائمة الرمادية** هي قائمة بالمصادر المشبوهة التي يتم معالجتها بواسطة العقدة فقط في وضع الفلترة **الحظر الآمن** كما يلي: إذا كانت العناوين الـ IP المدرجة في القائمة الرمادية تنشئ طلبات ضارة، فإن العقدة تحظرها مع السماح بالطلبات المشروعة.

    الطلبات الضارة القادمة من العناوين الـ IP في القائمة الرمادية هي تلك التي تحتوي على علامات للهجمات التالية:

    * [هجمات التحقق من صحة الإدخال](../../attacks-vulns-list.md#input-validation-attacks)
    * [هجمات نوع vpatch](../rules/vpatch-rule.md)
    * [الهجمات المكتشفة بناءً على التعبيرات العادية](../rules/regex-rule.md)

![جميع قوائم الـ IP](../../images/user-guides/ip-lists/ip-lists-home-apps.png)

## كيف تعمل القائمة البيضاء، القائمة السوداء، والقائمة الرمادية معًا

تستخدم عقدة الفلترة نهجًا مختلفًا بناءً على [الوضع](../../admin-en/configure-wallarm-mode.md) المُحدد لتحليل قوائم الـ IP. في بعض الأوضاع، تقيم جميع أنواع قوائم الـ IP، وهي القوائم البيضاء، والسوداء، والرمادية. ومع ذلك، في أوضاع أخرى، تركز فقط على قوائم الـ IP المحددة.

توضح الصورة أدناه بصريًا الأولويات والتركيبات لقوائم الـ IP في كل وضع تشغيلي، موضحةً قوائم الاعتبار في كل حالة:

![أولويات قائمة الـ IP](../../images/user-guides/ip-lists/ip-lists-priorities.png)

هذا يعني أن:

* في أي وضع، إذا تم العثور على الـ IP في القائمة السابقة، لا يتم النظر في القائمة التالية.
* يتم حظر العناوين الـ IP الموجودة في القائمة السوداء حتى عندما تكون العقدة في وضع `off` أو `المراقبة`.
* يتم النظر في القائمة الرمادية فقط في وضع `الحظر الآمن`.

!!! تحذير "استثناءات"
    إذا كان [`wallarm_acl_access_phase off`](../../admin-en/configure-parameters-en.md#wallarm_acl_access_phase)، فإن عقدة Wallarm لا تحلل القائمة السوداء في وضع `off` ولا تحظر طلبات من العناوين الـ IP الموجودة في القائمة السوداء في وضع `المراقبة`.

## تكوين قوائم الـ IP

الخطوات:

1. حدد أي قائمة تستخدم حسب الغرض الخاص بك.
1. اختر [أي كائن تضيف](#select-object): IP، شبكة فرعية، موقع، نوع المصدر.
1. [اختر المدة](#select-time-to-stay-in-list) التي سيبقى فيها الكائن في قائمة (عادة لا يكون إلى الأبد).
1. [قيّد حسب التطبيق المستهدف](#limit-by-target-application) (ليس كل الطلبات، ولكن تلك الموجهة إلى تطبيق محدد).

### اختر الكائن

استخدم **إضافة كائن** لإضافة ما يلي إلى أي من قوائم الـ IP:

* **IP أو شبكة فرعية** - الحد الأقصى المدعوم لقناع الشبكة الفرعية هو `/32` لعناوين IPv6 و `/12` لعناوين IPv4.

* **الموقع** (البلد أو الإقليم) لإضافة جميع العناوين الـ IP المسجلة في هذا البلد أو الإقليم
* **نوع المصدر** لإضافة جميع العناوين الـ IP التي تنتمي إلى هذا النوع. الأنواع المتاحة هي:

    * محركات البحث
    * مراكز البيانات (AWS، GCP، Oracle، إلخ.)
    * المصادر المجهولة (Tor، Proxy، VPN)
    * [العناوين الـ IP الضارة](#malicious-ip-feeds)

![إضافة كائن إلى قائمة الـ IP](../../images/user-guides/ip-lists/add-ip-to-list.png)

!!! معلومة "التعبئة التلقائية لقوائم الـ IP"
    لاحظ أنه بجانب إضافة الكائنات يدويًا، يمكنك استخدام [التعبئة التلقائية للقوائم](#automatic-listing)، وهو **المفضل**.

### اختر المدة للبقاء في القائمة

عند إضافة كائن إلى القائمة، تحدد المدة التي يُضاف فيها. الحد الأدنى للمدة هو 5 دقائق، الافتراضي هو ساعة واحدة، الحد الأقصى هو إلى الأبد. عند انتهاء الوقت، يتم حذف الكائن تلقائيًا من القائمة.

يمكنك تغيير الوقت المحدد في أي لحظة لاحقة - للقيام بذلك، في قائمة الكائن، انقر على **تغيير فترة الوقت** وقم بالتعديلات.

ضبط هذا الوقت إلى جانب إضافة وحذف الكائنات يدويًا يؤدي إلى تغييرات في قوائم الـ IP بمرور الوقت. يمكنك [عرض الحالات التاريخية](#ip-list-history) لجميع القوائم.

### قيّد حسب التطبيق المستهدف

عند إضافة كائن إلى قائمة، بشكل افتراضي يتم معالجة جميع الطلبات من الـ IP المدرج. ولكن، يمكنك تقييدها بـ [التطبيقات](../../user-guides/settings/applications.md) المستهدفة: اختر تطبيقًا واحدًا أو عدة تطبيقات وستتم معالجة الطلبات من الـ IP المدرج إلى هذه التطبيقات فقط.

## مصادر الـ IP الضارة

عند إضافة [نوع المصدر](#select-object) **العناوين الـ IP الضارة** إلى واحدة من قوائم الـ IP، لاحظ أن هذا سيشمل جميع العناوين الـ IP المعروفة بالنشاط الضار، كما هو مذكور في المصادر العامة، والتي تم التحقق منها عن طريق تحليل الخبراء. نحن نجمع هذه البيانات من مجموعة من الموارد التالية:

* [شبكة الاستخبارات الجماعية للأمن](http://cinsscore.com/list/ci-badguys.txt)
* [قواعد التهديدات الناشئة من بروف بوينت](https://rules.emergingthreats.net/blockrules/compromised-ips.txt)
* [مستودع استخبارات التهديدات الرقمية](http://osint.digitalside.it/Threat-Intel/lists/latestips.txt)
* [جرين سنو](https://blocklist.greensnow.co/greensnow.txt)
* [www.blocklist.de](https://www.blocklist.de/en/export.html)
* [مانع الروبوتات السيئة النهائي لـ NGINX](https://github.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/blob/master/_generator_lists/bad-ip-addresses.list)
* [IPsum](https://github.com/stamparm/ipsum)

## تاريخ قائمة الـ IP

ليس لدى قوائم الـ IP الحالة الحالية فقط، ولكن أيضًا الحالات [التاريخية](#select-time-to-stay-in-list) وهي مختلفة. اختر تواريخ معينة لفحص محتوى قائمة الـ IP، وسيقدم النظام **التاريخ** المفصل لتغييراتها، بما في ذلك التوقيت الدقيق وطريقة الإضافة، سواء كانت يدوية أو آلية. يوفر التقرير أيضًا بيانات حول الأفراد المسؤولين عن التغييرات والأسباب وراء كل إدراج. تساعد هذه الرؤى في الحفاظ على سجل التدقيق للامتثال والتقارير.

![تاريخ قائمة الـ IP](../../images/user-guides/ip-lists/ip-list-history.png)

ارجع إلى علامة التبويب **الآن** للحصول على الحالة الحالية لقائمة الـ IP، مما يتيح لك عرض الكائنات المضمنة حاليًا في القائمة.

## الإدراج التلقائي

يمكنك تمكين Wallarm من إضافة عناوين الـ IP إلى القائمة السوداء أو الرمادية تلقائيًا إذا أنشأت بعض حركة المرور المشبوهة. يمكن القيام بذلك لـ:

* [حماية ضد القوة الغاشمة](../../admin-en/configuration-guides/protecting-against-bruteforce.md)
* [حماية BOLA](../../admin-en/configuration-guides/protecting-against-bola.md)
* [تجاوز الحد المسموح به للحمولات الضارة](../../admin-en/configuration-guides/protecting-with-thresholds.md)
* [منع إساءة استخدام API](../../about-wallarm/api-abuse-prevention.md#how-api-abuse-prevention-works)

لاحظ أنه إذا قمت بحذف عنوان IP تم إدراجه تلقائيًا يدويًا، إذا تم اكتشاف نشاط ضار جديد فسيتم إضافته تلقائيًا مرة أخرى ولكن:

* **ليس قبل** نصف المدة الزمنية السابقة

    على سبيل المثال، إذا تم إضافة عنوان الـ IP تلقائيًا إلى القائمة السوداء لمدة 4 ساعات بسبب هجوم BOLA منه وقمت بحذفه من القائمة السوداء، لن يتم إعادة إضافته خلال الساعتين التاليتين، حتى لو حدثت هجمات.

* لـ **منع إساءة استخدام API** - فورًا

## الحصول على إشعارات حول العناوين الـ IP المضافة إلى القائمة السوداء

يمكنك الحصول على إشعارات حول العناوين الـ IP الجديدة المضافة إلى القائمة السوداء عبر المراسلين أو أنظمة SIEM التي تستخدمها يوميًا. لتمكين الإشعارات، في قسم **المحفزات**، قم بتكوين محفز واحد أو عدة محفزات بشرط **العنوان الـ IP المضاف إلى القائمة السوداء**، مثلاً:

![مثال على محفز للعنوان الـ IP المضاف إلى القائمة الس