# جدار ناري لواجهة برمجة التطبيقات مفتوح المصدر بواسطة Wallarm ![Black Hat Arsenal USA 2022](https://github.com/wallarm/api-firewall/blob/main/images/BHA2022.svg?raw=true)](https://www.blackhat.com/us-22/arsenal/schedule/index.html#open-source-api-firewall-new-features--functionalities-28038)

جدار النار لواجهة برمجة التطبيقات هو وكيل عالي الأداء مع تحقق من طلبات واستجابات واجهة برمجة التطبيقات بناءً على مخططات [OpenAPI](https://wallarm.github.io/api-firewall/installation-guides/docker-container/) و [GraphQL](https://wallarm.github.io/api-firewall/installation-guides/graphql/docker-container/). تم تصميمه لحماية نقاط نهايات REST و GraphQL API في بيئات السحابة الأصلية. يوفر جدار النار لواجهة برمجة التطبيقات تصليبًا لواجهة برمجة التطبيقات باستخدام نموذج أمان إيجابي يسمح بالمكالمات التي تطابق مواصفات واجهة برمجة التطبيقات المحددة مسبقًا للطلبات والاستجابات، مع رفض كل شيء آخر.

**الميزات الأساسية** لجدار النار لواجهة برمجة التطبيقات هي:

* تأمين نقاط نهايات REST و GraphQL API عن طريق حظر الطلبات الضارة
* وقف خروقات بيانات واجهة برمجة التطبيقات بحظر استجابات واجهة برمجة التطبيقات المشوهة
* اكتشاف نقاط نهايات Shadow API
* التحقق من رموز الوصول JWT للمصادقة بناءً على بروتوكول OAuth 2.0
* القائمة السوداء لرموز واجهة برمجة التطبيقات المخترقة، والمفاتيح، والكوكيز

المنتج هو **مفتوح المصدر**، متاح في DockerHub وقد حصل بالفعل على 1 مليار (!!!) عملية سحب. لدعم هذا المشروع، يمكنك إعطاء نجمة لـ[المستودع](https://hub.docker.com/r/wallarm/api-firewall).

## أوضاع التشغيل

يقدم جدار النار لواجهة برمجة التطبيقات عدة أوضاع تشغيل:

* [`PROXY`](https://wallarm.github.io/api-firewall/installation-guides/docker-container/): يهيئ طلبات واستجابات HTTP ضد OpenAPI 3.0 ويوجه الطلبات المتطابقة إلى الخلفية.
* [`API`](https://wallarm.github.io/api-firewall/installation-guides/api-mode/): يهيئ طلبات فردية ضد OpenAPI 3.0 دون إعادة التوجيه اللاحقة.
* [`graphql`](https://wallarm.github.io/api-firewall/installation-guides/graphql/docker-container/): يهيئ طلبات HTTP و WebSocket ضد مخطط GraphQL ويوجه الطلبات المتطابقة إلى الخلفية.

## حالات استخدام

### التشغيل في وضع الحظر

* حظر الطلبات الضارة التي لا تطابق المواصفات
* حظر استجابات واجهة برمجة التطبيقات المشوهة لوقف خروقات البيانات وتعرض المعلومات الحساسة

### التشغيل في وضع المراقبة

* اكتشاف Shadow APIs ونقاط نهايات واجهة برمجة التطبيقات غير الموثقة
* تسجيل الطلبات والاستجابات المشوهة التي لا تطابق المواصفات

## التحقق من مخطط واجهة برمجة التطبيقات والنموذج الأمني الإيجابي

عند بدء جدار النار لواجهة برمجة التطبيقات، يجب تقديم مواصفات واجهة برمجة التطبيقات REST أو GraphQL للتطبيق المراد حمايته بواسطة جدار النار لواجهة برمجة التطبيقات. سيعمل جدار النار لواجهة برمجة التطبيقات المبدوء كوكيل عكسي ويتحقق مما إذا كانت الطلبات والاستجابات تطابق المخطط المحدد في المواصفات.

سيتم تسجيل الحركة التي لا تطابق المخطط باستخدام خدمات [`STDOUT` و `STDERR` Docker](https://docs.docker.com/config/containers/logging/) أو حظرها (اعتمادًا على وضع تشغيل جدار النار لواجهة برمجة التطبيقات المكون). عند التشغيل في وضع السجل على REST API، يقوم جدار النار لواجهة برمجة التطبيقات أيضًا بتسجيل ما يسمى بنقاط نهايات Shadow API، تلك التي ليست مشمولة في مواصفات واجهة برمجة التطبيقات ولكن تستجيب للطلبات (ما عدا نقاط النهاية التي تعيد الكود `404`).

![مخطط جدار النار لواجهة برمجة التطبيقات](https://github.com/wallarm/api-firewall/blob/main/images/Firewall%20opensource%20-%20vertical.gif?raw=true)

من خلال السماح لك بتعيين متطلبات الحركة بمواصفات واجهة برمجة التطبيقات، يعتمد جدار النار لواجهة برمجة التطبيقات على نموذج أمان إيجابي.

## البيانات التقنية

[يعمل جدار النار لواجهة برمجة التطبيقات](https://www.wallarm.com/what/the-concept-of-a-firewall) كوكيل عكسي بمدقق طلبات واستجابات مدمج لـ OpenAPI 3.0 أو GraphQL. تم كتابته باستخدام Golang ووكيل fasthttp. المشروع مُحسّن لأقصى أداء وبزيادة زمن تأخير قريبة من الصفر.

## بدء جدار النار لواجهة برمجة التطبيقات

لتحميل، تثبيت وبدء جدار النار لواجهة برمجة التطبيقات على Docker، راجع:

* [دليل واجهة برمجة التطبيقات REST](https://wallarm.github.io/api-firewall/installation-guides/docker-container/)
* [دليل واجهة برمجة التطبيقات GraphQL](https://wallarm.github.io/api-firewall/installation-guides/graphql/docker-container/)

## العروض التوضيحية

يمكنك تجربة جدار النار لواجهة برمجة التطبيقات بتشغيل بيئة العرض التوضيحي التي تنشر تطبيقًا مثاليًا محميًا بجدار النار لواجهة برمجة التطبيقات. هناك بيئتان عرض توضيحي متاحتان:

* [عرض توضيحي لجدار النار لواجهة برمجة التطبيقات مع Docker Compose](https://github.com/wallarm/api-firewall/tree/main/demo/docker-compose)
* [عرض توضيحي لجدار النار لواجهة برمجة التطبيقات مع Kubernetes](https://github.com/wallarm/api-firewall/tree/main/demo/kubernetes)

## مقالات مدونة Wallarm المتعلقة بجدار النار لواجهة برمجة التطبيقات

* [اكتشاف Shadow APIs بواسطة جدار النار لواجهة برمجة التطبيقات](https://lab.wallarm.com/discovering-shadow-apis-with-a-api-firewall/)
* [جدار النار لواجهة برمجة التطبيقات من Wallarm يتفوق على NGINX في بيئة الإنتاج](https://lab.wallarm.com/wallarm-api-firewall-outperforms-nginx-in-a-production-environment/)
* [تأمين واجهات برمجة التطبيقات REST مجانًا مع OSS APIFW](https://lab.wallarm.com/securing-rest-with-free-api-firewall-how-to-guide/)

## الأداء

عند إنشاء جدار النار لواجهة برمجة التطبيقات، أعطينا الأولوية للسرعة والكفاءة لضمان حصول عملائنا على أسرع واجهات برمجة التطبيقات ممكنة. تظهر اختباراتنا الأخيرة أن الوقت اللازم في المتوسط لجدار النار لواجهة برمجة التطبيقات لمعالجة طلب واحد هو 1.339 مللي ثانية وهو أسرع بنسبة 66% من Nginx:

```
جدار النار لواجهة برمجة التطبيقات 0.6.2 مع التحقق من JSON

$ ab -c 200 -n 10000 -p ./large.json -T application/json http://127.0.0.1:8282/test/signup

الطلبات في الثانية:    13005.81 [#/ثانية] (متوسط)
الوقت لكل طلب:       15.378 [مللي ثانية] (متوسط)
الوقت لكل طلب:       0.077 [مللي ثانية] (متوسط، عبر جميع الطلبات المتزامنة)

NGINX 1.18.0 بدون التحقق من JSON

$ ab -c 200 -n 10000 -p ./large.json -T application/json http://127.0.0.1/test/signup

الطلبات في الثانية:    7887.76 [#/ثانية] (متوسط)
الوقت لكل طلب:       25.356 [مللي ثانية] (متوسط)
الوقت لكل طلب:       0.127 [مللي ثانية] (متوسط، عبر جميع الطلبات المتزامنة)
```

هذه النتائج في الأداء ليست الوحيدة التي حصلنا عليها خلال اختبار جدار النار لواجهة برمجة التطبيقات. يتم وصف النتائج الأخرى مع الطرق المستخدمة لتحسين أداء جدار النار لواجهة برمجة التطبيقات في هذا [مقال مدونة Wallarm](https://lab.wallarm.com/wallarm-api-firewall-outperforms-nginx-in-a-production-environment/).