# التحقق من صحة الطلبات الفردية دون التوجيه الوكيلي

إذا كنت بحاجة إلى التحقق من صحة طلبات API الفردية بناءً على مواصفات OpenAPI المعطاة دون مزيد من التوجيه الوكيلي، يمكنك استخدام Wallarm API Firewall في وضع غير الوكيل. في هذه الحالة، الحل لا يقوم بالتحقق من الاستجابات.

!!! info "توفر الميزة"
    هذه الميزة متاحة لنسخ الجدار الناري للواجهة البرمجية ابتداءً من الإصدار 0.6.12 وما بعده، وهي مصممة لواجهة برمجة التطبيقات REST.

للقيام بذلك:

1. بدلاً من [تثبيت ملف مواصفات OpenAPI](../installation-guides/docker-container.md) على الحاوية، قم بتثبيت [قاعدة بيانات SQLite](https://www.sqlite.org/index.html) التي تحتوي على واحدة أو أكثر من مواصفات OpenAPI 3.0 إلى `/var/lib/wallarm-api/1/wallarm_api.db`. يجب أن تتبع قاعدة البيانات النظام التالي:

    * `schema_id`, integer (auto-increment) - معرف المواصفة.
    * `schema_version`, string - إصدار المواصفة. يمكنك تعيين أي إصدار تفضله. عند تغيير هذا الحقل، يفترض جدار الواجهة البرمجية أن المواصفة نفسها قد تغيرت ويقوم بتحديثها وفقًا لذلك.
    * `schema_format`, string - صيغة المواصفة، يمكن أن تكون `json` أو `yaml`.
    * `schema_content`, string - محتوى المواصفة.
1. تشغيل الحاوية بمتغير البيئة `APIFW_MODE=API` وإذا لزم الأمر، بمتغيرات أخرى مصممة خصيصاً لهذا الوضع:

    | متغير البيئة | الوصف |
    | ------------ | ----------- |
    | `APIFW_MODE` | يحدد وضع جدار الواجهة البرمجية العام. القيم الممكنة هي [`PROXY`](docker-container.md) (افتراضي)، [`graphql`](graphql/docker-container.md)، و`API`. |
    | `APIFW_SPECIFICATION_UPDATE_PERIOD` | يحدد تواتر تحديثات المواصفات. إذا تم ضبطه على `0`، يتم تعطيل تحديث المواصفات. القيمة الافتراضية هي `1m` (دقيقة واحدة). |
    | `APIFW_API_MODE_UNKNOWN_PARAMETERS_DETECTION` | يحدد ما إذا كان سيتم إرجاع رمز خطأ إذا لم تطابق معايير الطلب تلك المحددة في المواصفات. القيمة الافتراضية هي `true`. |
    | `APIFW_PASS_OPTIONS` | عند ضبطه على `true`، يسمح جدار الواجهة البرمجية بطلبات `OPTIONS` إلى النقاط النهائية في المواصفة، حتى لو لم يتم وصف طريقة `OPTIONS`. القيمة الافتراضية هي `false`. |

1. عند تقييم ما إذا كانت الطلبات تتماشى مع المواصفات المثبتة، قم بتضمين الرأس `X-Wallarm-Schema-ID: <schema_id>` للإشارة إلى جدار الواجهة البرمجية أي مواصفة يجب استخدامها للتحقق من الصحة.

يقوم جدار الواجهة البرمجية بالتحقق من صحة الطلبات على النحو التالي:

* إذا كان الطلب يطابق المواصفة، يتم إرجاع استجابة فارغة برمز حالة 200.
* إذا لم يطابق الطلب المواصفة، سيتم توفير استجابة برمز حالة 403 ووثيقة JSON توضح أسباب عدم المطابقة.
* إذا كان غير قادر على التعامل مع الطلب أو التحقق من صحته، يتم إرجاع استجابة فارغة برمز حالة 500.