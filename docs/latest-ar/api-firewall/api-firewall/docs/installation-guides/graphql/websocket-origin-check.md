# تحقق من أصل الويب سوكت

عندما يبدأ المتصفح في إنشاء اتصال بالويب سوكت، فإنه يضم بشكل تلقائي رأس `Origin` الذي يدل على النطاق الذي يأتي منه الطلب. مع جدار حماية واجهة برمجة التطبيقات من Wallarm، يمكنك التأكد من أن قيمة رأس `Origin` تتطابق مع قائمتك المحددة مسبقًا خلال مرحلة تحديث اتصال الويب سوكت. يوضح هذا المقال الخطوات لتفعيل التحقق من `Origin` لـ[استعلامات GraphQL](docker-container.md).

بشكل افتراضي، ميزة التحقق من أصل الويب سوكت معطلة. لتفعيلها، قم بتهيئة المتغيرات البيئية التالية:
 
| المتغير البيئي | الوصف |
| ------------- | ----- |
| `APIFW_GRAPHQL_WS_CHECK_ORIGIN` | يمكن التحقق من رأس `Origin` خلال مرحلة تحديث الويب سوكت. الافتراضي: `false`. |
| `APIFW_GRAPHQL_WS_ORIGIN` (مطلوب إذا كان `APIFW_GRAPHQL_WS_CHECK_ORIGIN` هو `true`) | قائمة بأصول الويب سوكت المسموح بها. الأصول مفصولة بـ `;`. |

يعمل `APIFW_GRAPHQL_WS_CHECK_ORIGIN` بشكل مستقل عن [`APIFW_GRAPHQL_REQUEST_VALIDATION`](docker-container.md#apifw-graphql-request-validation). سيتم حظر طلبات الويب سوكت ذات رؤوس `Origin` غير صحيحة بغض النظر عن وضع تحقق الطلب.