# كشف التمحيص بالبيانات <a href="../subscription-plans/#subscription-plans"><img src="../../images/api-security-tag.svg" style="border: none;"></a>

[التمحيص بالبيانات](../attacks-vulns-list.md#credential-stuffing) هو هجوم الكتروني حيث يستخدم القراصنة قوائم ببيانات الاستخدام المخترقة للوصول غير المصرح به إلى حسابات المستخدمين على مواقع متعددة. يصف هذا المقال كيفية كشف هذا النوع من التهديدات باستخدام **كشف التمحيص بالبيانات** من Wallarm.

تعد هجمة التمحيص بالبيانات خطيرة بسبب الممارسة المعتادة لإعادة استخدام أسماء المستخدمين وكلمات المرور نفسها عبر خدمات مختلفة، بالإضافة إلى ميل اختيار كلمات المرور السهلة التخمين (الضعيفة). تتطلب هجمة التمحيص الناجحة عدداً أقل من المحاولات، لذا يمكن للمهاجمين إرسال الطلبات بتردد أقل، مما يجعل الإجراءات القياسية مثل حماية القوة الغاشمة غير فعالة.

## كيف تعالج Wallarm التمحيص بالبيانات

تجمع **كشف التمحيص بالبيانات** من Wallarm وتعرض معلومات في الوقت الفعلي عن محاولات استخدام بيانات الاستخدام المخترقة أو الضعيفة للوصول إلى تطبيقاتك. كما تتيح إشعارات فورية عن مثل هذه المحاولات وتشكيل قائمة قابلة للتحميل بجميع البيانات المخترقة أو الضعيفة التي توفر الوصول إلى تطبيقاتك.

لتحديد البيانات المخترقة والضعيفة، تستخدم Wallarm قاعدة بيانات شاملة تضم أكثر من **850 مليون سجل** جمعت من قاعدة بيانات [HIBP](https://haveibeenpwned.com/) المخترقة.

![التمحيص بالبيانات - مخطط](../images/about-wallarm-waf/credential-stuffing/credential-stuffing-schema.png)

تحافظ **كشف التمحيص بالبيانات** من Wallarm على سلامة بيانات البيانات عن طريق تطبيق التسلسل التالي من الإجراءات:

1. عند وصول الطلب إلى العقدة، يتم إنشاء [SHA-1](https://en.wikipedia.org/wiki/SHA-1) من كلمة المرور وإرسال عدة أحرف إلى السحابة.
1. تفحص السحابة قاعدة بياناتها للبيانات المخترقة المعروفة بحثًا عن تلك التي تبدأ بالأحرف المستلمة. إذا تم العثور عليها، يتم إرسالها إلى العقدة بتنسيق SHA-1 المشفر، وتقارن العقدة بها كلمة المرور من الطلب.
1. إذا كان هناك تطابق، فإن العقدة تبلغ بوجود هجمة التمحيص بالبيانات إلى السحابة، بما في ذلك تسجيل الدخول المأخوذ من الطلب إلى هذه المعلومات الهجومية.
1. يتم تمرير الطلب إلى التطبيق.

وبالتالي، لا يتم إرسال كلمات المرور من الآلات ذات العقد Wallarm إلى سحابة Wallarm دون تشفير. البيانات غير مرسلة في وقت واحد، مما يضمن بقاء بيانات تفويض العملاء آمنة داخل شبكتك.

**محاولات جماعية وفردية**

تقدر **كشف التمحيص بالبيانات** على تسجيل كل من المحاولات الجماعية لاستخدام البيانات المخترقة التي يؤديها الروبوتات والمحاولات الفردية، التي لا يتم اكتشافها بوسائل أخرى.

**تدابير التخفيف**

معرفة الحسابات ذات كلمات المرور المسروقة أو الضعيفة تتيح لك اتخاذ تدابير لتأمين بيانات هذه الحسابات، مثل التواصل مع أصحاب الحسابات، تعليق الوصول إلى الحسابات مؤقتاً، وغير ذلك.

لا تقوم Wallarm بحظر الطلبات التي تحتوي على بيانات مخترقة لتجنب حظر المستخدمين الشرعيين حتى إذا كانت كلمات المرور الخاصة بهم ضعيفة أو مخترقة. ومع ذلك، يُرجى ملاحظة أنه يمكن حظر محاولات التمحيص بالبيانات إذا:

* كانت جزءًا من أنشطة الروبوتات الضارة المكتشفة وقمت بتفعيل وحدة [منع إساءة استخدام API](../about-wallarm/api-abuse-prevention.md).
* كانت جزءًا من الطلبات التي تحتوي على علامات [هجوم أخرى](../attacks-vulns-list.md).

## التفعيل

لتفعيل **كشف التمحيص بالبيانات** من Wallarm:

1. تأكد من أن [خطة الاشتراك](../about-wallarm/subscription-plans.md#subscription-plans) تتضمن **كشف التمحيص بالبيانات**. لتغيير خطة الاشتراك، يرجى إرسال طلب إلى [sales@wallarm.com](mailto:sales@wallarm.com?subject=Change%20Wallarm%20subscription%20plan%20to%20include%20Credential%20Stuffing%20Detection&body=Hello%20Wallarm%20Sales%20Team%2C%0AI%27m%20writing%20to%20request%20the%20change%20of%20Wallarm%20subscription%20plan%20to%20the%20one%20that%20includes%20the%20Credential%20Stuffing%20Detection.%0AThank%20you%20for%20your%20time%20and%20assistance.).
1. تأكد من أن عقدة Wallarm الخاصة بك [الإصدار 4.10](../updating-migrating/what-is-new.md) أو أعلى، مُستخدمًا من خلال أحد القطع الفنية المحددة:

    * [مثبت شامل](../installation/nginx/all-in-one.md)
    * [رسم بياني بواسطة Helm لوحدة التحكم في الوصول القائمة على NGINX](../admin-en/installation-kubernetes-en.md)
    * [صورة Docker قائمة على NGINX](../admin-en/installation-docker-en.md)
    * [صورة آلة Amazon (AMI)](../installation/cloud-platforms/aws/ami.md)
    * [صورة آلة Google Cloud](../installation/cloud-platforms/gcp/machine-image.md)
1. تحقق من أن [دور](../user-guides/settings/users.md#user-roles) مستخدمك يسمح بتكوين **كشف التمحيص بالبيانات**.
1. في لوحة تحكم Wallarm → **كشف التمحيص بالبيانات**، قم بتفعيل الوظيفة (معطلة كافتراضي).

بمجرد تفعيل **كشف التمحيص بالبيانات**، يلزم إجراء [تهيئة](#configuring) لها لبدء العمل.

## التكوين

تحتاج إلى تشكيل قائمة نقاط النهاية للمصادقة للتحقق من محاولات استخدام البيانات المخترقة. لتشكيل القائمة، انتقل إلى لوحة تحكم Wallarm → **كشف التمحيص بالبيانات**.

![لوحة تحكم Wallarm - كشف التمحيص بالبيانات](../images/about-wallarm-waf/credential-stuffing/credential-stuffing.png)

هناك طريقتان لإضافة نقاط النهاية إلى القائمة:

* من قائمة **نقاط النهاية الموصى بها** التي تتضمن نوعين من العناصر:

    * القواعد المحددة مسبقاً من Wallarm باستخدام التعبيرات النمطية لتحديد نقاط النهاية للمصادقة الشائعة الاستخدام ومعلماتها التي تخزن كلمات السر وتسجيلات الدخول.
    <!--
        ![التمحيص بالبيانات - نقاط النهاية الموصى بها - القواعد المحددة مسبقًا](../images/about-wallarm-waf/credential-stuffing/credential-stuffing-predefined-rules.png)
    -->
    * نقاط النهاية المستخدمة للمصادقة التي وجدها وحدة [اكتشاف API](../api-discovery/overview.md) وسجلت كما تلقت الحركة بالفعل.

* يدوياً - يمكنك أيضاً إضافة نقاط النهاية الفريدة الخاصة بك للمصادقة، مؤمناً الحماية الكاملة. عند الإضافة يدوياً، حدد [URI](../user-guides/rules/rules.md#uri-constructor) وطريقة البحث عن معلمات المصادقة:

    * بواسطة **الموقع الدقيق للمعلمات** - سوف تحتاج إلى تحديد [نقاط الطلب](../user-guides/rules/rules.md#points) الدقيقة التي يتم فيها تحديد كلمة المرور وتسجيل الدخول.
    <!--
        ![التمحيص بالبيانات - إضافة نقطة نهاية المصادقة - الموقع الدقيق](../images/about-wallarm-waf/credential-stuffing/credential-stuffing-add-endpoint-exact-location.png)
    -->
    * بواسطة **التعبير النمطي** - سيتم البحث عن معلمات نقطة النهاية بكلمة المرور وتسجيل الدخول باستخدام [التعبير النمطي](../user-guides/rules/rules.md#condition-type-regex).
    
        ![التمحيص بالبيانات - إضافة نقطة نهاية للمصادقة - التعبير النمطي](../images/about-wallarm-waf/credential-stuffing/credential-stuffing-add-endpoint-regexp.png)

## عرض محاولات استخدام البيانات المخترقة

يتم عرض عدد محاولات استخدام البيانات المخترقة في آخر 7 أيام في قسم **كشف التمحيص بالبيانات**. اضغط على العداد وسوف يتم توجيهك إلى قسم **الهجمات** الذي سيعرض جميع الهجمات [`credential_stuffing`](../user-guides/search-and-filters/use-search.md#search-by-attack-type) لآخر 7 أيام.

قم بتوسيع أي من الهجمات لرؤية قائمة تسجيلات الدخول التي تم اختراق كلمات المرور الخاصة بها.

![الهجمات - التمحيص بالبيانات](../images/about-wallarm-waf/credential-stuffing/credential-stuffing-attacks.png)

## الحصول على قائمة CSV للبيانات المخترقة

يتم عرض العدد الإجمالي للبيانات المخترقة في قسم **كشف التمحيص بالبيانات**. اضغط على العداد وسيقوم متصفحك بتحميل الملف CSV بقائمة البيانات المخترقة.

## الحصول على إشعارات

يمكنك الحصول على إشعارات فورية عن محاولات استخدام البيانات المخترقة على بريدك الإلكتروني، المراسل أو أحد [الأنظمة المدمجة](../user-guides/settings/integrations/integrations-intro.md) لديك. لتفعيل هذه الإشعارات، في قسم **المشغلات** في لوحة تحكم Wallarm، قم بتكوين واحد أو أكثر من المشغلات بشرط **حساب المستخدم المخترق**.

يمكنك تحديد الإشعارات بحسب التطبيق أو المضيف الذي ترغب في مراقبته وبحسب نوع الرد.

**مثال