[al-brute-force-attack]:      ../../attacks-vulns-list.md#brute-force-attack
[al-forced-browsing]:         ../../attacks-vulns-list.md#forced-browsing

# نظرة عامة حول التحقق من التهديدات النشطة <a href="../../../about-wallarm/subscription-plans/#subscription-plans"><img src="../../../images/api-security-tag.svg" style="border: none;"></a>

يحول التحقق من التهديدات النشطة في Wallarm المهاجمين إلى مختبري اختراق خاصين بك. يحلّل محاولات الهجوم الأولية، ثم يستكشف طرقًا أخرى يمكن بها استغلال نفس الهجوم. هذا يكشف عن نقاط ضعف في بيئتك لم يجدها حتى المهاجمون الأصليون.

قدرات التحقق من التهديدات النشطة:

* **الاختبار في الوقت الفعلي**: يستخدم بيانات الهجوم المباشرة لتحديد نقاط الضعف الحالية والمستقبلية المحتملة، مما يجعلك خطوة واحدة أمام القراصنة.
* **المحاكاة الآمنة والذكية**: يتجاوز تفاصيل المصادقة الحساسة ويزيل الرموز الضارة في الاختبارات. يحاكي تقنيات الهجوم لأقصى درجات الأمان، دون المخاطرة بالأذى الفعلي.
* **الاختبارات الآمنة في بيئات غير إنتاجية**: يمكنك من [إجراء فحوصات الضعف في بيئة مرحلية أو تطويرية](running-test-on-staging.md) باستخدام بيانات إنتاجية حقيقية، لكن دون مخاطر مثل التحميل الزائد للنظام أو تعرض البيانات.

## كيفية العمل

وحدة التحقق من التهديدات النشطة تعمل على سحابة Wallarm. في البداية، تجمع الوحدة معلومات مفصلة عن الطلبات الضارة التي كشف عنها [عقدة تصفية Wallarm](../../installation/supported-deployment-options.md) وتم تحميلها إلى السحابة. باستخدام هذه البيانات المكتسبة، تولد الوحدة مجموعة ديناميكية تتراوح بين 100-150 طلب اختبار. هذه الطلبات تستهدف نفس أنواع الضعف كما في الطلبات الضارة لكن باستخدام حمولات مختلفة.

مجموعة المحاكاة للهجمات المُنشأة مُوجهة إلى نفس عنوان الطلب الضار الأصلي. ومع ذلك، توفر الوحدة مرونة في [إعادة توجيه هذه الطلبات إلى وجهات بديلة](running-test-on-staging.md)، مثل البيئات المرحلية أو التطويرية.

عن طريق تحليل الاستجابات لطلبات الاختبار، تحدد الوحدة الضعف لأنواع [الهجمات المحددة](../../attacks-vulns-list.md). يتم تسجيل الضعف المكتشف في قسم [**الضعف**](../../user-guides/vulnerabilities.md) في واجهة مستخدم وحدة التحكم في Wallarm. بالإضافة إلى ذلك، لديك الخيار لاستلام [إشعارات](../../user-guides/settings/integrations/integrations-intro.md) حول هذه النتائج.

الرسم التوضيحي التالي يظهر كيفية عمل الوحدة:

![مخطط ATV](../../images/vulnerability-detection/active-threat-verification-scheme-prod.png)

الطلبات المُنشأة تحمل رأسًا `User-Agent: Wallarm Threat-Verification (v1.x)`، مما يساعد في التمييز بينها وبين طلبات أخرى.

### أمان طلب الاختبار

تم تصميم وحدة التحقق من التهديدات النشطة لإنشاء طلبات الاختبار بأمان قدر الإمكان، وتتميز بالخصائص الرئيسية التالية:

* حمولات الطلبات الضارة المُنشأة لا تشمل نحوًا ضارًا حقيقيًا، بل تُقصد فقط لتقليد مبدأ الهجوم. نتيجةً لذلك، لا تضر بمواردك.
* يتم استبعاد رؤوس المصادقة مثل `Cookie`، `Authorization: Basic`، و`Viewstate` من الطلبات المُعاد تشغيلها. بالإضافة، كما يوجهه [الرؤوس الخاصة بالمصادقة المخصصة](modify-requests-before-replay.md#replacing-original-authentication-data-with-test-data) و[قاعدة التمويه](../../user-guides/rules/sensitive-data-rule.md)، يمكن تكييف أو إزالة أي رؤوس إضافية حسب الضرورة.

### مثال

خذ في الاعتبار الطلب GET التالي الذي تم كشفه في البداية بواسطة عقدة تصفية Wallarm وتم تحميله إلى السحابة:

```bash
https://example.com/login&user=UNION SELECT username, password
```

من الطلب، تتعلم الوحدة التفاصيل التالية:

* العنوان المستهدف هو `https://example.com/login`
* نوع الهجوم المستخدم هو SQLi (وفقًا لحمولة `UNION SELECT username, password`)
* معلمة الاستعلام المستهدفة هي `user`
* قطعة إضافية من المعلومات المقدمة في الطلب هي عامل الاستعلام `token=IyEvYmluL3NoCg` (من المحتمل أنها مستخدمة بواسطة التطبيق لمصادقة المستخدم)

بناءً على هذه البيانات، تولد الوحدة سلسلة من طلبات الاختبار. تركز هذه الطلبات على الضعف لحقن SQL المحتملة باستخدام حمولات متنوعة، مثل:

```bash
https://example.com/login&user=1')+WAITFOR+DELAY+'0 indexpt'+AND+('wlrm'='wlrm
https://example.com/login&user=1+AND+SLEEP(10)--+wlrm
https://example.com/login&user=1);SELECT+PG_SLEEP(10)--
https://example.com/login&user=1'+OR+SLEEP(10)+AND+'wlrm'='wlrm
https://example.com/login&user=1+AND+1=(SELECT+1+FROM+PG_SLEEP(10))
https://example.com/login&user=%23'%23\x22%0a-sleep(10)%23
https://example.com/login&user=1';+WAITFOR+DELAY+'0code:10'--
https://example.com/login&user=1%27%29+OR+SLEEP%280%29+AND+%28%27wlrm%27%3D%27wlrm
https://example.com/login&user=SLEEP(10)/*'XOR(SLEEP(10))OR'|\x22XOR(SLEEP(10))OR\x22*/
```

## تمكين الوحدة

الوحدة معطلة بشكل افتراضي. لتفعيلها:

1. تأكد من أن لديك [خطة اشتراك](../../about-wallarm/subscription-plans.md#subscription-plans) **متقدمة لأمان API**. الوحدة متاحة فقط تحت هذه الخطة.

    إذا كنت على خطة مختلفة، يرجى الاتصال بفريق [المبيعات](mailto:sales@wallarm.com) للانتقال إلى الخطة المطلوبة.
1. اذهب إلى وحدة التحكم في Wallarm → **الضعف** → **تكوين** عبر الرابط لـ [سحابة الولايات المتحدة](https://us1.my.wallarm.com/vulnerabilities/active?configure=true) أو [سحابة الاتحاد الأوروبي](https://my.wallarm.com/vulnerabilities/active?configure=true)، وقم بتفعيل مفتاح **التحقق من التهديد النشط**.

لديك أيضًا القدرة على [ضبط أو تخصيص سلوك الوحدة](enable-disable-active-threat-verification.md) لنقاط النهاية المحددة.

## القيود

التحقق من التهديدات النشطة غير متاح لـ [الهجمات التي تتكون من ضربات مجمعة حسب عناوين IP الأصلية](../../admin-en/configuration-guides/protecting-with-thresholds.md).