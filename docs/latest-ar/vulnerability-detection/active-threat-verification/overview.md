[al-brute-force-attack]:      ../../attacks-vulns-list.md#bruteforce-attack
[al-forced-browsing]:         ../../attacks-vulns-list.md#forced-browsing

# Overview of Active Threat Verification <a href="../../../about-wallarm/subscription-plans/#subscription-plans"><img src="../../../images/api-security-tag.svg" style="border: none;"></a>

تحوّل خاصية التحقق من التهديدات النشطة في Wallarm المهاجمين إلى مختبري اختراق خاصين بك. تقوم بتحليل محاولات الهجوم الأولية، ثم تستكشف طرقًا أخرى يمكن من خلالها استغلال نفس الهجوم. هذا يكشف عن نقاط الضعف في بيئتك التي حتى المهاجمين الأصليين لم يجدوها.

قدرات التحقق من التهديدات النشطة:

* **الاختبار في الوقت الحقيقي**: يستخدم بيانات الهجوم الحية للكشف عن نقاط الضعف الحالية والمستقبلية المحتملة، مما يبقيك خطوة واحدة أمام القراصنة.
* **المحاكاة الآمنة والذكية**: يتجاوز تفاصيل المصادقة الحساسة ويزيل الكود الضار في الاختبارات. يُحاكي تقنيات الهجوم للحصول على أقصى قدر من الأمان، دون المخاطرة بالضرر الفعلي.
* **اختبارات آمنة خارج الإنتاج**: تمكنك من [إجراء فحوصات الثغرات الأمنية في بيئة تطوير أو مرحلة تحضيرية](running-test-on-staging.md) باستخدام بيانات الإنتاج الحقيقية، ولكن دون المخاطر مثل تحميل النظام أو التعرض للبيانات.

## كيف يعمل

يعمل وحدة التحقق من التهديدات النشطة على Cloud الخاص بـ Wallarm. في البداية، تجمع الوحدة معلومات مفصلة عن الطلبات الضارة التي كشف عنها [عقد تصفية Wallarm](../../installation/supported-deployment-options.md) وتم رفعها إلى الCloud. مستفيدةً من هذه البيانات المكتسبة، تُنشئ الوحدة ديناميكيًّا مجموعة مكونة من حوالي 100-150 طلب اختبار. تستهدف هذه الطلبات نفس أنواع الثغرات الأمنية مثل تلك الضارة ولكن باستخدام حمولات مختلفة.

يتم توجيه مجموعة المحاكاة الهجومية الناتجة إلى نفس العنوان مثل الطلب الضار الأصلي. ومع ذلك، توفر الوحدة المرونة لـ [إعادة توجيه هذه الطلبات الاختبارية إلى وجهات بديلة](running-test-on-staging.md)، مثل بيئات التطوير أو المرحلة التحضيرية.

من خلال تحليل الردود على الطلبات الاختبارية، تحدد الوحدة القابلية للثغرات الأمنية لأنواع [الهجمات المحددة](../../attacks-vulns-list.md). يتم تصنيف الثغرات الأمنية المكتشفة في قسم [**الثغرات الأمنية**](../../user-guides/vulnerabilities.md) في واجهة مستخدم Wallarm Console. بالإضافة إلى ذلك، لديك خيار تلقي [إشعارات](../../user-guides/settings/integrations/integrations-intro.md) حول هذه النتائج.

الرسم التوضيحي التالي يوضح كيف تعمل الوحدة:

![ATV scheme](../../images/vulnerability-detection/active-threat-verification-scheme-prod.png)

تحمل الطلبات المتولدة عنوان الرأس `User-Agent: Wallarm Threat-Verification (v1.x)`، مما يساعد على تمييزها عن طلبات أخرى.

### أمان طلب الاختبار

تم تصميم وحدة التحقق من التهديدات النشطة لإنشاء طلبات الاختبار بأمان قدر الإمكان، متميزةً بالخصائص الرئيسية التالية:

* لا تتضمن حمولات الطلبات المتولدة أي صياغة ضارة حقيقية، فهي مجرد تقليد لمبدأ الهجوم. نتيجة لذلك، لا تضر بمواردك.
* يتم استبعاد رؤوس المصادقة مثل `Cookie`، `Authorization: Basic`، و `Viewstate` من الطلبات المُعاد تشغيلها. علاوة على ذلك، كما يوجه به [رؤوس المصادقة المخصصة](modify-requests-before-replay.md#replacing-original-authentication-data-with-test-data) و[قاعدة التمويه](../../user-guides/rules/sensitive-data-rule.md)، يمكن تعديل أو إزالة أي رؤوس إضافية حسب الحاجة.

### المثال

ضع في اعتبارك الطلب GET التالي الذي تم اكتشافه بواسطة عقدة تصفية Wallarm وتم رفعه إلى الCloud:

```bash
https://example.com/login&user=UNION SELECT username, password
```

من الطلب، تتعلم الوحدة التفاصيل التالية:

* العنوان المُهاجم هو `https://example.com/login`
* نوع الهجوم المستخدم هو SQLi (حسب حمولة `UNION SELECT username, password`)
* المعامل في سلسلة الاستعلام المُهاجم هو `user`
* قطعة المعلومات الإضافية المقدمة في الطلب هي المعامل في سلسلة الطلب `token=IyEvYmluL3NoCg` (من المحتمل أن تستخدمها التطبيق لمصادقة المستخدم)

مستفيدةً من هذه البيانات، تصنع الوحدة سلسلة من طلبات الاختبار. تتركز هذه الطلبات على الثغرات الأمنية المحتملة لحقن SQL باستخدام حمولات متنوعة، مثل:

```bash
https://example.com/login&user=1')+WAITFOR+DELAY+'0 indexpt'+AND+('wlrm'='wlrm
https://example.com/login&user=1+AND+SLEEP(10)--+wlrm
https://example.com/login&user=1);SELECT+PG_SLEEP(10)--
https://example.com/login&user=1'+OR+SLEEP(10)+AND+'wlrm'='wlrm
https://example.com/login&user=1+AND+1=(SELECT+1+FROM+PG_SLEEP(10))
https://example.com/login&user=%23'%23\x22%0a-sleep(10)%23
https://example.com/login&user=1';+WAITFOR+DELAY+'0code:10'--
https://example.com/login&user=1%27%29+OR+SLEEP%280%29+AND+%28%27wlrm%27%3D%27wlrm
https://example.com/login&user=SLEEP(10)/*'XOR(SLEEP(10))OR'|\x22XOR(SLEEP(10))OR\x22*/
```

## تفعيل الوحدة

الوحدة معطلة بشكل افتراضي. لتفعيلها:

1. تأكد من أن لديك خطة اشتراك **أمان API متقدمة** [فعالة](../../about-wallarm/subscription-plans.md#subscription-plans). الوحدة متاحة فقط ضمن هذه الخطة.

    إذا كنت في خطة مختلفة، يرجى الاتصال بفريق [المبيعات لدينا](mailto:sales@wallarm.com) للانتقال إلى الخطة المطلوبة.
1. انتقل إلى Wallarm Console → **الثغرات الأمنية** → **تكوين** باتباع الرابط لـ [السحابة الأمريكية](https://us1.my.wallarm.com/vulnerabilities/active?configure=true) أو [السحابة الأوروبية](https://my.wallarm.com/vulnerabilities/active?configure=true)، وقم بتفعيل مفتاح **التحقق من التهديدات النشطة**.

لديك مزيد من القدرة على [تعديل أو تخصيص سلوك الوحدة](enable-disable-active-threat-verification.md) لنقاط النهاية محددة.

## القيود

التحقق من التهديدات النشطة غير متاح لـ [الهجمات التي تتألف من ضربات مجمعة حسب عناوين IP الأصلية](../../admin-en/configuration-guides/protecting-with-thresholds.md).