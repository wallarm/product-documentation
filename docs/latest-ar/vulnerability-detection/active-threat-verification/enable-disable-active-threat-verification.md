# تفعيل التحقق من التهديد النشط عالميًا أو لنقاط نهاية محددة <a href="../../../about-wallarm/subscription-plans/#subscription-plans"><img src="../../../images/api-security-tag.svg" style="border: none;"></a>

يمكن تفعيل وحدة [التحقق من التهديد النشط](overview.md) التابعة لوولارم على مستوى العالم، بحيث تؤثر على جميع نقاط النهاية حيث يتم إعداد عقدة التصفية، أو على نحو فردي لنقاط نهاية محددة. توفر هذه المقالة تعليمات حول إدارة سلوك الوحدة.

## تفعيل الوحدة على مستوى العالم

التحقق من التهديد النشط غير مفعل بشكل افتراضي. لتفعيله على مستوى العالم:

1. تأكد من امتلاكك لخطة اشتراك **الأمان المتقدم لواجهة برمجة التطبيقات** [subscription plan](../../about-wallarm/subscription-plans.md#subscription-plans). الوحدة متوفرة فقط ضمن هذه الخطة.

    إذا كنت على خطة مختلفة، يرجى الاتصال بـ[فريق المبيعات](mailto:sales@wallarm.com) لدينا للانتقال إلى الخطة المطلوبة.
1. انتقل إلى لوحة تحكم Wallarm → **الثغرات الأمنية** → **تهيئة** باتباع الرابط لـ [السحابة الأمريكية](https://us1.my.wallarm.com/vulnerabilities/active?configure=true) أو [سحابة الاتحاد الأوروبي](https://my.wallarm.com/vulnerabilities/active?configure=true)، وقم بتبديل مفتاح **التحقق من التهديد النشط** إلى وضع التشغيل.

تؤدي هذه الخطوة إلى تفعيل الوحدة لجميع الموارد حيث تم تكوين عقدة التصفية.

![!إعدادات فحص الثغرات الأمنية](../../images/user-guides/vulnerabilities/vuln-scan-settings.png)

## التحكم في وضع الوحدة لنقاط نهاية محددة

بمجرد [تفعيل الوحدة](#enabling-the-module-globally) على مستوى العالم، يمكنك تخصيص سلوكها لنقاط نهاية محددة باستخدام القاعدة المناسبة. إليك كيفية القيام بذلك:

1. انتقل إلى لوحة تحكم Wallarm → **القواعد** → قم بإنشاء قاعدة **تعيين وضع التحقق من التهديد النشط**.
1. املأ نموذج إنشاء القاعدة وفقًا للتعليمات:

    * **إذا كان الطلب هو** [يُحدد](../../user-guides/rules/rules.md#branch-description) نقاط النهاية التي يتم تطبيق القاعدة عليها.
    * **تعطيل / تمكين** يضبط وضع الوحدة للهجمات المرسلة إلى نقاط النهاية المحددة.

    استخدم إعداد **تمكين** لإنشاء استثناءات لقاعدة تعطيل الوحدة (مثلاً، التمكين لـ `https://example.com/module/user/create` بينما يتم تعطيله لـ `https://example.com/module/user/*`).
1. انتظر حتى [اكتمال تجميع مجموعة القواعد المخصصة](../../user-guides/rules/rules.md#ruleset-lifecycle).

### تفعيل الوحدة لنقاط نهاية محددة

لتفعيل الوحدة لنقاط نهاية محددة فقط:

1. تفعيل الوحدة على مستوى العالم في لوحة تحكم Wallarm → **الثغرات الأمنية** → **تهيئة**.
1. تعطيل الوحدة لجميع نقاط النهاية بإنشاء قاعدة **تعيين وضع التحقق من التهديد النشط** وترك قسم **إذا كان الطلب هو** فارغًا.
1. إنشاء قواعد **تعيين وضع التحقق من التهديد النشط** لتفعيل الوحدة لمضيفين محددين أو تطبيقات أو نقاط نهاية عن طريق وصفهم في قسم **إذا كان الطلب هو**.

إليك كيف تبدو القاعدة عند تعطيل الوحدة لجميع نقاط النهاية:

![!مثال على القاعدة "تعيين وضع التحقق من التهديد النشط"](../../images/user-guides/rules/disable-atv-for-all-endpoints.png)

إذا كانت القاعدة المذكورة أعلاه نشطة بالفعل، فإن القاعدة التالية ستمكن الوحدة لـ `https://example.com/module/user/create`:

![!مثال على القاعدة "تعيين وضع التحقق من التهديد النشط"](../../images/user-guides/rules/disable-active-threat-verification-deeper-path-example.png)

بدلاً من ذلك، يمكنك تعطيل الوحدة عن طريق تطبيق قاعدة للرابط URL ثم تمكينها لنقاط النهاية المحددة المتعلقة بهذا الرابط.

### تعطيل الوحدة لنقاط نهاية محددة

بالنسبة لنقاط النهاية التي لا تملك بيئة مسرحية، خاصة تلك غير متسقة أو التي تفتقر إلى آلية التوثيق، يُنصح بتعطيل إعادة تشغيل الهجوم. دون هذه الضمانات، قد تكرر الوحدة الإجراءات الضارة عن طريق الخطأ، مثل معالجة المعاملات المالية عدة مرات أو إنشاء حسابات جديدة بشكل متكرر.

لتعطيل الوحدة لنقاط نهاية محددة:

1. تفعيل الوحدة على مستوى العالم في لوحة تحكم Wallarm → **الثغرات الأمنية** → **تهيئة**.
1. تعطيل الوحدة لنقاط النهاية المطلوبة باستخدام قاعدة **تعيين وضع التحقق من التهديد النشط**. وصف هذه النقاط في قسم **إذا كان الطلب هو**.

خذ في الاعتبار نقطة نهاية غير متسقة مثل POST `https://example.com/api/purchase` على منصة تسوق عبر الإنترنت تتعامل مع الإجراءات مثل الخصم من المخزون وتحصيل حسابات المستخدمين. إذا تم تكرار هذا الفعل عن طريق الخطأ بواسطة الوحدة، يمكن أن يؤدي إلى عواقب مثل تحصيل رسوم متعددة لعنصر واحد. لذلك، بالنسبة لنقاط النهاية هذه في بيئة الإنتاج، يُنصح بتعطيل إعادة تشغيل الهجوم. لهذه النقطة، ستبدو القاعدة كالتالي:

![!مثال على القاعدة "تعيين وضع التحقق من التهديد النشط"](../../images/user-guides/rules/disable-atv-for-non-indemponent-end.png)