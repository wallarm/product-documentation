[waf-mode-instr]:   ../admin-en/configure-wallarm-mode.md

# إعداد تطبيق سياسة واجهة برمجة التطبيقات

تصف هذه المقالة كيفية تمكين وتهيئة حماية واجهة برمجة التطبيقات بناءً على [مواصفات واجهة برمجة التطبيقات التي قمت بتحميلها](overview.md).

## الخطوة 1: تحميل المواصفات

1. في قسم **مواصفات واجهة برمجة التطبيقات** في [السحابة الأمريكية](https://us1.my.wallarm.com/api-specifications/) أو [السحابة الأوروبية](https://my.wallarm.com/api-specifications/)، انقر على **تحميل المواصفات**.
1. قم بتعيين معايير تحميل المواصفات وابدء بالتحميل.

    ![تحميل المواصفات](../images/api-specification-enforcement/specificaton-upload.png)

لاحظ أنه لن يكون بإمكانك البدء بتهيئة تطبيق سياسة واجهة برمجة التطبيقات استنادًا إلى المواصفات، حتى يتم تحميل ملفها بنجاح.

## الخطوة 2: تعيين الإجراءات لانتهاكات السياسات

1. انقر على علامة التبويب **تطبيق سياسة واجهة برمجة التطبيقات**.

    !!! info "كشف واجهة برمجة التطبيقات الغير مصرح بها"
        * بالإضافة إلى تطبيق السياسة، يمكن استخدام المواصفات من قبل وحدة [اكتشاف واجهة برمجة التطبيقات](../api-discovery/overview.md) لـ [كشف واجهة برمجة التطبيقات الغير مصرح بها](../api-discovery/rogue-api.md). يتم عرض العلامة التبويب إذا تم تمكين اكتشاف واجهة برمجة التطبيقات.
        * قبل استخدام المواصفات لتطبيق السياسة، يُنصح باستخدامها للبحث عن واجهات برمجة التطبيقات الغير مصرح بها (الظل، زومبي واليتيمة) باستخدام اكتشاف واجهة برمجة التطبيقات. بهذه الطريقة، يمكنك فهم مقدار اختلاف مواصفاتك عن الطلبات الفعلية لعملائك - هذه الاختلافات ستؤدي على الأرجح إلى حظر الطلبات ذات الصلة بعد تطبيق السياسة.

1. حدد **استخدم المواصفات لتطبيق سياسة واجهة برمجة التطبيقات**.
1. حدد الاستضافة أو نقطة النهاية التي ترغب في تنشيط إجراءات انتهاك السياسة لها.

    * لاحظ أنه إذا حددت بشكل غير صحيح النقاط التي يجب تطبيق المواصفات عليها، سيكون هناك العديد من الأحداث [الإيجابية الكاذبة](../about-wallarm/protecting-against-attacks.md#false-positives).
    * إذا كان لديك مواصفات عديدة تنطبق على نفس الاستضافة، ولكن لنقاط نهاية مختلفة (على سبيل المثال `domain.com/v1/api/users/` و `domain.com/v1/api/orders/`)، يجب عليك **تحديد** النقاط التي يجب تطبيق المواصفات عليها.
    * إذا أضفت مواصفات إلى استضافة، ثم أضفت مواصفة أخرى إلى نقاط نهاية فردية لهذه الاستضافة، سيتم تطبيق كلتا المواصفتين على هذه النقاط.
    * يمكن تهيئة القيمة عبر [مُنشئ URI](../user-guides/rules/rules.md#uri-constructor) أو [نموذج التحرير المتقدم](../user-guides/rules/rules.md#advanced-edit-form).

1. حدد كيف يجب أن يتفاعل النظام إذا كانت الطلبات تخالف مواصفاتك.

    ![المواصفات - استخدامها لتطبيق سياسة واجهة برمجة التطبيقات](../images/api-specification-enforcement/specification-use-for-api-policies-enforcement.png)

    التفاصيل حول الانتهاكات المحتملة:

    --8<-- "../include/api-policies-enforcement/api-policies-violations.md"

    عند استخدام المواصفات لأول مرة لتطبيق سياسة واجهة برمجة التطبيقات، يُنصح بتعيين `Monitor` كرد فعل للتأكد من أن المواصفات تُطبق على النقاط الضرورية وتكتشف الأخطاء الحقيقية.

**التعطيل**

في بعض الحالات، قد يكون من الضروري تعطيل وظيفة تطبيق سياسة واجهة برمجة التطبيقات لبعض أجزاء واجهة برمجة التطبيقات الخاصة بك. يمكن القيام بذلك:

* بالنسبة لتثبيتات حزم NGINX بما في ذلك تلك عبر [المثبت الشامل](../installation/nginx/all-in-one.md)، لأي قسم `server` حيث يُستخدم تطبيق سياسة واجهة برمجة التطبيقات من خلال توجيه NGINX [`wallarm_enable_apifw`](../admin-en/configure-parameters-en.md#wallarm_enable_apifw) المُعدّ لـ `off`.
* بالنسبة لصورة Docker القائمة على NGINX، من خلال متغير البيئة `WALLARM_APIFW_ENABLE` [متغير البيئة](../admin-en/installation-docker-en.md#run-the-container-passing-the-environment-variables) المُعدّ إلى `false`.
* بالنسبة لوحدة تحكم الوصول NGINX، من خلال مجموعة القيم [`controller.wallarm.apifirewall`](../admin-en/configure-kubernetes-en.md#controllerwallarmapifirewall) مع تعيين `enable` إلى `false`.