[رابط-نقاط]:          points/intro.md
[رابط-ريجيكس-روبي]:     http://ruby-doc.org/core-2.6.1/doc/regexp_rdoc.html
[رابط-منطق-متقدم]:       logic.md

[صورة-تعديل]:           ../../images/fast/dsl/common/phases/modify.png

# مرحلة التعديل

!!! info "نطاق المرحلة"
    تُستخدم هذه المرحلة في امتداد تعديلي وهي اختيارية لعمله (قسم `modify` قد يكون غائبًا أو موجودًا في ملف YAML).

    يجب أن تغيب هذه المرحلة عن ملف YAML الخاص بامتداد غير التعديلي.
    
    اقرأ عن أنواع الامتداد بالتفصيل [هنا][رابط-منطق-متقدم].

!!! info "بنية وصف عناصر الطلب"
    عند إنشاء امتداد FAST، تحتاج إلى فهم بنية الطلب HTTP المرسل إلى التطبيق وبنية الاستجابة HTTP المستلمة من التطبيق بهدف وصف عناصر الطلب التي تحتاج إلى العمل معها باستخدام النقاط بشكل صحيح. 

    لرؤية معلومات مفصلة، انتقل إلى هذا [الرابط][رابط-نقاط].
 
تعدل هذه المرحلة قيم معاملات الطلب الأساسي، إذا كان ذلك ضروريًا. لاحظ أنه لا يمكنك إضافة عنصر جديد غير موجود في الطلب الأساسي باستخدام مرحلة التعديل. على سبيل المثال، لا يمكنك إضافة رأس HTTP `Cookie` إذا لم يحتوي الطلب الأساسي عليه.

يحتوي قسم `modify` في ملف YAML الامتداد على مصفوفة من أزواج `<مفتاح: قيمة>`. يصف كل زوج عنصر طلب معين (المفتاح) والبيانات التي يجب إدخالها في هذا العنصر (القيمة). يمكن أن يحتوي المفتاح على تعبيرات منتظمة بتنسيق [تعبيرات روبي المنتظمة][رابط-ريجيكس-روبي]. لا يمكنك تطبيق التعبيرات المنتظمة على قيمة المفتاح.

في مرحلة التعديل، يمكنك تعيين قيم جديدة للعنصر أو مسح بيانات العنصر.

* إذا تم تعيين قيمة المفتاح، فسيتم تعيين هذه القيمة لعنصر الطلب الأساسي المقابل. إذا لم يكن هناك عنصر يقابل المفتاح في الطلب الأساسي، فلن يتم إجراء إدراج عنصر جديد.
    
    ??? info "مثال 1"
        `'HEADER_COOKIE_value': 'C=qwerty123'`

* إذا لم يتم تعيين قيمة المفتاح، فسيتم مسح قيمة عنصر الطلب الأساسي المقابل.
    
    ??? info "مثال"
        `'HEADER_COOKIE_value': ""`

??? info "مثال"
    في المثال أدناه، سيتم تعديل الطلب الأساسي بالطريقة التالية:

    1.  سيتم استبدال قيمة رأس `Content-Type` بـ `application/xml`.
    2.  سيتم مسح قيمة معلمة الـ GET `uid` (لن يتم إزالة المعلمة نفسها).

    ```
    modify:
    - "HEADER_CONTENT-TYPE_value": "application/xml"
    - "GET_uid_value": ""
    ```