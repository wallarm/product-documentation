[link-points]:          points/intro.md
[link-ruby-regexp]:     http://ruby-doc.org/core-2.6.1/doc/regexp_rdoc.html
[link-ext-logic]:       logic.md

[img-modify]:           ../../images/fast/dsl/common/phases/modify.png

# مرحلة التعديل

!!! info "نطاق المرحلة"
    هذه المرحلة تُستخدم في امتداد التعديل وهي اختيارية لتشغيله (قسم `modify` قد يكون غائبًا أو موجودًا في ملف YAML).

    يجب ألا تكون هذه المرحلة موجودة في ملف YAML الخاص بالامتداد غير المعدل.
    
    اقرأ عن أنواع الامتداد بالتفصيل [هنا][link-ext-logic].

!!! info "بناء جملة وصف عناصر الطلب"
    عند إنشاء امتداد FAST، تحتاج إلى فهم تركيبة الطلب HTTP المُرسَل إلى التطبيق وتركيبة الاستجابة HTTP المُستلَمة من التطبيق لكي تصف بشكل صحيح عناصر الطلب التي تحتاج للعمل معها باستخدام النقاط. 

    للاطلاع على معلومات مفصلة، تابع إلى هذا [الرابط][link-points].
 
تعدل هذه المرحلة قيم معاملات الطلب الأساسية، إذا لزم الأمر. لاحظ أنك لا تستطيع إضافة عنصر جديد غائب من الطلب الأساسي باستخدام مرحلة التعديل. على سبيل المثال، لا يمكنك إضافة رأس HTTP `Cookie` إذا كان الطلب الأساسي لا يحتوي عليه.

يحتوي قسم `modify` في ملف YAML الخاص بالامتداد على مجموعة من أزواج `<key: value>`. يصف كل زوج عنصر طلب معين (المفتاح) والبيانات التي يجب إدخالها في هذا العنصر (القيمة). يمكن أن يحتوي المفتاح على تعبيرات منتظمة بـ [تنسيق تعبيرات منتظمة في Ruby][link-ruby-regexp]. لا يمكن تطبيق التعبيرات المنتظمة على قيمة المفتاح.

في مرحلة التعديل، يمكنك تخصيص قيم جديدة للعنصر أو حذف بيانات العنصر.

* إذا تم تعيين قيمة المفتاح، فإن هذه القيمة ستُعين لعنصر الطلب الأساسي المقابل. إذا لم يكن هناك عنصر مقابل للمفتاح في الطلب الأساسي، فلن يتم إجراء إدراج عنصر جديد.
    
    ??? info "مثال 1"
        `'HEADER_COOKIE_value': 'C=qwerty123'`

        ![مرحلة التعديل](../../images/fast/dsl/common/phases/modify.png)

* إذا لم يتم تعيين قيمة المفتاح، فسيتم مسح قيمة عنصر الطلب الأساسي المقابل.
    
    ??? info "مثال"
        `'HEADER_COOKIE_value': ""`

??? info "مثال"
    في المثال أدناه، سيتم تعديل الطلب الأساسي بالطريقة التالية:

    1. ستُستبدل قيمة رأس `Content-Type` بـ `application/xml`.
    2. ستُمسح قيمة مُعامل `uid` في طلب GET (لن يتم إزالة المُعامل نفسه).

    ```
    modify:
    - "HEADER_CONTENT-TYPE_value": "application/xml"
    - "GET_uid_value": ""
    ```