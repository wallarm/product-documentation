[link-points]:          points/intro.md
[link-ruby-regexp]:     http://ruby-doc.org/core-2.6.1/doc/regexp_rdoc.html
[link-logic]:           logic.md
[link-markers]:         detect/markers.md
[link-ext-logic]:       logic.md

[img-generate-methods]:     ../../images/fast/dsl/en/phases/generate-methods.png
[img-generate-payload]:     ../../images/fast/dsl/en/phases/generate-payload.png

#  مرحلة إنتاج البيانات

!!! info "نطاق المرحلة"
    هذه المرحلة تُستخدم في توسعة تعديلية وهي اختيارية لعملها (قسم `generate` قد يكون غائبًا أو موجودًا في ملف YAML).

    ينبغي ألا تكون هذه المرحلة موجودة في ملف YAML الخاص بتوسعة غير تعديلية.
    
    اقرأ عن أنواع التوسع في التفصيل [هنا][link-ext-logic].

!!! info "بنية وصف عنصر الطلب"
     عند إنشاء توسعة FAST، تحتاج إلى فهم بنية طلب HTTP المرسل إلى التطبيق وبنية استجابة HTTP التي يتم استقبالها من التطبيق لكي تصف بشكل صحيح عناصر الطلب التي تحتاج إلى العمل عليها باستخدام النقاط. 
     
     لرؤية معلومات مفصلة، انتقل إلى هذا [الرابط][link-points].
 
 تُحدد هذه المرحلة مجموعة بيانات لإدراجها في معلمات محددة من طلب أساسي لإنشاء طلبات اختبار مبنية على هذا الطلب.

لقسم `generate` البنية التالية:

```
generate:
  - into:
    - parameter 1
    - parameter 2
    - …
    - parameter N
  - method:
    - postfix
    - prefix
    - random
    - replace
  - payload:
    - payload 1
    - payload 2
    - …
    - payload N
```

* معلمة `into` تسمح بتحديد عنصر أو عدة عناصر طلب ينبغي إدراج مجموعة البيانات فيها. يمكن أن يكون قيمة هذه المعلمة سلسلة أو مصفوفة من السلاسل. يمكنك استخدام [تعبير عادي بصيغة روبي][link-ruby-regexp] كقيمة لمعلمة `into`.
    
    هذه المعلمة اختيارية وقد تكون غائبة في القسم. إذا تم حذف معلمة `into`, يتم إدراج مجموعة البيانات في عنصر الطلب الذي يُسمح بتعديله وفقًا لسياسة الاختبار المعطاة.
    
    لنفترض أن العناصر التالية التي يمكن تعديلها تم استخراجها من الطلب الأساسي وفقًا لسياسة الاختبار:
    
    * `GET_uid_value`
    * `HEADER_COOKIE_value`
    
    ستعالج التوسعة جميع عناصر الإدراج المتغيرة بالتتابع (تُعرف أيضا كنقاط إدراج). 
    
    إذا كانت معلمة `into` محذوفة، فسيتم إدراج مجموعة البيانات بالتتابع في معلمة `GET_uid_value` وسيتم استخدام طلبات الاختبار المنتجة لفحص التطبيق المستهدف للتحقق من وجود ثغرات. ثم، بعد معالجة نتائج طلب الاختبار، تعالج التوسعة معلمة `HEADER_COOKIE_value` وتدخل المجموعات إلى هذه المعلمة بطريقة مماثلة.
    
    إذا احتوت معلمة `into` على معلمة طلب `GET_uid_value` كما هو موضح في المثال التالي، فسيتم إدراج المجموعة في معلمة `GET_uid_value` وليس معلمة `HEADER_COOKIE_value`.
    
    ```
    into: 
      - 'GET_uid_value'
    ```
    نظرًا لأن المثال التالي يحتوي على معلمة واحدة فقط، يمكن كتابة قيمة المعلمة `into` في سطر واحد:
    
    `into: 'GET_uid_value'`

* `method` — هذه المعلمة الاختيارية تُحدد قائمة الطرق التي سيتم استخدامها لإدراج مجموعة البيانات في عنصر طلب أساسي. 
    * `prefix` — إدراج مجموعة البيانات قبل قيمة عنصر الطلب الأساسي.
    * `postfix` — إدراج مجموعة البيانات بعد قيمة عنصر الطلب الأساسي.
    * `random` — إدراج مجموعة البيانات في مكان عشوائي في قيمة عنصر الطلب الأساسي.
    * `replace` — استبدال قيمة عنصر الطلب الأساسي بمجموعة البيانات.
    
    ![طرق إدخال البيانات][img-generate-methods]
    
    إذا كانت معلمة `method` محذوفة، سيتم استخدام طريقة `replace` بشكل افتراضي.
    
    عدد طلبات الاختبار المنشأة يعتمد على عدد الطرق المحددة: طلب اختبار واحد لكل طريقة إدراج.
    
    على سبيل المثال، إذا تم تحديد طرق الإدراج التالية:
    
    ```
    method:
      - prefix
      - replace
    ```
    
    فبالنسبة لمجموعة البيانات الواحدة، يتم إنشاء طلبين للاختبار؛ لمجموعتين بيانات، يُنشأ أربعة طلبات للاختبار (طلبين لكل مجموعة بيانات)، وهكذا.

* معلمة `payload` تُحدد قائمة مجموعات البيانات التي سيتم إدراجها في معلمة الطلب لإنشاء طلب اختبار سيتم بعد ذلك اختبار التطبيق المستهدف للتحقق من وجود ثغرات.
    
    هذه المعلمة إلزامية، ويجب أن تكون دائما موجودة في القسم. ينبغي أن تحتوي القائمة على مجموعة بيانات واحدة على الأقل. إذا كانت هناك مجموعات بيانات متعددة، يقوم العقد FAST بإدراج مجموعات البيانات بالتتابع في معلمة الطلب ويختبر التطبيق المستهدف للتحقق من وجود ثغرات باستخدام كل من طلبات الاختبار المنشأة.
    
    ![إنتاج البيانات][img-generate-payload]
    
    مجموعة البيانات هي سلسلة يتم إدراجها في إحدى المعلمات أثناء معالجة الطلب.
    
    ??? info "مثال على مجموعات بيانات متعددة"
        ```
        payload:
          - "') or 1=('1"
          - "/%5c../%5c../%5c../%5c../%5c../%5c../%5c../etc/passwd/"
        ```
    
    يمكنك استخدام علامات خاصة كجزء من مجموعة البيانات لتوسيع إمكانيات اكتشاف الثغرات:

    * **`STR_MARKER`** — إدخال سلسلة عشوائية في مجموعة البيانات بالضبط في الموضع الذي يُحدد فيه `STR_MARKER`. 
        
        على سبيل المثال، يمكن استخدام `STR_MARKER` لفحص التطبيق للتحقق من ثغرة XXS.
        
        ??? info "مثال"
            `'userSTR_MARKER'`
    
    * **`CALC_MARKER`** — إدخال سلسلة تحتوي على تعبير حسابي عشوائي (مثال، `1234*100`) في مجموعة البيانات بالضبط في الموضع الذي يُحدد فيه `CALC_MARKER`.
        
        على سبيل المثال، يمكن استخدام `CALC_MARKER` لفحص التطبيق للتحقق من ثغرة RCE.
        
        ??? info "مثال"
            `'; bc <<< CALC_MARKER'`
    
    * **`DNS_MARKER`** — إدخال سلسلة تحتوي على نطاق عشوائي (مثال، `r4nd0m.wlrm.tl`) في مجموعة البيانات بالضبط في الموضع الذي يُحدد فيه `DNS_MARKER`.
        
        على سبيل المثال، يمكن استخدام `DNS_MARKER` لفحص التطبيق للتحقق من ثغرات DNS خارج النطاق.

        ??? info "مثال"
            `'; ping DNS_MARKER'`
    
    !!! info "منطق عمل العلامات"
        إذا اكتشفت المرحلة Detect علامة من أي مجموعة بيانات في استجابة الخادم، فإن الهجوم ناجح، مما يعني أن الثغرة قد تم استغلالها بنجاح. لرؤية معلومات مفصلة حول عمل مرحلة Detect مع العلامات، انتقل إلى هذا [الرابط][link-markers].