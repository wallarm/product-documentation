# مرحلة الكشف

!!! info "نطاق المرحلة"
    هذه المرحلة إلزامية لأي نوع امتداد FAST ليعمل (يجب أن يحتوي ملف YAML على قسم `detect`).

    اقرأ عن أنواع الامتدادات بالتفصيل [هنا][link-ext-logic].

!!! info "صيغة وصف عناصر الطلب"
    عند إنشاء امتداد FAST، تحتاج إلى فهم هيكل الطلب HTTP المرسل إلى التطبيق وهيكل الاستجابة HTTP المستلمة من التطبيق لكي تصف بشكل صحيح عناصر الطلب التي تحتاج إلى العمل معها باستخدام النقاط.

    لرؤية معلومات مفصلة، تابع إلى هذا [الرابط][link-points].

تحدد هذه المرحلة المعايير للبحث عنها في استجابة الخادم للوصول إلى استنتاج حول ما إذا كانت الثغرة الأمنية قد استغلت بنجاح من قبل طلب الاختبار.

يحتوي قسم `detect` على الهيكل التالي:

```
detect:
  - oob:
    - dns
  - response:
    - status:
      - القيمة 1
      - …
      - القيمة S
    - headers:
      - الرأس 1: 
        - القيمة 1
        - …
        - القيمة T
      - الرأس …
      - الرأس N:
        - القيمة 1
        - …
        - القيمة U
    - body:
      - html:
        - tag:
          - القيمة 1
          - …
          - القيمة V
        - attr:
          - القيمة 1
          - …
          - القيمة W
        - attribute:
          - القيمة 1
          - …
          - القيمة X
        - js:
          - القيمة 1
          - …
          - القيمة Y
        - href:
          - القيمة 1
          - …
          - القيمة Z
```

يحتوي هذا القسم على مجموعة من المعايير. يصف كل معيار عنصرًا واحدًا من الاستجابة. يمكن أن تحتوي بعض المعايير على مجموعة من المعايير الأخرى كقيمة، مما يخلق تسلسلًا هرميًا.

قد يكون للمعيار الخصائص التالية:
* أن يكون اختياريًا (يمكن أن يكون المعيار موجودًا أو غير موجود في الطلب). جميع المعايير في قسم `detect` تحقق هذه الخاصية.

    !!! warning "ملاحظة حول المعايير المطلوبة في قسم `detect`"
        على الرغم من أن كلًا من معايير `oob` و `response` اختيارية، يجب تواجد واحد منهما في قسم `detect`. وإلا، لن تتمكن مرحلة الكشف من العمل. قد يحتوي قسم `detect` أيضًا على كلا هذين المعيارين.

* ألا يكون له قيمة محددة.

    ??? info "مثال"
        ```
        - response
        ```    

* أن يكون له قيمة واحدة محددة كنص أو رقم.
    
    ??? info "مثال"
        ```
        - status: 500
        ```
    
* أن يكون له قيم متعددة محددة على شكل مجموعة من النصوص أو الأرقام.

    ??? info "مثال"
        ```
            - status: 
                - 404
                - 500
        ```

* أن يحتوي على معايير أخرى كقيمة (يتم تحديد المعايير على شكل مجموعة).

    ??? info "مثال"
        ```
            - headers: 
                - "Cookie": "مثال"
                - "User-Agent":
                    - "Mozilla"
                    - "Chrome"
        ```

القيم المقبولة لمعايير قسم الكشف موصوفة في الأقسام التالية:
* [oob][anchor1],
* [response][anchor2],
    * [status][anchor3],
    * [headers][anchor4],
    * [body][anchor5],
        * [html][anchor6],
            * attr,
            * attribute,
            * href,
            * js,
            * tag.