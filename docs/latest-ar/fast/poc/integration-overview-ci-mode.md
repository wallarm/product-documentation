[img-sample-job-ci-mode]:       ../../images/fast/poc/en/integration-overview/sample-job-ci-mode.png

[doc-recording-mode]:           ci-mode-recording.md#running-a-fast-node-in-recording-mode
[doc-testing-mode]:             ci-mode-testing.md#running-a-fast-node-in-testing-mode
[doc-proxy-configuration]:      proxy-configuration.md
[doc-fast-container-stopping]:  ci-mode-recording.md#stopping-and-removing-the-docker-container-with-the-fast-node-in-recording-mode
[doc-recording-variables]:      ci-mode-recording.md#environment-variables-in-recording-mode
[doc-integration-overview]:     integration-overview.md


#   التكامل عبر عقدة FAST: المبادئ والخطوات

لإجراء اختبار الأمان في وضع CI، يجب تشغيل عقدة FAST بشكل متسلسل في وضعين:
1.  [وضع التسجيل][doc-recording-mode]
2.  [وضع الاختبار][doc-testing-mode]

متغير البيئة `CI_MODE` يحدد وضع عمل عقدة FAST. يمكن أن تأخذ هذا المتغير القيم التالية:
* `recording`
* `testing`

في هذا السيناريو، تقوم عقدة FAST أولاً بإنشاء تسجيل اختبار وكتابة الطلبات الأساسية فيه. عند الانتهاء من التسجيل، تقوم العقدة بإنشاء تشغيل اختبار يستخدم الطلبات الأساسية المسبقة التسجيل كأساس لاختبارات الأمان الخاصة بها.

يظهر هذا السيناريو في الصورة أدناه:

![مثال على وظيفة CI/CD مع عقدة FAST في وضع CI][img-sample-job-ci-mode]

خطوات العمل المقابلة هي:

1.  بناء ونشر التطبيق الهدف.

2.  [تشغيل عقدة FAST في وضع التسجيل][doc-recording-mode].

    في وضع التسجيل، تقوم عقدة FAST بالإجراءات التالية:
    
    * تقوم بتوجيه الطلبات الأساسية من مصدر الطلبات إلى التطبيق الهدف.
    * تقوم بتسجيل هذه الطلبات الأساسية في التسجيل الاختباري لإنشاء مجموعة اختبار الأمان على أساسها لاحقًا.
    
    !!! info "ملاحظة حول تشغيلات الاختبار"
        لا يتم إنشاء تشغيل اختبار في وضع التسجيل.

3.  إعداد وضبط أداة الاختبار:
    
    1.  نشر وإجراء تكوين أساسي لأداة الاختبار.
    
    2.  [ضبط عقدة FAST كخادم وكيل][doc-proxy-configuration].
        
4.  تشغيل الاختبارات القائمة.
    
    ستقوم عقدة FAST بتوجيه وتسجيل الطلبات الأساسية إلى التطبيق الهدف.
    
5.  إيقاف وإزالة حاوية عقدة FAST.

    إذا لم تواجه عقدة FAST أخطاء حرجة أثناء التشغيل، فإنها تستمر في العمل حتى إما توقيت [`INACTIVITY_TIMEOUT`][doc-recording-variables] ينفذ أو أداة CI/CD توقف الحاوية بشكل صريح.
    
    بعد الانتهاء من الاختبارات القائمة، يجب [إيقاف عقدة FAST][doc-fast-container-stopping]. سيتوقف هذا عن عملية تسجيل الطلبات الأساسية. ثم يمكن التخلص من الحاوية.
    
6.  [تشغيل عقدة FAST في وضع الاختبار][doc-testing-mode].

    في وضع الاختبار، تقوم عقدة FAST بالإجراءات التالية:
    
    * تقوم بإنشاء تشغيل اختبار على أساس الطلبات الأساسية المسجلة في الخطوة 4.
    * تبدأ بإنشاء وتنفيذ مجموعة اختبارات الأمان.
    
7.  الحصول على نتائج الاختبار. إيقاف حاوية عقدة FAST.    
    
    إذا لم تواجه عقدة FAST أخطاء حرجة أثناء التشغيل، فإنها تستمر في العمل حتى اكتمال اختبارات الأمان. تغلق العقدة تلقائيًا. ثم يمكن التخلص من الحاوية.

##  دورة حياة حاوية عقدة FAST (التنفيذ عبر وضع CI)

يفترض هذا السيناريو أن حاوية دوكر مع عقدة FAST تعمل أولاً في وضع التسجيل، ثم في وضع الاختبار.

بعد انتهاء تنفيذ عقدة FAST في أي من الوضعين، يتم إزالة حاوية العقدة. بمعنى آخر، يتم إعادة إنشاء حاوية عقدة FAST في كل مرة يتغير فيها وضع التشغيل.