[img-search-for-anomalies]:         ../../../images/fast/operations/en/test-policy/fuzzer/search-for-anomalies-scheme.png
[img-anomaly-description]:          ../../../images/fast/operations/common/test-policy/fuzzer/anomaly-description.png

[doc-fuzzer-configuration]:         fuzzer-configuration.md

[link-payloads-section]:            fuzzer-configuration.md#the-payloads-section
[link-stop-fuzzing-section]:        fuzzer-configuration.md#the-stop-fuzzing-if-response-section


# مبادئ تشغيل الفازر

الفازر بيفحص 255 *بايت شاذ*: من `0x01` إلى `0xFF`. إدخال بايت واحد أو أكتر من البايتات الشاذة دي في نقاط الطلب ممكن يؤدي إلى تصرف غير طبيعي في التطبيق المستهدف.

بدل من فحص كل بايت بشكل منفصل، الفازر بيضيف واحد أو أكثر من سلاسل البايتات الشاذة (*الحمولات*) بطول ثابت للنقطة وبيبعت الطلب ده للتطبيق.

لتعديل النقاط المسموح بها، الفازر:

* بيدخل الحمولات على:

    * بداية القيمة
    * مكان عشوائي في القيمة
    * نهاية القيمة
* بيبدل قيمة الحمولة اللي جاية بعدها:

    * شرائح عشوائية
    * أول `M` بايت
    * آخر `M` بايت
    * السلسلة كلها

مع [تكوين الفازر][doc-fuzzer-configuration]، الحجم `M` للحمولة اللي موجودة في الطلب من FAST للتطبيق محدد بالبايتات. ده بيأثر على النقاط الآتية:

* عدد البايتات اللي هيتضافوا لقيمة النقطة لو استخدمنا إدخال حمولة
* عدد البايتات اللي هيتبدلوا في قيمة النقطة لو استخدمنا بدل حمولة
* عدد الطلبات اللي هيتبعتوا للتطبيق

لو اكتشف تصرف غير طبيعي في الرد على الطلب اللي فيه الحمولة، الفازر هيبعت طلبات محددة لكل بايت حمولة للتطبيق. كده، الفازر هيكتشف البايتات المحددة اللي سببت التصرف الغير طبيعي.

![مخطط فحص البايتات الشاذة][img-search-for-anomalies]

كل البايتات المكتشفة متوفرة في وصف الشذوذ:

![وصف الشذوذ][img-anomaly-description]

??? info "مثال على تشغيل الفازر"
    لنفترض أن حجم الحمولة 250 بايت [بديل](fuzzer-configuration.md#payloads-section) الـ 250 بايت الأولى من قيمة نقطة ما.

    في هذه الظروف، الفازر بينشئ طلبين ليبعت كل البايتات الشاذة المعروفة: واحد بحمولة 250 بايت والتاني بحمولة 5 بايت.

    قيمة النقطة الأساسية في الطلب الأصلي هتتعدل كالتالي:

    * لو القيمة أطول من 250 بايت: في البداية الـ 250 بايت الأولانية من القيمة هيتبدلوا بـ 250 بايت من الحمولة, بعدين الـ 250 بايت الأولانية هيتبدلوا بـ 5 بايت من الحمولة.
    * لو القيمة أقصر من 250 بايت: في البداية القيمة بالكامل هتتبدل بـ 250 بايت من الحمولة, بعدين القيمة بالكامل هتتبدل بـ 5 بايت من الحمولة.

    لنفترض أن حمولة الـ 5 بايت `ABCDE` بدلت الـ 250 بايت الأولى من قيمة النقطة اللي طولها 250 بايت `_250-bytes-long-head_qwerty` وسببت شذوذ. يعني، طلب التجربة اللي قيمة النقطة فيه `ABCDEqwerty` سبب شذوذ.

    في الحالة دي، الفازر هينشئ 5 طلبات إضافية ليتحقق من كل بايت بالقيم التالية للنقطة:

    * `Aqwerty`
    * `Bqwerty`
    * `Cqwerty`
    * `Dqwerty`
    * `Eqwerty`

    طلب أو أكتر من الطلبات دي هيتسبب في شذوذ تاني والفازر هيكوّن قائمة بالبايتات الشاذة المكتشفة، مثلاً: `A`, `C`.

 بعد كده، ممكن تاخد معلومات عن [تكوين الفازر][doc-fuzzer-configuration] ووصف القواعد اللي بتحدد إن كان الشذوذ اتكتشف.

الفازر FAST بيتعامل مع نقطة مسموح بها في كل تكرار (*الفازرنج*). حسب [قواعد إيقاف الفازرنج][link-stop-fuzzing-section]، هيتم تعامل واحدة أو أكتر من النقاط باستمرار.