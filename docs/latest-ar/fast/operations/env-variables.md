[doc-dsl-ext]:              ../dsl/intro.md
[doc-record-mode]:          ../poc/ci-mode-recording.md
[doc-test-mode]:            ../poc/ci-mode-testing.md

[anchor-allowed-hosts]:     #limiting-the-number-of-requests-to-be-recorded

# قائمة المتغيرات البيئية المستخدمة بواسطة عقدة FAST

يُستخدم الكثير من الباراميترات لضبط عقدة FAST. يُمكن تغيير قيم هذه الباراميترات من خلال المتغيرات البيئية المقابلة.

يُمكنك تحديد قيم المتغيرات البيئية، وتمرير تلك المتغيرات إلى عقدة FAST إما
* من خلال الوسيط `-e`

    ```
    docker run --name <اسم الحاوية> \
    -e <متغير بيئي 1>=<قيمة> \
    ... 
    -e <متغير بيئي N>=<قيمة> \
    -p <المنفذ المستهدف>:8080 wallarm/fast
    ```
    
* أو من خلال الوسيط `--env-file` الذي يُحدد مسار ملف يحتوي المتغيرات البيئية

    ```
    docker run --name <اسم الحاوية> \
    --env-file=<ملف بالمتغيرات البيئية> \
    -p <المنفذ المستهدف>:8080 wallarm/fast
    ```
    
    يجب أن يحتوي هذا الملف على قائمة بالمتغيرات البيئية، متغير واحد لكل سطر:

    ```
    # ملف العينة بالمتغيرات البيئية

    WALLARM_API_TOKEN=token_Qwe12345            # هذه قيمة العينة—استخدم قيمة رمز حقيقية بدلاً من ذلك
    ALLOWED_HOSTS=google-gruyere.appspot.com    # الطلبات الواردة التي تستهدف هذا النطاق، سيتم تسجيلها في سجل الاختبار
    ```

جميع الباراميترات القابلة للضبط مدرجة في الجدول أدناه:

| الباراميتر               | القيمة     | مطلوب؟ |
|-----------------------	| --------	| --------	|
| `WALLARM_API_TOKEN`   	| رمز من سحابة Wallarm. | نعم |
| `WALLARM_API_HOST`    	| عنوان خادم API Wallarm. <br>القيم المسموح بها: <br>`us1.api.wallarm.com` للخادم في سحابة Wallarm الأمريكية و<br>`api.wallarm.com` للخادم في سحابة Wallarm الأوروبية. | نعم |
| `ALLOWED_HOSTS`        | قائمة بمضيفي التطبيق المستهدف. الطلبات الواردة الموجهة إلى هؤلاء المضيفين سيتم تسجيلها في سجل الاختبار.<br>جميع الطلبات الواردة يتم تسجيلها بشكل افتراضي.<br>اطلع على المزيد من التفاصيل [هنا][anchor-allowed-hosts].| لا |
| `WALLARM_API_USE_SSL`  | يُحدد ما إذا كان يجب استخدام SSL عند الاتصال بأحد خوادم API Wallarm.<br>القيم المسموح بها: `true` و `false`.<br>القيمة الافتراضية: `true`. | لا |
| `WORKERS`              | عدد الخيوط التي تعالج الطلبات الأولية وتقوم بالاختبارات الأمنية.<br>القيمة الافتراضية: `10`. | لا |
| `GIT_EXTENSIONS`       | الرابط إلى مستودع Git يحتوي [ملحقات DSL السريعة المخصصة][doc-dsl-ext] (يجب أن يكون هذا المستودع في متناول حاوية عقدة FAST) | لا |
| `CI_MODE`              | وضع تشغيل عقدة FAST عند الدمج في CI/CD. <br>القيم المسموح بها هي: <br>`recording` لـ[وضع التسجيل][doc-record-mode] و<br>`testing` لـ[وضع الاختبار][doc-test-mode]. | لا |
| `BACKEND_HTTPS_PORTS`  | رقم/أرقام منفذ/منافذ HTTPS المستخدم/ة بواسطة التطبيق المستهدف إذا تم تهيئة منفذ/منافذ غير افتراضي/ة للتطبيق.<br>يمكن سرد عدة منافذ في قيمة هذا الباراميتر، على سبيل المثال: <br>`BACKEND_HTTPS_PORTS='443;3000;8091'`<br>القيمة الافتراضية: `443` | لا |
| `WALLARM_API_CA_VERIFY` | يُحدد ما إذا كان يجب التحقق من شهادة CA الخاصة بخادم API Wallarm.<br>القيم المسموح بها: `true` و `false`.<br>القيمة الافتراضية: `false`. | لا |
| `CA_CERT`              | مسار إلى شهادة CA المستخدمة بواسطة عقدة FAST.<br>القيمة الافتراضية: `/etc/nginx/ssl/nginx.crt`. | لا |
| `CA_KEY`               | مسار إلى مفتاح خاص CA المستخدم بواسطة عقدة FAST. <br>القيمة الافتراضية: `/etc/nginx/ssl/nginx.key`. | لا |


## تحديد عدد الطلبات المسجلة

بشكل افتراضي، تعامل عقدة FAST جميع الطلبات الواردة كطلبات أولية. ولذلك، تسجل الطلبات وتُنشئ وتُنفذ اختبارات الأمان على أساسها. ومع ذلك، من الممكن أن تمر طلبات خارجية لا ينبغي اعتبارها طلبات أولية من خلال عقدة FAST إلى التطبيق المستهدف.

يُمكنك تحديد عدد الطلبات المسجلة بواسطة عقدة FAST من خلال تصفية جميع الطلبات التي لا تستهدف التطبيق (لاحظ أن عقدة FAST تقوم بتوجيه الطلبات المصفاة ولكن لا تقوم بتسجيلها). تقلل هذه القيود من الحمل الواقع على عقدة FAST والتطبيق المستهدف، مع تعزيز عملية الاختبار. لتطبيق هذا القيد، تحتاج إلى معرفة المضيفين الذين يتفاعل معهم مصدر الطلب خلال الاختبار.

يُمكنك تصفية جميع الطلبات غير الأولية من خلال تهيئة متغير البيئة `ALLOWED_HOSTS`.

--8<--  "../include/fast/operations/env-vars-allowed-hosts.md"

تستخدم عقدة FAST هذا المتغير البيئي بالطريقة التالية:
* إذا كانت قيمة عنوان `Host` في الطلب الوارد تطابق القيمة المحددة في متغير `ALLOWED_HOSTS`، فإن عقدة FAST تعتبر الطلب أوليًا. ثم يتم تسجيل الطلب وتوجيهه.
* جميع الطلبات الأخرى يتم توجيهها من خلال عقدة FAST ولكن لا يتم تسجيلها.

!!! info "مثال على استخدام متغير بيئة ALLOWED_HOSTS"
    إذا تم تحديد المتغير على أنه `ALLOWED_HOSTS=google-gruyere.appspot.com`، فسيتم اعتبار الطلبات الموجهة إلى نطاق `google-gruyere.appspot.com` طلبات أولية.