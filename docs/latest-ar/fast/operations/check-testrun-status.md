[doc-about-tr-token]:   internals.md

[img-testrun-velocity]: ../../images/fast/poc/en/checking-testrun-status/testrun-velocity.png
[img-testrun-avg-rps]:  ../../images/fast/poc/en/checking-testrun-status/testrun-avg-rps.png
[img-status-passed]:        ../../images/fast/qsg/common/test-interpretation/passed-colored.png
[img-status-failed]:        ../../images/fast/qsg/common/test-interpretation/failed-colored.png
[img-status-inprogress]:    ../../images/fast/qsg/common/test-interpretation/in-progress.png
[img-status-error]:         ../../images/fast/qsg/common/test-interpretation/error-colored.png
[img-status-waiting]:       ../../images/fast/qsg/common/test-interpretation/waiting-colored.png
[img-status-interrupted]:   ../../images/fast/qsg/common/test-interpretation/interrupted-colored.png
[img-test-runs]:            ../../images/fast/poc/en/checking-testrun-status/test-runs.png

[link-wl-portal-testruns-in-progress]:  https://us1.my.wallarm.com/testing/?status=running

[link-integration-chapter]:         integration-overview.md
[link-vuln-list]:                   ../vuln-list.md

[anchor-testrun-estimates]:         #estimates-of-test-runs-execution-speed-and-time-to-completion

[doc-testrun-copying]:              copy-testrun.md
[doc-stop-recording]:               stop-recording.md


# التحقق من حالة تشغيل الاختبار

تبدأ عملية إعداد وتنفيذ طلبات الاختبار عند تسجيل أول طلب أساسي، وقد تستمر لفترة زمنية طويلة بعد توقف تسجيل الطلبات الأساسية [تم التوقف][doc-stop-recording]. يمكنك التحقق من حالة تشغيل الاختبار للحصول على بعض التفاصيل حول العمليات التي تجري. لذلك، يمكن استخدام الطرق التالية:

* [التحقق من الحالة عبر واجهة Wallarm UI](#checking-the-state-via-wallarm-ui)
* [التحقق من الحالة باستخدام طريقة API](#checking-the-state-using-api-method)

## التحقق من الحالة عبر واجهة Wallarm UI

تتم عرض حالة تشغيل الاختبار في Wallarm UI في وضع الوقت الحقيقي. للتحقق من الحالة:

1. قم بتسجيل الدخول إلى حساب Wallarm الخاص بك في [السحابة الأمريكية](https://us1.my.wallarm.com/) أو [السحابة الأوروبية](https://my.wallarm.com/).
2. فتح قسم **تشغيل الاختبارات** وانقر على تشغيل الاختبار المطلوب.

![مثال على تشغيل الاختبار][img-test-runs]

تتم عرض الحالة لكل طلب أساسي:

* **تم** ![الحالة: تم][img-status-passed]
        
    لم يتم العثور على ثغرات أمنية للطلب الأساسي المحدد.
        
* **جاري** ![الحالة: جاري][img-status-inprogress]
              
    يتم اختبار الطلب الأساسي للبحث عن الثغرات الأمنية.

* **فشل** ![الحالة: فشل][img-status-failed]  
        
    تم العثور على ثغرات أمنية للطلب الأساسي المحدد. يتم عرض عدد الثغرات والرابط للحصول على التفاصيل لكل طلب أساسي.
            
* **خطأ** ![الحالة: خطأ][img-status-error]  
            
    تم إيقاف عملية الاختبار بسبب الخطأ المعروض:

    * `فشل الاتصال`: خطأ في الشبكة
    * `فشل المصادقة`: لم يتم تمرير معلمات المصادقة أو تم تمريرها بشكل غير صحيح
    * `السياسات غير صالحة`: فشل في تطبيق سياسة الاختبار المكونة
    * `استثناء داخلي`: تكوين الاختبار الأمني غير صحيح
    * `خطأ في التسجيل`: معلمات الطلب غير صحيحة أو مفقودة

* **في الانتظار** ![الحالة: في الانتظار][img-status-waiting]      
        
    الطلب الأساسي في قائمة الانتظار للفحص. يمكن اختبار عدد محدود فقط من الطلبات في وقت واحد. 
            
* **تم الإيقاف** ![الحالة: تم الإيقاف][img-status-interrupted]
        
    تم إيقاف عملية الاختبار إما بواسطة زر **إيقاف الاختبار** أو تم تنفيذ تشغيل اختبار آخر على نفس العقدة FAST.

## التحقق من الحالة باستخدام طريقة API

!!! info "البيانات الضرورية"
    للمتابعة مع الخطوات الموصوفة أدناه، تحتاج إلى البيانات التالية:
    
    * رمز
    * معرف تشغيل الاختبار
    
    يمكنك الحصول على معلومات مفصلة حول تشغيل الاختبار والرمز [هنا][doc-about-tr-token].
    
    تم استخدام القيم التالية كقيم مثال في هذا المستند:

    * `token_Qwe12345` كرمز.
    * `tr_1234` كمعرف لتشغيل اختبار.


!!! info "كيفية اختيار الفترة الزمنية الصحيحة للقيام بتحقق من تشغيل الاختبار"
    يمكنك التحقق من حالة تشغيل الاختبار في الفترة الزمنية المحددة مسبقا (على سبيل المثال، 15 ثانية). بدلاً من ذلك، يمكنك استخدام الوقت المقدر لإكمال تشغيل الاختبار لتحديد متى يكون الفحص التالي. يمكنك الحصول على هذا التقدير أثناء التحقق من حالة تشغيل الاختبار. [انظر التفاصيل أدناه.][anchor-testrun-estimates]

لإجراء فحص فردي لحالة تشغيل الاختبار، أرسل الطلب GET إلى الرابط `https://us1.api.wallarm.com/v1/test_run/test_run_id`:

--8<-- "../include/fast/operations/api-check-testrun-status.md"

إذا كان الطلب لخادم API ناجحًا، يتم تقديمك لاستجابة الخادم. توفر الاستجابة الكثير من المعلومات المفيدة، بما في ذلك:

* `vulns`: مصفوفة تحتوي على معلومات حول الثغرات الأمنية المكتشفة في التطبيق المستهدف. يحتوي كل سجل ثغرة أمنية على البيانات التالية بخصوص الثغرة الأمنية المحددة:
    * `id`: معرف الثغرة الأمنية.
    
    * `threat`: الرقم في النطاق من 1 إلى 100، الذي يصف مستوى الخطر للثغرة الأمنية. كلما كان المستوى أعلى، كانت الثغرة الأمنية أكثر خطورة.
    * `code`: رمز يتم تعيينه للثغرة الأمنية.

    * `type`: نوع الثغرة الأمنية. يمكن أن يأخذ المعلم أحد القيم التي تم وصفها [هنا][link-vuln-list].
    
* `state`: حالة تشغيل الاختبار. يمكن أن يأخذ المعلم أحد القيم التالية:
    * `cloning`: تتم الآن استنساخ الطلبات الأساسية (عند [إنشاء نسخة][doc-testrun-copying] من تشغيل اختبار).
    * `running`: تشغيل الاختبار قيد التشغيل والتنفيذ.
    * `paused`: تم إيقاف تنفيذ تشغيل الاختبار.
    * `interrupted`: تم إيقاف تنفيذ تشغيل الاختبار (على سبيل المثال, تم إنشاء تشغيل اختبار جديد للعقدة FAST في حين كان تشغيل الاختبار الحالي يتم بواسطة هذه العقدة).
    * `passed`: اكتمل تنفيذ تشغيل الاختبار بنجاح (لم يتم العثور على ثغرات أمنية).
    * `failed`: اكتمل تنفيذ تشغيل الاختبار بدون نجاح (تم العثور على بعض الثغرات الأمنية).
    
* `baseline_check_all_terminated_count`: عدد الطلبات الأساسية التي تم إكمال كل الفحوصات الخاصة بطلب الاختبار لها.
    
* `baseline_check_fail_count`: عدد الطلبات الأساسية التي فشل بعض الفحوصات الخاصة بطلب الاختبار لها (بمعنى آخر, وجدت FAST ثغرة أمنية).
    
* `baseline_check_tech_fail_count`: عدد الطلبات الأساسية التي فشلت بعض الفحوصات الخاصة بطلب الاختبار لها بسبب المشكلات التقنية (مثل عدم توفر التطبيق المستهدف لبعض الفترات الزمنية).
    
* `baseline_check_passed_count`: عدد الطلبات الأساسية التي تم اجتياز كل الفحوصات الخاصة بطلب الاختبار لها (بمعنى آخر, لم تجد FAST ثغرات أمنية). 
    
* `baseline_check_running_count`: عدد الطلبات الأساسية التي ما زالت الفحوصات الخاصة بطلب الاختبار جارية لها.
    
* `baseline_check_interrupted_count`: عدد الطلبات الأساسية التي تمت مقاطعة كل الفحوصات الخاصة بطلب الاختبار لها (مثلاً, بسبب مقاطعة تشغيل الاختبار)
    
* `sended_requests_count`: العدد الإجمالي لطلبات الاختبار التي تم إرسالها إلى التطبيق المستهدف.
    
* `start_time` و `end_time`: الوقت الذي بدأ فيه تشغيل الاختبار وانتهى، على التوالي. يتم تحديد الوقت بتنسيق الوقت UNIX.
    
* `domains`: قائمة أسماء النطاقات التابعة للتطبيق المستهدف التي كانت الطلبات الأساسية موجهة إليه. 
    
* `baseline_count`: عدد الطلبات الأساسية المسجلة.
    
* `baseline_check_waiting_count`: عدد الطلبات الأساسية التي تنتظر الفحص;

* `planing_requests_count`: العدد الإجمالي لطلبات الاختبار التي تم وضعها في قائمة الانتظار لإرسالها إلى التطبيق المستهدف.

###  تقدير سرعة تنفيذ تشغيل الاختبار والوقت المتوقع للإكمال

هناك مجموعة منفصلة من المعلمات في استجابة خادم API، تتيح لك تقدير سرعة تنفيذ تشغيل الاختبار والوقت المتوقع للإكمال. تتألف المجموعة من المعلمات التالية:

* `current_rps`—السرعة الحالية التي يرسل بها FAST الطلبات إلى التطبيق المستهدف (في لحظة الحصول على حالة تشغيل الاختبار).

    يمثل هذا القيمة متوسط الطلبات في الثانية (RPS). يتم حساب هذا الRPS الوسطي كعدد الطلبات التي يرسلها FAST إلى التطبيق المستهدف في الفترة الزمنية البالغة 10 ثوانٍ قبل الحصول على حالة تشغيل الاختبار. 

    **مثال:**
    إذا تم الحصول على حالة تشغيل الاختبار في 12:03:01 ثم أن قيمة معلمة `current_rps` تتم حسابها ك *(عدد الطلبات المرسلة في الفترة الزمنية [12:02:51-12:03:01])/10*.

* `avg_rps`—السرعة المتوسطة التي يرسل بها FAST الطلبات إلى التطبيق المستهدف (في لحظة الحصول على حالة تشغيل الاختبار).

    تمثل هذه القيمة متوسط عدد الطلبات في الثانية (RPS) الذي أرسلته FAST للتطبيق المستهدف في *مدة تنفيذ تشغيل الاختبار بأكملها*:

    * من بداية تنفيذ تشغيل الاختبار إلى اللحظة الحالية من الوقت إذا كان تشغيل الاختبار لا يزال قيد التنفيذ (والتي تساوي `current time`-`start_time`).
    * من بداية تنفيذ تشغيل الاختبار إلى نهاية تنفيذ تشغيل الاختبار إذا اكتمل تنفيذ تشغيل الاختبار (والتي تساوي `end_time`-`start_time`).

        تتم حساب قيمة المعلم `avg_rps` كونها *(`sended_requests_count`/(مدة تنفيذ تشغيل الاختبار بأكملها))*.
    
* `estimated_time_to_completion`—مقدار الوقت (بالثواني) التي من المحتمل أن يتم بعدها تنفيذ تشغيل الاختبار (في لحظة الحصول على حالة تشغيل الاختبار). 

    تكون قيمة المعلم تساوي `null` إذا كان:
    
    * لا يوجد فحوص ثغرات أمنية في التقدم بعد (على سبيل المثال، لا يوجد طلبات أساسية مسجلة لتشغيل الاختبار الجديد حتى الآن).
    * الاختبار لا يتم تنفيذه (أي، أنه في أي حالة، باستثناء `"state":"running"`).

    يتم حساب قيمة المعلم `estimated_time_to_completion` كونها *(`planing_requests_count`/`current_rps`)*.
    
!!! warning "القيم المحتملة للمعلمات المتعلقة بتقديرات سرعة تنفيذ تشغيل الاختبار والوقت"
    تكون قيم المعلمات المذكورة أعلاه تساوي `null` في الأول 10 ثوانٍ من تنفيذ تشغيل الاختبار.

يمكنك استخدام قيمة المعلم `estimated_time_to_completion` لتحديد متى يتعين القيام بالفحص التالي لحالة تشغيل الاختبار. علماً أن القيمة قد تزيد أو تقل.

**مثال:**

للتحقق من حالة تشغيل الاختبار في فترة الوقت `estimated_time_to_completion`, قم بما يلي:

1.  بعد بداية تنفيذ تشغيل الاختبار، احصل على حالة تشغيل الاختبار عدة مرات. على سبيل المثال، يمكنك أن تقوم بذلك في الفترات الزمنية التي تبلغ 10 ثوانٍ. استمر في القيام بذلك حتى لا تكون قيمة المعلم `estimated_time_to_completion` تساوي `null`.

2.  قم بإجراء الفحص التالي لحالة تشغيل الاختبار بعد `estimated_time_to_completion` ثوانٍ.

3.  كرر الخطوة السابقة حتى يكتمل تنفيذ تشغيل الاختبار.

!!! info "التمثيل البياني للتقديرات"
    يمكنك الحصول على قيم التقديرات باستخدام واجهة الويب Wallarm أيضًا.
    
    للقيام بذلك، قم بتسجيل الدخول إلى Portal Wallarm وانتقل إلى [قائمة تشغيلات الاختبار][link-wl-portal-testruns-in-progress] التي تتم تنفيذها الآن:
    
    ![تقديرات سرعة تشغيل الاختبار ووقت التنفيذ][img-testrun-velocity]
    
    عند اكتمال تنفيذ تشغيل الاختبار، يتم تقديمك لقيمة متوسط الطلبات في الثانية:
    
    ![قيمة متوسط الطلبات في الثانية][img-testrun-avg-rps]
