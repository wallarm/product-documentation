[doc-about-tr-token]:   internals.md

[img-testrun-velocity]: ../../images/fast/poc/en/checking-testrun-status/testrun-velocity.png
[img-testrun-avg-rps]:  ../../images/fast/poc/en/checking-testrun-status/testrun-avg-rps.png
[img-status-passed]:        ../../images/fast/qsg/common/test-interpretation/pass-colored.png
[img-status-failed]:        ../../images/fast/qsg/common/test-interpretation/fail-colored.png
[img-status-inprogress]:    ../../images/fast/qsg/common/test-interpretation/in-progress.png
[img-status-error]:         ../../images/fast/qsg/common/test-interpretation/error-colored.png
[img-status-waiting]:       ../../images/fast/qsg/common/test-interpretation/waiting-colored.png
[img-status-interrupted]:   ../../images/fast/qsg/common/test-interpretation/interrupted-colored.png
[img-test-runs]:            ../../images/fast/poc/en/checking-testrun-status/test-runs.png

[link-wl-portal-testruns-in-progress]:  https://us1.my.wallarm.com/testing/?status=running

[link-integration-chapter]:         integration-overview.md
[link-vuln-list]:                   ../vuln-list.md

[anchor-testrun-estimates]:         #estimates-of-test-runs-execution-speed-and-time-to-completion

[doc-testrun-copying]:              copy-testrun.md
[doc-stop-recording]:               stop-recording.md


# التحقق من حالة تشغيل الاختبار

تبدأ عمليات إنشاء وتنفيذ طلبات الاختبار عند تسجيل أول طلب أساسي وقد تستمر لفترة زمنية كبيرة بعد اكتمال عملية تسجيل طلبات الأساس. يمكنك التحقق من حالة تشغيل الاختبار للحصول على بعض الإشارات حول العمليات المستمرة. لهذا، يمكن استخدام الطرق التالية:

* [التحقق من الحالة عبر واجهة المستخدم الرسومية لـ Wallarm](#checking-the-state-via-wallarm-ui)
* [التحقق من الحالة باستخدام طريقة API](#checking-the-state-using-api-method)

## التحقق من الحالة عبر واجهة المستخدم الرسومية لـ Wallarm

يتم عرض حالة تشغيل الاختبار في واجهة المستخدم الرسومية لـ Wallarm في الوقت الفعلي. للتحقق من الحالة:

1. قم بتسجيل الدخول إلى حساب Wallarm الخاص بك في [سحابة الولايات المتحدة](https://us1.my.wallarm.com/) أو [سحابة الاتحاد الأوروبي](https://my.wallarm.com/).
2. افتح قسم **تشغيل الاختبارات** واضغط على تشغيل الاختبار المطلوب.

![مثال على تشغيل الاختبار][img-test-runs]

يتم عرض الحالة لكل طلب أساسي:

* **تمت المراجعة** ![الحالة: تمت المراجعة][img-status-passed]

    لم يتم العثور على ثغرات أمنية للطلب الأساسي المعطى.

* **في الاختبار** ![الحالة: في الاختبار][img-status-inprogress]

    الطلب الأساسي يتم اختباره للبحث عن الثغرات الأمنية.

* **فشل** ![الحالة: فشل][img-status-failed]  

    تم العثور على ثغرات أمنية للطلب الأساسي المعطى. يتم عرض عدد الثغرات الأمنية والرابط للتفاصيل لكل طلب أساسي.

* **خطأ** ![الحالة: خطأ][img-status-error]  

    تم إيقاف عملية الاختبار بسبب الخطأ المعروض:

    * `فشل الاتصال`: خطأ في مشكلة الشبكة
    * `فشل المصادقة`: لم يتم تمرير التوثيق أو تم تمرير توثيق غير صحيح
    * `السياسات غير صالحة`: فشل في تطبيق السياسة القائمة
    * `استثناء داخلي`: تكوين أمان غير صحيح
    * `خطأ التسجيل`: تم تغيير بعض المتغيرات    

* **في الانتظار** ![الحالة: في الانتظار][img-status-waiting]      

    الطلب الأساسي في قائمة الانتظار للامتحان. يمكن اختبار عدد محدود فقط من الطلبات في وقت واحد.

* **تم قطعها** ![الحالة: تم قطعها][img-status-interrupted]

    تم قطع عملية الاختبار إقليمًا من خلال الزر **إقليمًا الاختبار** أو تم تنفيذ تشغيل الاختبار الآخر على نفس عقدة FAST.

## التحقق من الحالة باستخدام طريقة API

!!! info "البيانات اللازمة"
    للمتابعة مع الخطوات الموضحة أدناه، يلزم وجود معلومتين:

    * الرمز المميز
    * معرف تشغيل الاختبار

    يمكنك الحصول على معلومات تفصيلية حول تشغيل الاختبار والرمز المميز [هنا][doc-about-tr-token].

    يتم استخدام القيم التالية كمثال في هذا المستند:

    * `token_Qwe12345` كرمز مميز.
    * `tr_1234` كمعرف لتشغيل الاختبار.


!!! info "كيفية اختيار الفترة الزمنية الصحيحة للقيام بالتحقق من تشغيل الاختبار"
    يمكنك التحقق من حالة تشغيل الاختبار في الفترة الزمنية المحددة مسبقًا (مثلاً ، 15 ثانية). بالإضافة إلى ذلك، يمكنك استخدام الوقت المقدر لاكتمال تشغيل الاختبار لتحديد متى يجب القيام بالتحقق التالي. يمكنك الحصول على هذا التقدير أثناء التحقق من حالة تشغيل الاختبار. [راجع التفاصيل أدناه.][anchor-testrun-estimates]

لإجراء فحص مرة واحدة لحالة تشغيل الاختبار، أرسل الطلب GET إلى العنوان URL `https://us1.api.wallarm.com/v1/test_run/test_run_id`:

--8<-- "../include/fast/operations/api-check-testrun-status.md"

إذا كان الطلب إلى خادم API ناجحًا، يتم تقديم استجابة الخادم لك. تقدم الاستجابة العديد من المعلومات المفيدة، بما في ذلك:

* `vulns`: مصفوفة تحتوي على معلومات حول الثغرات الأمنية المكتشفة في التطبيق الهدف. كل من سجلات الثغرات الأمنية تحمل البيانات التالية بشأن الثغرة الأمنية معينة:
    * `id`: معرف الثغرة الأمنية.
    
    * `threat`: الرقم في المدى من 1 إلى 100، الذي يصف مستوى التهديد للثغرة الأمنية. كلما كان المستوى أعلى، كانت الثغرة أكثر حدة.
    * `code`: رمز مخصص للثغرة الأمنية.

    * `type`: نوع الثغرة الأمنية. يمكن للمعلمة اتخاذ أحد القيم التي تم وصفها [هنا][link-vuln-list].
    
* `state`: حالة تشغيل الاختبار. يمكن للمعلمة اتخاذ أحد القيم التالية:
    * `cloning`: يجري استنساخ طلبات الأساس (عند [إنشاء نسخة][doc-testrun-copying] من تشغيل الاختبار).
    * `running`: يتم تشغيل الاختبار وتنفيذه.
    * `paused`: تم إيقاف تشغيل الاختبار.
    * `interrupted`: تم قطع تشغيل الاختبار (على سبيل المثال، تم إنشاء تشغيل اختبار جديد للعقدة FAST بينما كان يجري إجراء تشغيل الاختبار الحالي عبر هذه العقدة).
    * `passed`: اكتمل تشغيل الاختبار بنجاح (لم يتم العثور على ثغرات أمنية).
    * `failed`: لم يكتمل تشغيل الاختبار بنجاح (تم العثور على بعض الثغرات الأمنية).
    
* `baseline_check_all_terminated_count`: عدد طلبات الأساس التي تم الانتهاء من جميع طلبات اختبارها.
    
* `baseline_check_fail_count`: عدد طلبات الأساس التي فشلت بعض عمليات اختبار الطلبات (بمعنى آخر، تم العثور على ثغرة بواسطة FAST).
    
* `baseline_check_tech_fail_count`: عدد طلبات الأساس التي فشلت بعض عمليات اختبار الطلبات بسبب مشكلات تقنية (مثلاً، إذا كان التطبيق الهدف غير متاح لفترة من الوقت).
    
* `baseline_check_passed_count`: عدد طلبات الأساس التي تم الانتهاء من جميع طلبات اختبارها (بمعنى آخر، لم يعثر FAST على الثغرة الأمنية).

* `baseline_check_running_count`: عدد طلبات الأساس التي ما زالت عمليات اختبار الطلبات قائمة لها.
    
* `baseline_check_interrupted_count`: عدد طلبات الأساس التي تم قطع جميع عمليات اختبار الطلبات (على سبيل المثال، بسبب قطع تشغيل الاختبار).
    
* `sended_requests_count`: العدد الكلي لطلبات الاختبار التي تم إرسالها إلى التطبيق الهدف.
    
* `start_time` و `end_time`: الوقت الذي بدأ وانتهى فيه تشغيل الاختبار، على التوالي. الوقت محدد في شكل الوقت UNIX.
    
* `domains`: قائمة أسماء النطاقات للتطبيق الهدف التي تم استهداف طلبات الأساس إليها. 
    
* `baseline_count`: عدد الطلبات الأساسية المسجلة.
    
* `baseline_check_waiting_count`: عدد طلبات الأساس التي تنتظر الفحص.

* `planing_requests_count`: العدد الكلي لطلبات الاختبار التي هي في قائمة الانتظار لإرسالها إلى التطبيق الهدف.

### تقديرات سرعة تنفيذ تشغيل الاختبار والوقت حتى الاكتمال

هناك مجموعة منفصلة من المعلمات في استجابة خادم API، والتي تتيح لك تقدير سرعة تنفيذ اختبار الاختبار والوقت حتى الانتهاء. تتألف المجموعة من المعلمات التالية:

* `current_rps`— السرعة الحالية التي ترسل بها FAST الطلبات إلى التطبيق الهدف (في لحظة الحصول على حالة تشغيل الاختبار).

    هذه القيمة هي متوسط ​​الطلبات في الثانية (Requests Per Second - RPS). يتم حساب هذا المتوسط ​​RPS كعدد الطلبات التي أرسلتها FAST إلى التطبيق الهدف في الفترة الزمنية البالغة 10 ثوانٍ قبل الحصول على حالة تشغيل الاختبار.

    **مثال:**
    إذا تم الحصول على حالة تشغيل الاختبار في الساعة 12:03:01 ، فيتم حساب قيمة معلمة `current_rps` كـ *(عدد الطلبات المرسلة في الفترة الزمنية [12:02:51-12:03:01])/10*.

* `avg_rps`— السرعة المتوسطة التي ترسل بها FAST الطلبات إلى التطبيق الهدف (في لحظة الحصول على حالة تشغيل الاختبار).

    هذه القيمة هي العدد المتوسط  للطلبات في الثانية (RPS) الذي تم إرساله بواسطة FAST إلى التطبيق الهدف في *كل وقت تنفيذ تشغيل الاختبار*:

    * من بداية تنفيذ تشغيل الاختبار إلى اللحظة الحالية إذا كان تشغيل الاختبار ما زال قائمًا (والذي يساوي `الوقت الحالي`- `توقيت البداية`).
    * من بداية تنفيذ تشغيل الاختبار إلى نهاية تشغيل الاختبار إذا اكتمل تنفيذ الاختبار (والذي يساوي `end_time` - `start_time`).

        يتم حساب قيمة المعلمة `avg_rps` كـ *(`sended_requests_count` /(كل وقت تنفيذ الاختبار))*.
    
* `estimated_time_to_completion`— الكمية من الوقت (بثوانٍ) التي سيكتمل بعدها تنفيذ الاختبار على الأرجح (في لحظة الحصول على حالة تشغيل الاختبار). 

    قيمة المعلمة هي `null` إذا:

    * لم تكن هناك أي عمليات فحص الثغرات الأمنية قيد التنفيذ حتى الآن (كإعداد، لا يوجد طلبات أساس مسجلة لتشغيل الاختبار الجديد حتى الآن).
    * يتم تنفيذ الاختبار (أي أنها في أي حالة، باستثناء `"state":"running"`).
   
    يتم حساب قيمة المعلمة `estimated_time_to_completion` كـ *(`planing_requests_count`/`current_rps`)*.
      
!!! warning "القيم المحتملة للمعلمات المتعلقة بتقديرات سرعة تنفيذ تشغيل الاختبار والوقت"
    قيم المعلمات المذكورة أعلاه هي `null` في الـ10 ثوانٍ الأولى من تنفيذ تشغيل الاختبار.

يمكنك استخدام قيمة المعلمة `estimated_time_to_completion` لتحديد متى يجب القيام بالتحقق التالي من حالة تشغيل الاختبار. لاحظ أن القيمة قد تزيد أو تنقص.

**مثال:**

للتحقق من حالة تشغيل الاختبار في فترة `estimated_time_to_completion` ، قم بما يلي:

1. بعد بدء تنفيذ تشغيل الاختبار، اكتسب حالة تشغيل الاختبار عدة مرات. على سبيل المثال، يمكنك القيام بذلك في فترة تلك 10 ثوان. تابع ذلك حتى تصبح قيمة المعلمة `estimated_time_to_completion` غير `null`.

2. قم بإجراء الفحص التالي لحالة تشغيل الاختبار بعد `estimated_time_to_completion` ثانية.

3. كرر الخطوة السابقة حتى يكتمل تنفيذ الاختبار.

!!! info "التمثيل البياني للتقديرات"
    يمكنك كذلك الحصول على قيم التقديرات باستخدام واجهة الويب الرسومية لـ Wallarm.
    
    للقيام بذلك، سجل الدخول إلى البوابة Wallarm وانتقل إلى [قائمة تشغيل الاختبارات][link-wl-portal-testruns-in-progress] التي تتم الآن:
    
    ![تقديرات سرعة تشغيل الاختبار ووقت التنفيذ][img-testrun-velocity]
    
    عندما يكتمل تنفيذ الاختبار، يتم تقديم قيمة متوسط ​​الطلبات في الثانية:
    
    ![قيمة متوسط ​​الطلبات في الثانية][img-testrun-avg-rps]