[img-fast-node-internals]: ../../images/fast/qsg/en/test-run/18-qsg-fast-test-run-proxy-internals.png
[img-view-recording-cloud]: ../../images/fast/qsg/common/test-run/20-qsg-fast-test-run-baselines-recording.png
[img-request-exec-result]:  ../../images/fast/qsg/common/test-run/22-qsg-fast-test-run-gruyere-request.png
[img-incoming-baselines]:   ../../images/fast/qsg/common/test-run/23-qsg-fast-test-run-processing.png    
[img-xss-found]:            ../../images/fast/qsg/common/test-run/24-qsg-fast-test-run-vuln.png

[link-deployment]:          deployment.md
[link-wl-console]:          https://us1.my.wallarm.com
[link-previous-chapter]:    test-preparation.md
[link-create-tr-gui]:       ../operations/create-testrun.md#creating-a-test-run-via-web-interface

[anchor1]:  #1-create-and-run-the-test-run  
[anchor2]:  #2-execute-the-https-baseline-request-you-created-earlier 

#   تشغيل الاختبار

سيُرشدك هذا الفصل عبر عملية إنشاء وتنفيذ مجموعة اختبارات الأمان. سيتم بناء مجموعة الاختبار باستخدام سياسة الاختبار وطلب الأساس الذي أنشأته [مسبقًا][link-previous-chapter]. عند إكمال جميع الخطوات الضرورية، ستجد ثغرة XSS كنتيجة لاختبارك.

لبدء اختبار أمان التطبيق، يجب إنشاء اختبار تشغيل. *اختبار التشغيل* يصف عملية اختبار الثغرات الأمنية لمرة واحدة. كل اختبار تشغيل له معرف فريد، وهو أمر حاسم لتشغيل FAST بشكل صحيح. عندما تقوم بإنشاء اختبار تشغيل، يتم إرسال معرف اختبار التشغيل وسياسة الاختبار إلى عقدة FAST. ثم يبدأ عملية اختبار الأمان على العقدة.

FAST يولد وينفذ مجموعة اختبارات الأمان بالطريقة التالية:

1.  العقدة تعمل كوكيل شفاف لجميع الطلبات القادمة حتى يتم إرسال سياسة الاختبار ومعرف اختبار التشغيل إليها.

2.  نظرًا لأن اختبار التشغيل قد تم إنشاؤه وتشغيله، ستتلقى عقدة FAST سياسة الاختبار ومعرف اختبار التشغيل من سحابة Wallarm.

3.  إذا تلقت العقدة طلبًا أساسيًا للتطبيق المستهدف، فإن:
    1.  العقدة تُعلم الطلب القادم بمعرف اختبار التشغيل
    2.  يتم حفظ الطلب المُعلم في سحابة Wallarm
    3.  يتم إرسال الطلب الأساسي الأول إلى التطبيق المستهدف دون تعديل
    
    !!! info "عملية تسجيل الطلبات الأساسية"
        هذه العملية غالبًا ما تُشار إليها بتسجيل الطلبات الأساسية. يُمكنك إيقاف التسجيل إما من واجهة الويب للسحابة أو عن طريق إجراء استدعاء API إلى واجهة برمجة تطبيقات Wallarm. ستواصل العقدة إرسال الطلبات الأساسية الأولية إلى التطبيق المستهدف.
    
    يبدأ تسجيل الطلبات الأساسية إذا تلقت العقدة سياسة الاختبار ومعرف اختبار التشغيل أولاً.
    
    تحدد عقدة FAST ما إذا كان الطلب هو طلب أساسي من خلال فحص متغير البيئة `ALLOWED_HOSTS`. تم إعداد هذا المتغير أثناء عملية [نشر العقدة][link-deployment]. إذا كان نطاق الهدف للطلب مسموحًا به بواسطة المتغير، يعتبر الطلب أساسيًا. إذا اتبعت الدليل، سيتم اعتبار جميع الطلبات إلى نطاق `google-gruyere.appspot.com` كطلبات أساسية.
    
    جميع الطلبات الأخرى التي لا تستهدف التطبيق يتم توجيهها كوكيل شفاف دون أي تعديلات.

4.  تجلب عقدة FAST جميع الطلبات الأساسية المسجلة من سحابة Wallarm بناءً على معرف اختبار التشغيل.

5.  تولد عقدة FAST اختبارات الأمان لكل طلب أساسي باستخدام سياسة الاختبار المستلمة من السحابة.

6.  يتم تنفيذ مجموعة اختبارات الأمان المولدة عن طريق إرسال الطلبات إلى التطبيق المستهدف من العقدة. يتم ربط نتائج الاختبار بمعرف اختبار التشغيل ويتم تخزينها في السحابة.

    ![منطق عمليات عقدة FAST الداخلي][img-fast-node-internals]

    !!! info "ملاحظة حول اختبار التشغيل قيد الاستخدام"
        في أي فترة زمنية معينة، يمكن تشغيل اختبار تشغيل واحد فقط على عقدة FAST. إذا قمت بإنشاء اختبار تشغيل آخر لنفس العقدة، سيتم قطع تنفيذ اختبار التشغيل الحالي.
       
لبدء عملية توليد وتنفيذ مجموعة اختبارات الأمان، قم بما يلي:

1.  [إنشاء وتشغيل اختبار التشغيل][anchor1]
2.  [تنفيذ طلب الأساس HTTPS الذي أنشأته سابقًا][anchor2]
    
##  1.  إنشاء وتشغيل اختبار التشغيل  

أنشئ اختبار تشغيل عبر واجهة الويب لحساب Wallarm باتباع ال[تعليمات][link-create-tr-gui].

بعد اتباع التعليمات، قم بضبط البارامترات الأساسية التالية عند إنشاء اختبار التشغيل:

* اسم اختبار التشغيل: `DEMO TEST RUN`;
* سياسة الاختبار: `DEMO POLICY`;
* عقدة FAST: `DEMO NODE`.

هذه التعليمات لا تحتوي على إعدادات متقدمة.

بعد حفظ اختبار التشغيل، سيتم نقل معرفه تلقائيًا إلى عقدة FAST. في علامة التبويب "Testruns" سترى اختبار التشغيل المُنشأ مع مؤشر نقطة حمراء وامضة. هذا المؤشر يعني أنه يتم تسجيل الطلبات الأساسية لاختبار التشغيل.

يمكنك النقر على عمود "Baseline req." لرؤية جميع الطلبات الأساسية التي يتم تسجيلها.

![عرض الطلبات الأساسية المسجلة][img-view-recording-cloud]

!!! info "جاهزية العقدة للتسجيل"
    يجب أن تنتظر حتى ترى إخراج الوحدة الطرفية الذي يشير إلى أن عقدة FAST المسماة `DEMO NODE` جاهزة لتسجيل الطلبات الأساسية لاختبار التشغيل المسمى `DEMO TEST RUN`
    
    إذا كانت العقدة جاهزة لتسجيل الطلب الأساسي، سترى رسالة مشابهة في إخراج الوحدة الطرفية:
    
    `[info] Recording baselines for TestRun#N ‘DEMO TEST RUN’`
    
    ستكون العقدة قادرة على توليد مجموعة اختبارات الأمان بناءً على الطلبات الأساسية فقط بعد ظهور هذه الرسالة.	

يتضح من إخراج الوحدة الطرفية أن عقدة FAST المسماة `DEMO NODE` جاهزة لتسجيل الطلبات الأساسية لاختبار التشغيل المسمى `DEMO TEST RUN`:

--8<-- "../include/fast/console-include/qsg/fast-node-ready-for-recording.md"
    
    
##  2.  تنفيذ طلب الأساس HTTPS الذي أنشأته سابقًا

للقيام بذلك، انتقل إلى الرابط الذي [أنشأته][link-previous-chapter] باستخدام متصفح موزيلا فايرفوكس المُعد مسبقًا.

!!! info "مثال على رابط"
    <https://google-gruyere.appspot.com/430232491618310677730226710602783767322/snippets.gtl?password=paSSw0rd&uid=123>

يظهر نتيجة تنفيذ الطلب أدناه:

![نتيجة تنفيذ الطلب][img-request-exec-result]

يتضح من إخراج الوحدة الطرفية أن عقدة FAST قد سجلت طلبًا أساسيًا:

--8<-- "../include/fast/console-include/qsg/fast-node-testing.md"

يمكنك ملاحظة بعض الطلبات الأساسية يتم حفظها في سحابة Wallarm:

![الطلبات الأساسية الواردة][img-incoming-baselines]

يوحي هذا الوثيق بأن يتم تنفيذ طلب واحد فقط لأغراض العرض. بما أنه لا توجد طلبات إضافية للتطبيق المستهدف، توقف عملية تسجيل الطلبات الأساسية عن طريق اختيار خيار **إيقاف التسجيل** من قائمة "الإجراءات" المنسدلة.

!!! info "التحكم في عملية تنفيذ اختبار التشغيل"
    تم إنشاء مجموعة اختبارات الأمان بسرعة كبيرة لاختبار التشغيل الذي أنشأته. ومع ذلك، قد تستغرق العملية وقتًا طويلاً اعتمادًا على عدد الطلبات الأساسية، سياسة الاختبار المستخدمة، واستجابة التطبيق المستهدف. يُمكنك إيقاف أو إيقاف عملية الاختبار مؤقتًا عن طريق اختيار خيار مناسب من قائمة "الإجراءات" المنسدلة.

يتوقف اختبار التشغيل تلقائيًا عند انتهاء عملية الاختبار، بشرط عدم وجود تسجيل للطلبات الأساسية قيد التقدم. سيتم عرض بعض المعلومات الموجزة عن الثغرات الأمنية المكتشفة في عمود "النتيجة". يجب على FAST العثور على بعض ثغرات XSS للطلب HTTPS المُنفذ:

![الثغرة الأمنية المكتشفة][img-xss-found]

الآن، يجب أن تكون قد أكملت جميع أهداف الفصل، إلى جانب نتيجة اختبار طلب HTTPS إلى تطبيق Google Gruyere. تُظهر النتيجة العثور على ثلاث ثغرات XSS.