# إنشاء صورة بواسطة العقدة الفلترية من Wallarm على منصة Google Cloud

لضبط توسع العقد الفلترية من Wallarm العاملة على منصة Google Cloud (GCP)، عليك أولاً بتجهيز صور الآلة الافتراضية. يصف هذا الوثيقة الإجراء لتجهيز صورة الآلة الافتراضية حيث يتم تثبيت العقدة الفلترية من Wallarm. لمعلومات تفصيلية حول ضبط توسع تلقائي، تابع إلى هذا [الرابط][link-docs-gcp-autoscaling].

لإنشاء صورة بالعقدة الفلترية من Wallarm على GCP، قم بتنفيذ الإجراءات التالية:
1. [إنشاء وضبط نموذج العقدة الفلترية على منصة Google Cloud][anchor-node].
2. [إنشاء صورة الآلة الافتراضية بناءً على نموذج العقدة الفلترية المضبوط][anchor-gcp].

## 1. إنشاء وضبط نموذج العقدة الفلترية على منصة Google Cloud

قبل إنشاء صورة، عليك بتنفيذ ضبط أولي لعقدة فلترة واحدة من Wallarm. لضبط العقدة الفلترية، قم بالتالي:
1. [إنشاء وضبط][link-docs-gcp-node-setup] نموذج العقدة الفلترية على GCP.

    !!! تحذير "إمداد العقدة الفلترية باتصال بالإنترنت"
        العقدة الفلترية تحتاج لوصول إلى خادم API Wallarm للعمل بشكل صحيح. اختيار خادم API Wallarm يعتمد على السحابة Wallarm التي تستخدمها:
        
        * إذا كنت تستخدم سحابة الولايات المتحدة، يجب منح العقدة وصولاً إلى `https://us1.api.wallarm.com`.
        * إذا كنت تستخدم السحابة الأوروبية، يجب منح العقدة وصولاً إلى `https://api.wallarm.com`.
    
    --8<-- "../include/gcp-autoscaling-connect-ssh.md"

2. [ربط][link-cloud-connect-guide] العقدة الفلترية بسحابة Wallarm.

    !!! تحذير "استخدام رمز للاتصال بسحابة Wallarm"
        يرجى ملاحظة أنه يجب عليك ربط العقدة الفلترية بسحابة Wallarm باستخدام رمز. يسمح بربط عدة عقد فلترية بسحابة Wallarm باستخدام نفس الرمز.
       
        وبذلك، لن تحتاج إلى ربط كل العقد الفلترية بسحابة Wallarm يدوياً عندما يتم توسعهم تلقائياً.

3. [ضبط][link-docs-reverse-proxy-setup] العقدة الفلترية لتعمل كوكيل عكسي لتطبيق الويب الخاص بك.

4. [تأكد][link-docs-check-operation] من أن العقدة الفلترية مضبوطة بشكل صحيح وتحمي تطبيق الويب الخاص بك ضد الطلبات الخبيثة.

بعد الانتهاء من ضبط العقدة الفلترية، قم بإيقاف الآلة الافتراضية بتنفيذ الإجراءات التالية:
1. انتقل إلى صفحة **VM Instances** تحت قسم **Compute Engine** من القائمة.
2. افتح القائمة المنسدلة بالنقر على زر القائمة يمين عمود **Connect**.
3. اختر **Stop** من القائمة المنسدلة.

![إيقاف الآلة الافتراضية][img-vm-instance-poweroff]

!!! معلومة "إيقاف باستخدام أمر `poweroff`"
    يمكنك أيضاً إيقاف الآلة الافتراضية بالاتصال بها عبر بروتوكول SSH وتشغيل الأمر التالي:
    
    ``` bash
 	poweroff
 	```

## 2. إنشاء صورة الآلة الافتراضية

يمكنك الآن إنشاء صورة آلة افتراضية بناءً على نموذج العقدة الفلترية المضبوط. لإنشاء صورة، قم بالخطوات التالية:
1. انتقل إلى صفحة **Images** تحت قسم **Compute Engine** من القائمة وانقر على زر **Create image**.
2. ادخل اسم الصورة في حقل **Name**.
3. اختر **Disk** من القائمة المنسدلة **Source**.
4. اختر اسم الآلة الافتراضية [التي تم إنشاؤها سابقاً][anchor-node] من القائمة المنسدلة **Source disk**.

    ![إنشاء صورة][img-create-image]

5. انقر على زر **Create** لبدء عملية إنشاء صورة الآلة الافتراضية.

بمجرد الانتهاء من عملية إنشاء الصورة، سيتم توجيهك إلى صفحة تحتوي قائمة بالصور المتاحة. تأكد من أن الصورة تم إنشاؤها بنجاح وموجودة في القائمة.

![قائمة الصور][img-check-image]

الآن يمكنك [ضبط توسع تلقائي][link-docs-gcp-autoscaling] لعقد Wallarm الفلترية على منصة Google Cloud باستخدام الصورة المجهزة.