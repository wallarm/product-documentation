[link-doc-asg-guide]:               autoscaling-group-guide.md  
[link-docs-check-operation]:        ../../installation-check-operation-en.md

[link-aws-lb-comparison]:           https://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/what-is-load-balancing.html?icmpid=docs_elbv2_console#elb-features   

[img-lb-basics]:                    ../../../images/installation-ami/auto-scaling/common/load-balancing-guide/lb-create-1.png
[img-lb-routing]:                   ../../../images/installation-ami/auto-scaling/common/load-balancing-guide/lb-create-3.png
[img-checking-operation]:           ../../../images/admin-guides/test-attacks-quickstart.png

[anchor-create]:        #1-creating-a-load-balancer
[anchor-configure]:     #2-setting-up-an-auto-scaling-group-for-using-the-created-balancer

#   إنشاء موزع الحمل على AWS

الآن، بعد أن لديكم مجموعة تحجيم تلقائي لعقد تصفية مُعدة، تحتاجون إلى إنشاء وتكوين موزع حمل يوزع الاتصالات القادمة عبر HTTP وHTTPS بين عدة عقد تصفية من مجموعة التحجيم التلقائي.

تتضمن عملية إنشاء موزع الحمل الخطوات التالية:
1.  [إنشاء موزع حمل][anchor-create]
2.  [إعداد مجموعة التحجيم التلقائي لاستخدام موزع الحمل الذي تم إنشاؤه][anchor-configure]

##  1.  إنشاء موزع حمل

يمكنكم تكوين أنواع موزعي الحمل التالية في السحابة من Amazon:
*   موزع الحمل الكلاسيكي
*   موزع الحمل الشبكي
*   موزع الحمل تطبيقي

!!! info "الفروقات بين موزعي الحمل"
    للاطلاع على معلومات مفصلة عن الفروقات بين موزعي الحمل، تابعوا هذا [الرابط][link-aws-lb-comparison].

يستعرض هذا الوثيقة كيفية تكوين واستخدام موزع الحمل الشبكي الذي يوزع الحركة المرورية على مستوى نقل شبكة ال OSI/ISO.

أنشئوا موزع حمل بإكمال الأفعال التالية:
1.  انتقلوا إلى علامة التبويب **موزعات الحمل** في لوحة تحكم Amazon EC2 واضغطوا على زر **إنشاء موزع حمل**.

2.  أنشئوا موزع حمل شبكي بالضغط على الزر المقابل **إنشاء**.

3.  قوموا بتكوين معلمات موزع الحمل الأساسية:

    ![تكوين معلمات موزع الحمل العامة][img-lb-basics]
    
    1.  اسم الموزع (معامل **الاسم**).
    
    2.  نوع الموزع (معامل **النمط**). اختاروا نوع **المواجه للإنترنت** ليكون الموزع متاحًا على الإنترنت.
    
    3.  حددوا المنافذ التي يستمع لها الموزع باستخدام مجموعة معلمات **المستمعين**.
    
    4.  حددوا الـ VPC ومناطق التوفر المطلوبة التي يجب أن يعمل بها الموزع.
        
        !!! info "تحقق من توفر مجموعة التحجيم التلقائي"
            تأكدوا من اختيار الـ VPC ومناطق التوفر التي تحتوي على مجموعة التحجيم التلقائي [التي تم إنشاؤها في وقت سابق][link-doc-asg-guide] ليعمل موزع الحمل بشكل صحيح.
        
4.  المضي للخطوة التالية بالضغط على زر **التالي: تكوين إعدادات الأمان**.

    قوموا بتكوين معلمات الأمان إذا لزم الأمر.
    
5.  انتقلوا للخطوة التالية بالضغط على زر **التالي: تكوين التوجيه**.

    قوموا بتكوين توجيه الطلبات الواردة إلى عقد التصفية في مجموعة التحجيم التلقائي.

    ![تكوين توجيه الاتصالات الواردة][img-lb-routing]
    
    1.  أنشئوا مجموعة أهداف جديدة وحددوا اسمها في حقل **الاسم**. سيقوم موزع الحمل بتوجيه الطلبات الواردة إلى النماذج الموجودة في مجموعة الأهداف المحددة (مثل، `demo-target`).
        
    2.  قوموا بتكوين البروتوكول والمنفذ المستخدمين لتوجيه الطلب.
    
        حددوا بروتوكول TCP ومنافذ 80 و443 (إذا كان لديكم حركة مرور HTTPS) لعقدة التصفية.
        
    3.  إذا لزم الأمر، قوموا بتكوين فحوصات التوفر باستخدام مجموعة معاملات **فحوصات الصحة**.
    
6.  المضي للخطوة التالية بالنقر على زر **التالي: تسجيل الأهداف**.

    هذه الخطوة لا تتطلب أي إجراءات.
    
7.  انتقلوا إلى الخطوة التالية بالضغط على زر **التالي: مراجعة**.
    
    تأكدوا من تحديد جميع المعاملات بشكل صحيح، وابدؤوا عملية إنشاء موزع الحمل بالضغط على زر **إنشاء**.

!!! info "انتظروا حتى يتم تهيئة موزع الحمل"
    بعد إنشاء موزع الحمل، يجب أن يمر بعض الوقت حتى يكون جاهزًا لاستقبال الحركة المرورية.

##  2.  إعداد مجموعة التحجيم التلقائي لاستخدام الموزع الذي تم إنشاؤه

قوموا بتكوين مجموعة التحجيم التلقائي الخاصة بكم لاستخدام موزع الحمل الذي أنشأتموه في وقت سابق. سيسمح هذا للموزع بتوجيه الحركة المرورية إلى نماذج عقد التصفية التي يتم إطلاقها في المجموعة.

للقيام بذلك، أكملوا الإجراءات التالية:
1.  انتقلوا إلى علامة التبويب **مجموعات التحجيم التلقائي** على لوحة تحكم Amazon EC2 واختاروا مجموعة التحجيم التلقائي [التي تم إنشاؤها سابقاً][link-doc-asg-guide].

2.  افتحوا حوار تعديل تكوين المجموعة بتحديد *تعديل* في قائمة **الإجراءات** الجانبية.

3.  اختاروا مجموعة الأهداف **demo-target** [التي تم إنشاؤها][anchor-create] عند إعداد موزع الحمل في قائمة منسدلة **مجموعات الأهداف**.

4.  طبقوا التغييرات بالضغط على زر **حفظ**.

الآن، ستتولى مجموعة Wallarm من عقد التصفية التي تتغير حجمها ديناميكيًا معالجة الحركة المرورية الواردة إلى تطبيقكم.

لفحص عمل نماذج التصفية المنتشرة، نفذوا الخطوات التالية:

1.  تأكدوا من أن تطبيقكم يمكن الوصول إليه من خلال موزع الحمل وعقد Wallarm للتصفية من خلال الرجوع إلى عنوان IP لموزع الحمل أو اسم النطاق باستخدام المتصفح.

2.  تأكدوا من حماية خدمات Wallarm لتطبيقكم [بإجراء هجوم اختباري][link-docs-check-operation].

![فحص عمل عقدة التصفية][img-checking-operation]