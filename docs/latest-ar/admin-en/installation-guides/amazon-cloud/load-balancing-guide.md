[link-doc-asg-guide]:               autoscaling-group-guide.md  
[link-docs-check-operation]:        ../../installation-check-operation-en.md

[link-aws-lb-comparison]:           https://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/what-is-load-balancing.html?icmpid=docs_elbv2_console#elb-features   

[img-lb-basics]:                    ../../../images/installation-ami/auto-scaling/common/load-balancing-guide/lb-create-1.png
[img-lb-routing]:                   ../../../images/installation-ami/auto-scaling/common/load-balancing-guide/lb-create-3.png
[img-checking-operation]:           ../../../images/admin-guides/test-attacks-quickstart.png

[anchor-create]:        #1-creating-a-load-balancer
[anchor-configure]:     #2-setting-up-an-auto-scaling-group-for-using-the-created-balancer

# إنشاء موزع حمولة على AWS

الآن، بمجرد حصولك على مجموعة توسيع تلقائي مُعدة[link-doc-asg-guide] لعقدة التصفية، يجب عليك إنشاء وتكوين موزع حمولة يوزع الاتصالات الواردة HTTP وHTTPS على عدة عقد تصفية من مجموعة التوسيع التلقائي.

عملية إنشاء موزع الحمولة تتضمن الخطوات التالية:
1. [إنشاء موزع حمولة][anchor-create]
2. [إعداد مجموعة توسيع تلقائي لاستخدام الموزع المُنشأ][anchor-configure]

## 1. إنشاء موزع حمولة

يمكنك تكوين الأنواع التالية من موزعات الحمولة في سحابة أمازون:
* موزع حمولة كلاسيكي
* موزع حمولة شبكي
* موزع حمولة تطبيقي

!!! info "اختلافات موزعات الحمولة"
    لرؤية معلومات مفصلة حول الاختلافات بين موزعات الحمولة، تفضل بالانتقال إلى هذا [الرابط][link-aws-lb-comparison].

يوضح هذا المستند تهيئة واستخدام موزع الحمولة الشبكي الذي يوزع الحركة على مستوى النقل في نموذج الشبكة OSI/ISO.

أنشئ موزع حمولة بإكمال الإجراءات التالية:
1. انتقل إلى علامة التبويب **موزعات الحمولة** على لوحة تحكم Amazon EC2 وانقر على زر **إنشاء موزع حمولة**.

2. أنشئ موزع حمولة شبكي بالنقر على زر **إنشاء** المقابل.

3. ضع إعدادات موزع الحمولة الأساسية:

    ![تكوين إعدادات موزع الحمولة العامة][img-lb-basics]
    
    1. اسم الموزع (المعلمة **الاسم**).
    
    2. نوع الموزع (معلمة **Scheme**). اختر نوع **internet-facing** لكي يتوفر الموزع على الإنترنت.
    
    3. حدد المنافذ التي يجب على الموزع الاستماع إليها باستخدام مجموعة معلمات **المستمعين**.
    
    4. حدد VPC ومناطق التوفر المطلوبة التي يجب أن يعمل بها الموزع.
        
        !!! info "تحقق من توفر مجموعة التوسيع التلقائي"
            تأكد من اختيار VPC ومناطق التوفر التي تحتوي على مجموعة التوسيع التلقائي [المُنشأة مُسبقًا][link-doc-asg-guide] لكي يعمل موزع الحمولة بشكل صحيح.
        
4. انتقل للخطوة التالية بالنقر على زر **Next: Configure Security Settings**.

    قم بتكوين معايير الأمان إذا لزم الأمر.
    
5. استمر إلى الخطوة التالية بالنقر على زر **Next: Configure Routing**.

    قم بتكوين توجيه الطلبات الواردة إلى عقد التصفية في مجموعة التوسيع التلقائي.

    ![تكوين توجيه الاتصالات الواردة][img-lb-routing]
    
    1. أنشئ مجموعة هدف جديدة وحدد اسمها في حقل **الاسم**. سيوجه موزع الحمولة الطلبات الواردة إلى النماذج الموجودة في مجموعة الهدف المحددة (مثلا، `demo-target`).
        
    2. قم بتكوين البروتوكول والمنفذ المستخدم لتوجيه الطلبات.
    
        حدد بروتوكول TCP والمنافذ 80 و 443 (إذا كان لديك حركة مرور HTTPS) لعقدة التصفية.
        
    3. إذا لزم الأمر، قم بتكوين عمليات التحقق من التوفر باستخدام مجموعة معلمات **فحوصات الصحة**.
    
6. انتقل إلى الخطوة التالية بالنقر على زر **Next: Register Targets**.

    هذه الخطوة لا تتطلب أي إجراءات.
    
7. انتقل إلى الخطوة التالية بالنقر على زر **Next: Review**.
    
    تأكد من تحديد جميع المعايير بشكل صحيح، وابدأ عملية إنشاء موزع الحمولة بالنقر على زر **إنشاء**.

!!! info "انتظر حتى يتم تهيئة موزع الحمولة"
    بعد إنشاء موزع الحمولة، يجب أن يمر وقت ليكون جاهزًا لاستقبال الحركة.

## 2. إعداد مجموعة توسيع تلقائي لاستخدام الموزع المُنشأ

قم بتكوين مجموعة التوسيع التلقائي لاستخدام موزع الحمولة الذي أنشأته مسبقًا. سيسمح هذا للموزع بتوجيه الحركة إلى نماذج عقد التصفية التي يتم إطلاقها في المجموعة.

للقيام بذلك، قم بإكمال الإجراءات التالية:
1. انتقل إلى علامة التبويب **مجموعات التوسيع التلقائي** على لوحة تحكم Amazon EC2 وحدد مجموعة التوسيع التلقائي [التي تم إنشائها مُسبقًا][link-doc-asg-guide].

2. افتح حوار تحرير تكوين المجموعة بتحديد *تعديل* في قائمة **الإجراءات** المنسدلة.

3. حدد مجموعة الهدف **demo-target** [التي تم إنشاؤها][anchor-create] عند إعداد موزع الحمولة في قائمة **مجموعات الهدف** المنسدلة.

4. طبّق التغييرات بالنقر على زر **حفظ**.

الآن، ستقوم مجموعة عقد التصفية التي تتوسع ديناميكيًا بمعالجة الحركة الواردة إلى تطبيقك.

للتحقق من تشغيل عقد التصفية الموزعة، قم بالخطوات التالية:

1. تأكد من أن تطبيقك يمكن الوصول إليه من خلال موزع الحمولة وعقد التصفية Wallarm باستخدام عنوان IP للموزع أو اسم النطاق باستخدام المتصفح.

2. تأكد من حماية خدمات Wallarm لتطبيقك [بإجراء هجوم اختباري][link-docs-check-operation].

![التحقق من تشغيل عقدة التصفية][img-checking-operation]