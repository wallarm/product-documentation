# توصيات بشأن تكوين عقدة التصفية للبيئات المنفصلة

لقد تعلمت بالفعل [كيف تعمل عقد التصفية الخاصة بوالارم في البيئات المنفصلة](how-wallarm-in-separated-environments-works.md). لكي تعمل العقد كما وصف، تعلم التوصيات على تكوين العقد في البيئات المنفصلة من هذا المقال.

## عملية نشر حماية والارم الأولية

إذا كنت تقوم بعملية نشر أولية لحماية والارم للبيئات، يُنصح باستخدام النهج التالي (يمكنك تعديله حسب الحاجة):

1. تعرف على خيارات نشر عقد والارم المتاحة [هنا](../../../installation/supported-deployment-options.md).
2. إذا لزم الأمر، تعرف على الخيارات المتاحة لإدارة تكوين عقدة التصفية بشكل منفصل لبيئاتك. يمكنك إيجاد هذه المعلومات [هنا](how-wallarm-in-separated-environments-works.md#relevant-wallarm-features).
3. نشر عقد التصفية والارم في بيئاتك غير المنتجة بوضع التصفية `monitoring`.
4. تعلم كيفية التشغيل، والتوسع، ومراقبة حل والارم؛ تأكد من استقرار المكون الشبكي الجديد.
5. نشر عقد التصفية والارم في بيئة الإنتاج الخاصة بك بوضع التصفية `monitoring`.
6. تطبيق إدارة التكوين السليمة وعمليات المراقبة لمكون والارم الجديد.
7. الاحتفاظ بتدفق الحركة عبر عقد التصفية في جميع بيئاتك، بما في ذلك الاختبار والإنتاج، لمدة 7-14 يومًا لتزويد خلفية والارم القائمة على السحابة ببعض الوقت للتعرف على تطبيقك.
8. تمكين وضع التصفية `blocking` في جميع بيئاتك غير المنتجة واستخدام الاختبارات الآلية أو اليدوية لتأكيد أن التطبيق المحمي يعمل كما هو متوقع.
9. تمكين وضع التصفية `blocking` في بيئة الإنتاج. باستخدام الطرق المتاحة، تأكد من أن التطبيق يعمل كما هو متوقع.

!!! معلومات
    لضبط وضع التصفية، يُرجى استخدام هذه [التعليمات](../../configure-wallarm-mode.md).

## التنفيذ التدريجي لتغييرات عقدة والارم الجديدة

قد تكون هناك حاجة من وقت لآخر إلى تغييرات في بنية والارم القائمة. اعتمادًا على سياسة إدارة التغيير في مؤسستك، قد يُطلب منك اختبار جميع التغييرات المحتملة التي تنطوي على مخاطر في بيئة غير إنتاج، ثم تطبيق التغييرات في بيئة الإنتاج.

يوصى بالنهج التالية لاختبار وتغيير تدريجيًا تكوين مكونات وميزات والارم المختلفة:
* [تكوين منخفض المستوى لعقد التصفية والارم في جميع الأشكال](#low-level-onfiguration-of-wallarm-filtering-nodes-in-all-form-factors)
* [تكوين قواعد عقدة والارم](#configuration-of-wallarm-node-rules)

### التكوين منخفض المستوى لعقد التصفية والارم في جميع الأشكال

يتم تنفيذ التكوين منخفض المستوى لعقد التصفية عبر متغيرات بيئة Docker، وملف تكوين NGINX المقدم، ومعاملات تحكم Kubernetes Ingress، إلخ. طريقة التكوين تعتمد على [خيار النشر](../../../installation/supported-deployment-options.md).

يمكن إدارة التكوين منخفض المستوى بسهولة بشكل منفصل لبيئات العملاء المختلفة باستخدام عمليات إدارة التغيير القائمة لديك لموارد البنية التحتية.

### تكوين قواعد عقدة والارم

بما أن كل سجل قاعدة يمكن أن يكون مرتبطًا بـ[مجموعة مختلفة](how-wallarm-in-separated-environments-works.md#resource-identification) من مُعرّفات نموذج تطبيق أو رؤوس طلب `HOST`، يُنصح بالخيارات التالية:

* أولًا، طبق تكوينًا جديدًا على بيئة اختبار أو تطوير، تحقق من وظائفها، ثم طبق التغيير لبيئة الإنتاج.
* استخدم قاعدة `إنشاء مؤشر هجوم مبني على regexp` في وضع `Experimental`. يسمح هذا الوضع بنشر القاعدة مباشرة في بيئة الإنتاج دون خطر حظر طلبات المستخدم النهائي الصحيحة بالخطأ.

    ![إنشاء قاعدة تجريبية](../../../images/admin-guides/configuration-guides/waf-in-separate-environments/define-attack-experimental.png)

* استخدم قاعدة `ضبط وضع التصفية` للتحكم في وضع التصفية والارم لبيئات وطلبات محددة. توفر هذه القاعدة مرونة إضافية في الطريقة التي يمكن من خلالها تدريجيًا نشر حماية والارم لحماية نقاط النهاية الجديدة والموارد الأخرى في بيئات مختلفة. افتراضيًا، يتم استخدام قيمة [`wallarm_mode`](../../configure-parameters-en.md#wallarm_mode) بناءً على إعداد [`wallarm_mode_allow_override`](../../configure-parameters-en.md#wallarm_mode_allow_override).

    ![إنشاء قاعدة لتجاوز وضع التصفية](../../../images/admin-guides/configuration-guides/waf-in-separate-environments/rule-overwrite-filtering-mode.png)