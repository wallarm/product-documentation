# الحماية اليدوية من هجمات BOLA

الهجمات السلوكية مثل [خلل التحقق من صلاحيات الوصول للكائنات (BOLA)](../../attacks-vulns-list.md#broken-object-level-authorization-bola) تستغل ثغرة بنفس الاسم. تمكن هذه الثغرة المهاجم من الوصول إلى كائن عن طريق معرفه من خلال طلب API وإما قراءة بياناته أو تعديلها متجاوزًا آلية التحقق من الهوية. يوضح هذا المقال تدابير الحماية من BOLA التي توفرها مشغلات [WAAP](../../about-wallarm/waap-overview.md).

!!! info "تدابير حماية BOLA الأخرى"
    كبديل أو إضافة، يمكنك تهيئة [الحماية الآلية من BOLA لنقاط النهاية التي يعثر عليها اكتشاف API](protecting-against-bola.md).

## التهيئة

بشكل افتراضي، تكتشف Wallarm تلقائيًا الثغرات من نوع BOLA (المعروفة أيضًا باسم IDOR) فقط لكنها لا تكتشف محاولات استغلالها.

لكي يتعرف عقدة Wallarm على هجمات BOLA:

1. افتح واجهة Wallarm → **مشغلات** وتابع إلى إعداد مشغل **BOLA**.
1. حدد شروط تعريف الطلبات كهجوم BOLA:

    * عدد **الطلبات من نفس عنوان IP** خلال فترة زمنية معينة.
    * **URI**الذي يحتاج إلى الحماية من هجمات BOLA والذي يتلقى عدد الطلبات المحدد. يجب أن تكون القيمة عبارة عن نقطة نهاية API تشير إلى كائن بمعرفه لأن هذا النوع من نقاط النهاية معرضة بشكل محتمل لهجمات BOLA.

        لتحديد معلمة PATH التي تحدد كائن، استخدم الرمز `*`، مثلًا:

        ```bash
        example.com/shops/*/financial_info
        ```

        يمكن تهيئة URI عبر [منشئ URI](../../user-guides/rules/rules.md#uri-constructor) أو [نموذج التحرير المتقدم](../../user-guides/rules/rules.md#advanced-edit-form) في نافذة إنشاء المشغل.

    * (اختياري) [**التطبيق**](../../user-guides/settings/applications.md) الذي يحتاج إلى الحماية من هجمات BOLA والذي يتلقى عدد الطلبات المحدد.

        إذا كنت تستخدم نفس الاسم لنطاقات متعددة، يُوصى باستخدام هذا الفلتر للإشارة إلى التطبيق الذي يُعين له نطاق في فلتر **URI**.

    * (اختياري) عنوان أو عناوين **IP** التي تنشأ منها الطلبات.
1. اختر ردود فعل المشغل:

    * **وسم كـ BOLA**. الطلبات التي تتجاوز العتبة مُوسمة كهجوم BOLA وتُعرض في قسم **الهجمات** في واجهة Wallarm. عقدة Wallarm لا تحظر هذه الطلبات الخبيثة.
    * [**حظر عناوين IP**](../../user-guides/ip-lists/overview.md) التي تنشأ عنها الطلبات الخبيثة وفترة الحظر.
    
        ستحظر عقدة Wallarm كلاً من الطلبات المشروعة والخبيثة (بما في ذلك هجمات BOLA) الصادرة عن عناوين IP المحظورة.
    
    * [**إدراج عناوين IP في القائمة الرمادية**](../../user-guides/ip-lists/overview.md) التي تنشأ عنها الطلبات الخبيثة وفترة الحظر.
    
        ستحظر عقدة Wallarm الطلبات الصادرة عن عناوين IP الموجودة في القائمة الرمادية فقط إذا كانت تتضمن [علامات التحقق من الإدخال](../../about-wallarm/protecting-against-attacks.md#input-validation-attacks)، [علامات `vpatch`](../../user-guides/rules/vpatch-rule.md) أو هجمات مخصصة.
        
        !!! info "هجمات BOLA الصادرة عن عناوين IP في القائمة الرمادية"
            هجمات BOLA الصادرة عن عناوين IP في القائمة الرمادية لا يتم حظرها.

        ![مشغل BOLA](../../images/user-guides/triggers/trigger-example7.png)

1. احفظ المشغل وانتظر [اكتمال مزامنة السحابة والعقدة](../configure-cloud-node-synchronization-en.md) (عادةً ما يستغرق ذلك من 2 إلى 4 دقائق).

## الاختبار

1. أرسل عدد الطلبات الذي يتجاوز العتبة المُهيأة إلى URI المحمي. على سبيل المثال، 50 طلبًا بقيم `{shop_id}` مختلفة إلى النقطة النهائية `https://example.com/shops/{shop_id}/financial_info`:

    ```bash
    for (( i=0 ; $i<51 ; i++ )) ; do curl https://example.com/shops/$i/financial_info ; done
    ```
1. إذا كانت ردة فعل المشغل **حظر عنوان IP**، افتح واجهة Wallarm → **قوائم IP** → **القائمة السوداء** وتحقق من أن عنوان IP المصدر محظور.

    إذا كانت ردة فعل المشغل **إدراج عنوان IP في القائمة الرمادية**، تحقق من قسم **قوائم IP** → **القائمة الرمادية** في واجهة Wallarm.
1. افتح قسم **الهجمات** وتحقق من أن الطلبات معروضة في القائمة كهجوم BOLA.

    ![هجوم BOLA في واجهة المستخدم](../../images/user-guides/events/bola-attack.png)

    يُقابل عدد الطلبات المعروضة عدد الطلبات المُرسلة بعد تجاوز عتبة المشغل ([مزيد من التفاصيل حول اكتشاف الهجمات السلوكية](../../attacks-vulns-list.md#behavioral-attacks)). إذا كان هذا العدد أكبر من 5، يُطبق أخذ عينات الطلبات وتُعرض تفاصيل الطلب فقط لأول 5 ضربات ([مزيد من التفاصيل حول أخذ عينات الطلبات](../../user-guides/events/analyze-attack.md#sampling-of-hits)).

    للبحث عن هجمات BOLA، يمكنك استخدام علامة البحث `bola`. يتم وصف جميع الفلاتر في [التعليمات حول استخدام البحث](../../user-guides/search-and-filters/use-search.md).

## أولويات معالجة المشغلات
            
--8<-- "../include/trigger-processing-priorities.md"

## المتطلبات والقيود

**المتطلبات**

لحماية الموارد من هجمات BOLA، تُطلب عناوين IP الحقيقية للعملاء. إذا تم نشر عقدة التصفية خلف خادم وكيل أو موزع الحمل، [قم بتهيئة](../using-proxy-or-balancer-en.md) عرض عناوين IP الحقيقية للعملاء.

**القيود**

عند البحث عن علامات هجمات BOLA، تقوم عقد Wallarm بتحليل طلبات HTTP التي لا تحتوي على علامات أنواع الهجمات الأخرى.