# الحماية من مرتكبي الهجمات المتعددة

عندما يكون Wallarm في [وضع الحظر](../../admin-en/configure-wallarm-mode.md)، يقوم تلقائيًا بحظر جميع الطلبات التي تحتوي على بيانات ضارة، ويسمح فقط بمرور الطلبات الشرعية. يمكنك تكوين حماية إضافية لتطبيقاتك وواجهة برمجة التطبيقات الخاصة بك من خلال ضبط رد فعل Wallarm في حالة تجاوز عدد البيانات الضارة المختلفة من نفس الـIP (والذي يشار إليه غالبًا باسم **مرتكب الهجمات المتعددة**) للحد المحدد.

يمكن وضع هؤلاء المرتكبين تلقائيًا في قائمة الحظر، والتي تبدأ في حظر **جميع الطلبات الصادرة عنهم**، دون إضاعة الوقت في تحليل ما إذا كانت ضارة أم لا، فقط على أساس الحقيقة التي أنتج هذا المصدر الكثير من الطلبات الضارة في الماضي.

## التكوين

لتكوين الحماية من المصادر التي تُصدِر طلبات ضارة:

1. افتح وحدة تحكم Wallarm → **المحفزات** وافتح نافذة لإنشاء محفز.
1. اختر شرط **عدد البيانات الضارة**.
1. حدد عدد البيانات الضارة المختلفة من عنوان IP واحد لكل فترة زمنية. عند تجاوز هذا العدد خلال الفترة الزمنية المحددة، سيتم تنشيط المحفز.

    !!! المعلومات "ما لا يتم احتسابه"
        البيانات التجريبية المعتمدة على [التعبيرات النظامية المخصصة](../../user-guides/rules/regex-rule.md).

1. إذا لزم الأمر، قم بضبط واحد أو عدة فلاتر:

    * **النوع** هو [نوع](../../attacks-vulns-list.md) الهجوم المكتشف في الطلب أو نوع الثغرة الأمنية التي يوجه إليها الطلب.
    * **التطبيق** هو [التطبيق](../../user-guides/settings/applications.md) الذي يتلقى الطلب.
    * **IP** هو عنوان IP الذي يتم إرسال الطلب منه.
        
        الفلتر يتوقع عناوين IP فردية فقط، ولا يسمح بالشبكات الفرعية، والمواقع وأنواع المصادر.

    * **النطاق** هو النطاق الذي يتلقى الطلب.
    * **حالة الاستجابة** هو رمز الاستجابة المُرجع للطلب.
    * **الهدف** هو جزء من هيكل تطبيق الهجوم الموجه إليه أو الذي تم فيه اكتشاف الحادث. يمكن أن يأخذ القيم التالية: `Server`, `Client`, `Database`.

1. اختر ردود فعل المحفز:

    * [**حظر عنوان IP**](../../user-guides/ip-lists/overview.md) المصدر للطلبات الضارة وفترة الحظر.
    
        سيحظر عقدة Wallarm كلاً من الطلبات الشرعية والطلبات الضارة الصادرة عن عنوان IP المدرج في قائمة الحظر.
    
    * [**إدراج عنوان IP في القائمة الرمادية**](../../user-guides/ip-lists/overview.md) الذي يصدر طلبات ضارة وفترة الحظر.
    
        ستحظر عقدة Wallarm الطلبات الصادرة عن العناوين IP المدرجة في القائمة الرمادية فقط إذا احتوت الطلبات على علامات ضارة تتعلق بـ[التحقق من صحة الإدخال](../../about-wallarm/protecting-against-attacks.md#input-validation-attacks)، [الـ`vpatch`](../../user-guides/rules/vpatch-rule.md) أو [مخصصة](../../user-guides/rules/regex-rule.md).

    ![محفز افتراضي](../../images/user-guides/triggers/trigger-example-default.png)
        
1. احفظ المحفز وانتظر [اكتمال تزامن السحابة والعقدة](../configure-cloud-node-synchronization-en.md) (عادةً ما يستغرق 2-4 دقائق).

## المحفز المُعد مسبقًا

تتميز حسابات الشركات الجديدة بالمحفز المُعد مسبقًا (الافتراضي) **عدد البيانات الضارة** الذي يضيف عنوان IP إلى القائمة الرمادية لمدة ساعة عندما يصدر أكثر من 3 [بيانات ضارة](../../glossary-en.md#malicious-payload) مختلفة خلال ساعة واحدة.

[القائمة الرمادية](../../user-guides/ip-lists/overview.md) هي قائمة بعناوين IP المشبوهة التي تتم معالجتها بواسطة العقدة كالتالي: إذا أصدرت عنوان IP مدرج في القائمة الرمادية طلبات ضارة، تحظر العقدة هذه الطلبات مع السماح بمرور الطلبات الشرعية. على عكس القائمة الرمادية، تشير [قائمة الحظر](../../user-guides/ip-lists/overview.md) إلى عناوين IP التي لا يُسمح لها بالوصول إلى تطبيقاتك على الإطلاق - حتى أن العقدة تحظر الحركة المشروعة التي تنتجها المصادر المدرجة في قائمة الحظر. إدراج IP في القائمة الرمادية هي واحدة من الخيارات التي تهدف إلى تقليل [الإيجابيات الخاطئة](../../about-wallarm/protecting-against-attacks.md#false-positives).

يتم إصدار المحفز في أي وضع ترشيح للعقدة، بحيث سيضيف IPs إلى القائمة الرمادية بغض النظر عن وضع العقدة.

ومع ذلك، تحلل العقدة القائمة الرمادية فقط في وضع **الحظر الآمن**. لحظر الطلبات الضارة الصادرة عن عناوين IPs المدرجة في القائمة الرمادية، قم بتغيير وضع [العقدة](../../admin-en/configure-wallarm-mode.md#available-filtration-modes) إلى الحظر الآمن مع معرفة ميزاته أولاً.

لا يتم اعتبار الهجمات من نوع القوة الغاشمة، والتصفح الإجباري، وتجاوز حد الموارد، وقنبلة البيانات، أو الهجوم بالترقيع الافتراضي في هذا المحفز.

يمكنك إيقاف تشغيل المحفز الافتراضي مؤقتًا، أو تعديله أو حذفه.

## الاختبار

فيما يلي مثال على الاختبار للـ[المحفز المُعد مسبقًا](#pre-configured-trigger). يمكنك تعديله ليناسب منظور المحفز الخاص بك.

1. أرسل الطلبات التالية إلى المورد المحمي:

    ```bash
    curl 'http://localhost/?id=1%27%20UNION%20SELECT%20username,%20password%20FROM%20users--<script>prompt(1)</script>'
    curl 'http://localhost/?id=1%27%20select%20version();'
    curl http://localhost/instructions.php/etc/passwd
    ```

    هناك 4 بيانات ضارة من أنواع [SQLi](../../attacks-vulns-list.md#sql-injection)، [XSS](../../attacks-vulns-list.md#crosssite-scripting-xss)، و [التنقل في المسار](../../attacks-vulns-list.md#path-traversal).
1. افتح وحدة تحكم Wallarm → **قوائم IP** → **القائمة الرمادية** وتحقق من أن عنوان IP الذي أصدرت منه الطلبات مدرج في القائمة الرمادية لمدة ساعة.
1. افتح قسم **الهجمات** وتحقق من عرض الهجمات في القائمة:

    ![ثلاث بيانات ضارة في واجهة المستخدم](../../images/user-guides/triggers/test-3-attack-vectors-events.png)

    للبحث عن الهجمات، يمكنك استخدام علامة البحث `multiple_payloads` [علامة البحث](../../user-guides/search-and-filters/use-search.md#search-by-attack-type).