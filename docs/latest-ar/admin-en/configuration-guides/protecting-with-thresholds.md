# الحماية من مرتكبي الهجمات المتعددة

عندما يكون Wallarm في [وضع الحجب](../../admin-en/configure-wallarm-mode.md)، فإنه يحجب تلقائياً كافة الطلبات التي تحتوي على حمولات ضارة، مسمحاً بمرور الطلبات المشروعة فقط. يمكنك تكوين حماية إضافية لتطبيقاتك وواجهة برمجة التطبيقات من خلال ضبط استجابة Wallarm في حال تجاوزت الحمولات الضارة المختلفة الصادرة من نفس عنوان بروتوكول الإنترنت (والذي يُشار إليه غالبًا ب**مرتكب الهجمات المتعددة**) العتبة المحددة.

يمكن وضع هؤلاء المرتكبين تلقائياً في القائمة السوداء، والتي تبدأ بحجب **جميع الطلبات الصادرة منهم**، دون إضاعة الوقت في تحليل ما إذا كانت ضارة أم لا، استناداً فقط إلى حقيقة أن هذا المصدر أنتج الكثير من الطلبات الضارة في الماضي.

## التكوين

لتكوين الحماية من مصادر طلبات الضارة:

1. افتح وحدة تحكم Wallarm → **المُشغلات** وافتح نافذة إنشاء المُشغل.
1. حدد شرط **عدد الحمولات الضارة**.
1. حدد عدد الحمولات الضارة المختلفة من عنوان IP واحد لكل فترة زمنية. عند تجاوز هذا العدد خلال الفترة الزمنية المحددة، سيتم تفعيل المُشغل.

    !!! info "ما لا يتم احتسابه"
        الحمولات التجريبية المستندة إلى [التعبيرات العادية المخصصة](../../user-guides/rules/regex-rule.md).

1. إذا لزم الأمر، حدد واحداً أو عدة مرشحات:

    * **النوع** هو [نوع](../../attacks-vulns-list.md) الهجوم المُكتشف في الطلب أو نوع الثغرة الأمنية التي يستهدفها الطلب.
    * **التطبيق** هو [التطبيق](../../user-guides/settings/applications.md) الذي يتلقى الطلب.
    * **IP** هو عنوان IP والذي يُرسل منه الطلب.

        المرشح يتوقع عناوين IP فردية فقط، لا يسمح بالشبكات الفرعية والمواقع وأنواع المصادر.

    * **المجال** هو المجال الذي يتلقى الطلب.
    * **حالة الاستجابة** هي رمز الاستجابة الذي يُرجع للطلب.
    * **الهدف** هو جزء من هيكلية التطبيق الذي يستهدفه الهجوم أو التي يتم اكتشاف الحادث فيها. يمكن أن تأخذ القيم التالية: `Server`, `Client`, `Database`.

1. حدد استجابات المُشغل:

    * [**أدرج IP في القائمة السوداء**](../../user-guides/ip-lists/overview.md) الصادرة عن طلبات ضارة وفترة الحجب.
    
        سيقوم عقدة Wallarm بحجب كل من الطلبات المشروعة والضارة الصادرة من IP المُدرج في القائمة السوداء.
    
    * [**أدرج IP في القائمة الرمادية**](../../user-guides/ip-lists/overview.md) الصادرة عن طلبات ضارة وفترة الحجب.
    
        ستقوم عقدة Wallarm بحجب الطلبات الصادرة من IPs المدرجة في القائمة الرمادية فقط إذا كانت الطلبات تحتوي على علامات الهجوم [التحقق من صحة الإدخال](../../about-wallarm/protecting-against-attacks.md#input-validation-attacks)، [ال `vpatch`](../../user-guides/rules/vpatch-rule.md) أو [المخصصة](../../user-guides/rules/regex-rule.md).

    ![المشغل الافتراضي](../../images/user-guides/triggers/trigger-example-default.png)
        
1. احفظ المشغل وانتظر [اكتمال مزامنة السحابة والعقدة](../configure-cloud-node-synchronization-en.md) (عادةً ما يستغرق الأمر 2-4 دقائق).

## المُشغل المُعد مسبقًا

تتميز الحسابات الشركة الجديدة بمُشغل **عدد الحمولات الضارة** المعد مسبقًا (الافتراضي) الذي يدخل IP في القائمة الرمادية لمدة ساعة واحدة عندما ينشئ أكثر من 3 حمولات ضارة مختلفة خلال ساعة واحدة.

[القائمة الرمادية](../../user-guides/ip-lists/overview.md) هي قائمة بعناوين IP المشبوهة التي تعالجها العقدة على النحو التالي: إذا كانت IP المدرجة في القائمة الرمادية تنشئ طلبات ضارة، تحجب العقدة هذه الطلبات بينما تسمح بمرور الطلبات المشروعة. على عكس القائمة الرمادية، تشير [القائمة السوداء](../../user-guides/ip-lists/overview.md) إلى عناوين IP التي لا يُسمح لها بالوصول إلى التطبيقات الخاصة بك على الإطلاق - العقدة تحجب حتى الطلبات المشروعة التي تنتجها المصادر المدرجة في القائمة السوداء. إدراج IP في القائمة الرمادية هو أحد الخيارات الهادفة إلى تقليل [الإيجابيات الكاذبة](../../about-wallarm/protecting-against-attacks.md#false-positives).

يتم إطلاق المشغل في أي وضع ترشيح للعقدة، بحيث سيدخل IPs في القائمة الرمادية بغض النظر عن وضع العقدة.

مع ذلك، تحلل العقدة القائمة الرمادية في وضع **الحجب الآمن** فقط. لحجب الطلبات الضارة الصادرة عن IPs المدرجة في القائمة الرمادية، حول وضع [العقدة](../../admin-en/configure-wallarm-mode.md#available-filtration-modes) إلى وضع الحجب الآمن مع معرفة ميزاته أولاً.

الضربات مع أنواع هجوم القوة الغاشمة والتصفح القسري وتجاوز حدود الموارد وقنبلة البيانات أو هجوم التصحيح الافتراضي لا تُعتبر في هذا المشغل.

يمكنك تعطيل المُشغل الافتراضي مؤقتًا أو تعديله أو حذفه.

## الاختبار

فيما يلي مثال على اختبار [المشغل المُعد مسبقًا](#pre-configured-trigger). يمكنك تعديله لمطابقة عرض المشغل الخاص بك.

1. أرسل الطلبات التالية إلى المورد المحمي:

    ```bash
    curl 'http://localhost/?id=1%27%20UNION%20SELECT%20username,%20password%20FROM%20users--<script>prompt(1)</script>'
    curl 'http://localhost/?id=1%27%20select%20version();'
    curl http://localhost/instructions.php/etc/passwd
    ```

    هناك 4 حمولات ضارة من أنواع [SQLi](../../attacks-vulns-list.md#sql-injection)، [XSS](../../attacks-vulns-list.md#crosssite-scripting-xss)، و[Path Traversal](../../attacks-vulns-list.md#path-traversal).
1. افتح وحدة تحكم Wallarm → **قوائم IP** → **القائمة الرمادية** وتحقق من أن عنوان IP الذي تم إرسال الطلبات منه مدرج في القائمة الرمادية لمدة ساعة واحدة.
1. افتح قسم **الهجمات** وتحقق من عرض الهجمات في القائمة:

    ![ثلاث حمولات ضارة في واجهة المستخدم](../../images/user-guides/triggers/test-3-attack-vectors-events.png)

    للبحث عن الهجمات، يمكنك استخدام العلامة `multiple_payloads` [بحث](../../user-guides/search-and-filters/use-search.md#search-by-attack-type).