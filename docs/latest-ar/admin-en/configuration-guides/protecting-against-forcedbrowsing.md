# الحماية من هجمات التصفح القسري

هجمة التصفح القسري هي إحدى أنواع الهجمات التي لا يتم اكتشافها بشكل افتراضي من قبل وُلَرم، ويجب تكوين اكتشافها بالشكل الصحيح كما يصف هذا الدليل.

[التصفح القسري](../../attacks-vulns-list.md#forced-browsing) يتميز بعدد كبير من أكواد الاستجابة 404 التي يتم إعادتها إلى طلبات لعناوين URI مختلفة خلال إطار زمني محدود.

هدف هذه الهجمة هو تعداد والوصول إلى الموارد المخفية (مثل الدلائل والملفات التي تحتوي على معلومات حول مكونات التطبيق). عادةً ما يسمح نوع هجمة التصفح القسري للمهاجمين بجمع معلومات حول التطبيق ثم تنفيذ أنواع أخرى من الهجمات من خلال استغلال هذه المعلومات.

لاحظ أنه بجانب الحماية من التصفح القسري، يمكنك بطريقة مماثلة تكوين الحماية ضد [هجمات العنف الوحشي](protecting-against-bruteforce.md).

## التكوين

لتكوين الحماية ضد التصفح القسري:

1. افتح وحدة تحكم وُلَرم → **المُشغلات** وافتح نافذة إنشاء المُشغل.
1. اختر شرط **التصفح القسري**.
1. حدد العتبة لعدد أكواد الاستجابة 404 المُعادة إلى الطلبات التي لها نفس عنوان IP للطلبات.
1. إذا لزم الأمر، حدد **URI** لتفعيل المُشغل فقط للطلبات المُرسلة إلى نقاط نهائية معينة، على سبيل المثال:
    
    * حدد URI لدليل ملف الموارد.
    * إذا كنت تستخدم URIs متداخلة، فكر في [أولويات معالجة المُشغلات](#trigger-processing-priorities).
    * إذا لم يتم تحديد URI، يتم تفعيل المُشغل في أي نقطة نهاية بعدد طلبات يتجاوز العتبة.

    يمكن تكوين URI من خلال [بناء الٌري UR](../../user-guides/rules/rules.md#uri-constructor) أو [نموذج التعديل المتقدم](../../user-guides/rules/rules.md#advanced-edit-form) في نافذة إنشاء المُشغل.

1. إذا لزم الأمر، حدد مرشحات المُشغل الأخرى:

    * **التطبيق** الذي تُوجه إليه الطلبات.
    * واحد أو أكثر **IP** الذي تُرسل منه الطلبات.

1. اختر ردود فعل المُشغل:

    * **وسم كتصفح قسري**. الطلبات المستلمة بعد تجاوز العتبة سيتم وسمها كهجمة تصفح قسري وعرضها في قسم **الهجمات** في وحدة تحكم وُلَرم.
    * **إضافة عنوان IP إلى القائمة السوداء** والفترة لحظر عنوان IP لإضافة عناوين IP لمصادر الطلبات الخبيثة إلى [القائمة السوداء](../../user-guides/ip-lists/overview.md). سيقوم عقدة وُلَرم بحظر جميع الطلبات الصادرة من عنوان IP في القائمة السوداء بعد تجاوز العتبة.
    * **إضافة عنوان IP إلى القائمة الرمادية** والفترة ل[إضافة](../../user-guides/ip-lists/overview.md) عناوين IP لمصادر الطلبات الخبيثة إلى القائمة الرمادية. ستقوم عقدة وُلَرم بحظر الطلبات الصادرة من IPs القائمة الرمادية فقط إذا تحتوى الطلبات على علامات [التحقق من صحة الإدخال](../../about-wallarm/protecting-against-attacks.md#input-validation-attacks)، [الٌ`vpatch`](../../user-guides/rules/vpatch-rule.md) أو علامات الهجمة [المخصصة](../../user-guides/rules/regex-rule.md). هجمات العنف الوحشي الصادرة من IPs القائمة الرمادية لا يتم حظرها.

    ![مثال على مُشغل التصفح القسري](../../images/user-guides/triggers/trigger-example5.png)

1. احفظ المُشغل وانتظر [اكتمال مزامنة السحابة والعقدة](../configure-cloud-node-synchronization-en.md) (عادةً ما يستغرق ذلك 2-4 دقائق).

يمكنك تكوين عدة مُشغلات لحماية العنف الوحشي.

## الاختبار

1. أرسل عددًا من الطلبات يتجاوز العتبة المُكونة إلى URI المحمي. على سبيل المثال، 31 طلبًا إلى `https://example.com/config.json` (يطابق `https://example.com/**.**`):

    ```bash
    for (( i=0 ; $i<32 ; i++ )) ; do curl https://example.com/config.json ; done
    ```
2. إذا كان رد فعل المُشغل هو **إضافة عنوان IP إلى القائمة السوداء**، افتح وحدة تحكم وُلَرم → **قوائم IP** → **القائمة السوداء** وتحقق من أن عنوان IP للمصدر محظور.

    إذا كان رد فعل المُشغل هو **إضافة عنوان IP إلى القائمة الرمادية**، تحقق من قسم **قوائم IP** → **القائمة الرمادية** في وحدة تحكم وُلَرم.
3. افتح قسم **الهجمات** وتحقق من عرض الطلبات في القائمة كهجمة للتصفح القسري.

    ![هجمة التصفح القسري في الواجهة](../../images/user-guides/events/forced-browsing-attack.png)

    يُوافق عدد الطلبات المعروضة عدد الطلبات المُرسلة بعد تجاوز عتبة المُشغل ([مزيد من التفاصيل عن اكتشاف الهجمات السلوكية](../../attacks-vulns-list.md#behavioral-attacks)). إذا كان هذا الرقم أكبر من 5، يتم تطبيق أخذ العينات للطلب وتُعرض تفاصيل الطلب فقط لأول 5 ضربات ([مزيد من التفاصيل عن أخذ عينات الطلبات](../../user-guides/events/analyze-attack.md#sampling-of-hits)).

    للبحث عن هجمات التصفح القسري، يمكنك استخدام عامل التصفية `dirbust`. جميع عوامل التصفية موصوفة في [التعليمات حول استخدام البحث](../../user-guides/search-and-filters/use-search.md).

## أولويات معالجة المُشغلات
            
--8<-- "../include/trigger-processing-priorities.md"

## المتطلبات والقيود

**المتطلبات**

لحماية الموارد من هجمات التصفح القسري، تُطلب عناوين IP الحقيقية للعملاء. إذا تم نشر العقدة الفلترة خلف خادم وكيل أو موزع الحمل، [قُم بتكوين](../using-proxy-or-balancer-en.md) عرض عناوين IP الحقيقية للعملاء.

**القيود**

عند البحث عن علامات هجمة التصفح القسري، تحلل عقد وُلَرم طلبات HTTP التي لا تحتوي على علامات لأنواع أخرى من الهجمات فقط.