# الحماية ضد هجمات التصفح القسري

هجمة التصفح القسري هي واحدة من أنواع الهجمات التي لا تكتشفها Wallarm بشكل افتراضي، يجب أن يتم تكوين اكتشافها كما يصف هذا الدليل.

[التصفح القسري](../../attacks-vulns-list.md#forced-browsing) تتميز بعدد كبير من أكواد الاستجابة 404 التي تُرجع لطلبات إلى URIs مختلفة خلال إطار زمني محدود.

الهدف من هذه الهجوم هو تعداد والوصول إلى المصادر المخفية (مثل الأدلة والملفات التي تحتوي على معلومات حول مكونات التطبيق). عادة ما تسمح هجمات التصفح القسري للمهاجمين بجمع معلومات حول التطبيق ثم تنفيذ أنواع أخرى من الهجمات باستغلال هذه المعلومات.

لاحظ أنه بجانب الحماية ضد التصفح القسري، بطريقة مماثلة، يمكنك تكوين الحماية ضد [هجمات القوة العمياء](protecting-against-bruteforce.md).

## التكوين

لتكوين الحماية ضد التصفح القسري:

1. افتح واجهة Wallarm → **المحفزات** وافتح نافذة إنشاء محفز.
1. اختر شرط **التصفح القسري**.
1. حدد الحد الأقصى لعدد أكواد الاستجابة 404 التي تُرجع إلى الطلبات التي لها نفس عنوان IP الأصلي للطلبات.
1. إذا لزم الأمر، حدد **URI** لتنشيط المحفز فقط للطلبات المرسلة إلى نقاط نهاية محددة، على سبيل المثال:
    
    * حدد URI لدليل ملف المصدر.
    * إذا كنت تستخدم URIs متداخلة، فكر في [أولويات معالجة المحفز](#trigger-processing-priorities).
    * إذا لم يتم تحديد URI، سيتم تنشيط المحفز في أي نقطة نهاية مع تجاوز عدد الطلبات للحد.

    يمكن تكوين URI من خلال [مُنشئ URI](../../user-guides/rules/rules.md#uri-constructor) أو [نموذج التحرير المتقدم](../../user-guides/rules/rules.md#advanced-edit-form) في نافذة إنشاء المحفز.

1. إذا لزم الأمر، قم بتعيين فلاتر المحفز الأخرى:

    * **التطبيق** الذي يُوجه إليه الطلبات.
    * عنوان واحد أو أكثر **IP** تُرسل منه الطلبات.

1. اختر ردود فعل المحفز:

    * **وسم كتصفح قسري**. ستُوسم الطلبات التي تم استلامها بعد تجاوز الحد كهجمة تصفح قسري ويتم عرضها في قسم **الهجمات** في واجهة Wallarm.
    * **قائمة الرفض لعنوان IP** والفترة لحظر عنوان IP لإضافة عناوين IP لمصادر الطلبات الضارة إلى [قائمة الرفض](../../user-guides/ip-lists/overview.md). سيحظر العقدة Wallarm جميع الطلبات الصادرة من عناوين IP المدرجة بعد تجاوز الحد.
    * **قائمة التحقق لعنوان IP** والفترة لإضافة عناوين IP لمصادر الطلبات الضارة إلى [قائمة التحقق](../../user-guides/ip-lists/overview.md). ستحظر العقدة Wallarm الطلبات الصادرة من عناوين IPs في قائمة التحقق فقط إذا احتوت الطلبات على علامات [التحقق من الصحة](../../about-wallarm/protecting-against-attacks.md#input-validation-attacks)، [`vpatch`](../../user-guides/rules/vpatch-rule.md) أو هجمات [مخصصة](../../user-guides/rules/regex-rule.md). لا يتم حظر هجمات القوة العمياء الصادرة من عناوين IPs في قائمة التحقق.

    ![مثال على محفز التصفح القسري](../../images/user-guides/triggers/trigger-example5.png)

1. احفظ المحفز وانتظر [اكتمال تزامن السحابة والعقدة](../configure-cloud-node-synchronization-en.md) (عادة ما يستغرق الأمر من 2-4 دقائق).

يمكنك تكوين عدة محفزات لحماية القوة العمياء.

## الاختبار

1. أرسل عددًا من الطلبات يتجاوز الحد المكون إلى URI المحمية. على سبيل المثال، 31 طلبات إلى `https://example.com/config.json` (يطابق `https://example.com/**.**`):

    ```bash
    for (( i=0 ; $i<32 ; i++ )) ; do curl https://example.com/config.json ; done
    ```
2. إذا كانت رد فعل المحفز **قائمة الرفض لعنوان IP**، افتح واجهة Wallarm → **قوائم IP** → **قائمة الرفض** وتحقق من أن عنوان IP المصدر محظور.

    إذا كانت رد فعل المحفز **قائمة التحقق لعنوان IP**، تحقق من قسم **قوائم IP** → **قائمة التحقق** في واجهة Wallarm.
3. افتح قسم **الهجمات** وتحقق من أن الطلبات معروضة في القائمة كهجمة تصفح قسري.

    ![هجمة التصفح القسري في الواجهة](../../images/user-guides/events/forced-browsing-attack.png)

    عدد الطلبات المعروضة يتوافق مع عدد الطلبات المرسلة بعد تجاوز عتبة المحفز ([المزيد من التفاصيل حول اكتشاف الهجمات السلوكية](../../attacks-vulns-list.md#behavioral-attacks)). إذا كان هذا العدد أكبر من 5، يتم تطبيق عينة الطلب ويتم عرض تفاصيل الطلب فقط لأول 5 ضربات ([المزيد من التفاصيل حول عينات الطلبات](../../user-guides/events/analyze-attack.md#sampling-of-hits)).

    للبحث عن هجمات التصفح القسري، يمكنك استخدام الفلتر `dirbust`. جميع الفلاتر موضحة في [التعليمات حول استخدام البحث](../../user-guides/search-and-filters/use-search.md).

## أولويات معالجة المحفز
            
--8<-- "../include/trigger-processing-priorities.md"

## المتطلبات والقيود

**المتطلبات**

لحماية الموارد من هجمات التصفح القسري، تتطلب عناوين IP الحقيقية للعملاء. إذا تم نشر العقدة الفلترة خلف خادم وكيل أو موازن الحمل، [قم بتكوين](../using-proxy-or-balancer-en.md) عرض عناوين IP الحقيقية للعملاء.

**القيود**

عند البحث عن علامات هجمة التصفح القسري، تقوم عقد Wallarm بتحليل طلبات HTTP التي لا تحتوي على علامات أنواع هجمات أخرى فقط.