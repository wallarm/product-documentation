# الوصول إلى واجهة برمجة تطبيقات Wallarm عبر البروكسي

تشرح هذه التعليمات الخطوات لتكوين الوصول إلى واجهة برمجة تطبيقات Wallarm عبر خادم البروكسي.

* `https://api.wallarm.com/` للسحابة الأوروبية
* `https://us1.api.wallarm.com/` للسحابة الأمريكية

لتكوين الوصول، برجاء تعيين قيم جديدة لمتغيرات البيئة التي تحدد خادم البروكسي المستخدم في ملف `/etc/environment`:

* `https_proxy` لتحديد بروكسي لبروتوكول HTTPS
* `http_proxy` لتحديد بروكسي لبروتوكول HTTP
* `no_proxy` لتحديد قائمة الموارد التي لا يجب استخدام البروكسي لها

## قيم https_proxy و http_proxy

عيّن قيم السلسلة `<scheme>://<proxy_user>:<proxy_pass>@<host>:<port>` إلى متغيرات `https_proxy` و `http_proxy`:

* `<scheme>` يحدد البروتوكول المستخدم. يجب أن يطابق البروتوكول الذي يقوم متغير البيئة الحالي بإعداد البروكسي له
* `<proxy_user>` يحدد اسم المستخدم لتفويض البروكسي
* `<proxy_pass>` يحدد كلمة المرور لتفويض البروكسي
* `<host>` يحدد مضيف خادم البروكسي
* `<port>` يحدد منفذ خادم البروكسي

## قيمة no_proxy

لمتغير `no_proxy`, عيّن مصفوفة من عناوين IP و/أو نطاقات الموارد التي لا يجب استخدام البروكسي لها:

* `127.0.0.1`, `127.0.0.8`, `127.0.0.9` و `localhost` لتشغيل عقدة Wallarm بشكل صحيح
* عناوين إضافية في الصيغة: `"<res_1>, <res_2>, <res_3>, <res_4>, ..."` حيث `<res_1>`, `<res_2>`, `<res_3>`, و `<res_4>` هي عناوين IP و/أو نطاقات

## مثال على الملف /etc/environment

مثال على الملف `/etc/environment` أدناه يوضح التكوين التالي:

* الطلبات HTTPS و HTTP يتم توجيهها إلى المضيف `1.2.3.4` بالمنفذ `1234`, باستخدام اسم المستخدم `admin` وكلمة المرور `01234` للتفويض على خادم البروكسي.
* تعطيل التوجيه للطلبات المرسلة إلى `127.0.0.1`, `127.0.0.8`, `127.0.0.9`, و `localhost`.

```bash
https_proxy=http://admin:01234@1.2.3.4:1234
http_proxy=http://admin:01234@1.2.3.4:1234
no_proxy="127.0.0.1, 127.0.0.8, 127.0.0.9, localhost"
```

## تشغيل السكريبت الكل في واحد

عند تثبيت عقدة التصفية بالمثبت [الكل في واحد](../../installation/nginx/all-in-one.md)، تأكد من إلحاق علامة `--preserve-env=https_proxy,no_proxy` بالأمر الذي ينفذ السكريبت، مثلاً:

```
sudo env WALLARM_LABELS='group=<GROUP>' sh wallarm-<VERSION>.<ARCH>-glibc.sh --preserve-env=https_proxy,no_proxy
```

هذا يضمن تطبيق إعدادات البروكسي (`https_proxy`, `no_proxy`) بشكل صحيح أثناء عملية التثبيت.