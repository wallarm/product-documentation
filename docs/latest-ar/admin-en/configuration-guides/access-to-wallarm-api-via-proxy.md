# الوصول إلى واجهة برمجة تطبيقات Wallarm عبر البروكسي

توصف هذه التعليمات الخطوات لتهيئة الوصول إلى واجهة برمجة تطبيقات Wallarm عبر خادم البروكسي.

* `https://api.wallarm.com/` للسحابة الأوروبية
* `https://us1.api.wallarm.com/` للسحابة الأمريكية

لتهيئة الوصول، الرجاء تخصيص قيم جديدة للمتغيرات البيئية التي تحدد خادم البروكسي المستخدم في ملف `/etc/environment`:

* `https_proxy` لتعريف بروكسي لبروتوكول HTTPS
* `http_proxy` لتعريف بروكسي لبروتوكول HTTP
* `no_proxy` لتعريف قائمة الموارد التي ينبغي عدم استخدام البروكسي لها

## قيم https_proxy و http_proxy

عيِّن القيم النصية `<scheme>://<proxy_user>:<proxy_pass>@<host>:<port>` لمتغيرات `https_proxy` و`http_proxy`:

* `<scheme>` يحدد البروتوكول المستخدم. يجب أن يتطابق مع البروتوكول الذي يعمل المتغير البيئي الحالي على إعداد البروكسي له
* `<proxy_user>` يحدد اسم المستخدم للترخيص بالبروكسي
* `<proxy_pass>` يحدد كلمة المرور للترخيص بالبروكسي
* `<host>` يحدد مضيف خادم البروكسي
* `<port>` يحدد منفذ خادم البروكسي

## قيمة no_proxy

لمتغير `no_proxy`، عيِّن مصفوفة عناوين الـ IP و/أو النطاقات التي ينبغي عدم استخدام البروكسي لها:

* `127.0.0.1`، `127.0.0.8`، `127.0.0.9` و `localhost` لتشغيل عقدة Wallarm بشكل صحيح
* عناوين إضافية في التنسيق: `"<res_1>, <res_2>, <res_3>, <res_4>, ..."` حيث `<res_1>`، `<res_2>`، `<res_3>`، و `<res_4>` هي عناوين الـ IP و/أو النطاقات

## مثال على ملف /etc/environment

يوضح مثال الملف `/etc/environment` أدناه التكوين التالي:

* يتم توجيه طلبات HTTPS وHTTP إلى المضيف `1.2.3.4` بالمنفذ `1234`، باستخدام اسم المستخدم `admin` وكلمة المرور `01234` للترخيص في خادم البروكسي.
* تعطيل التوجيه عبر البروكسي للطلبات المرسلة إلى `127.0.0.1`، `127.0.0.8`، `127.0.0.9`، و `localhost`.

```bash
https_proxy=http://admin:01234@1.2.3.4:1234
http_proxy=http://admin:01234@1.2.3.4:1234
no_proxy="127.0.0.1, 127.0.0.8, 127.0.0.9, localhost"
```

## تشغيل سكربت الكل في واحد

عند تثبيت عقدة فلترة بواسطة المثبِّت [الكل في واحد](../../installation/nginx/all-in-one.md)، تأكد من إضافة علم `--preserve-env=https_proxy,no_proxy` إلى الأمر الذي ينفذ السكربت، على سبيل المثال:

```
sudo env WALLARM_LABELS='group=<GROUP>' sh wallarm-<VERSION>.<ARCH>-glibc.sh --preserve-env=https_proxy,no_proxy
```

هذا يضمن تطبيق إعدادات البروكسي (`https_proxy`, `no_proxy`) بشكل صحيح خلال عملية التثبيت.