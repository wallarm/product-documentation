[img-rules-overview]:       ../../images/user-guides/rules/rules-overview.png
[img-view-rules]:           ../../images/user-guides/rules/view-rules.png

# アプリケーションプロファイルルールの検査

アプリケーション構造のルールを表示するには、Wallarm コンソールの**Rules**セクションに移動します。このセクションには、すでに知られているブランチとエンドポイントが表示されています。

![!Rules tab overview][img-rules-overview]

システムは、ルールをブランチごとに自動的にグループ化して、共通の条件を強調し、ツリー構造を構築します。その結果として、ブランチに子ブランチが存在する場合があります。ネストされたブランチを表示または非表示にするには、ブランチの説明の左側にある青い円をクリックします。

ブランチの説明で2つのアスタリスク `**` は、ネストされたパスの任意の数を示しています。たとえば、ブランチ `/ ** / * .php` には、`/index.php` と `/app/admin/install.php` の両方が含まれます

青い円のサイズは、ネストされたブランチの相対的な数を示しています。色は、ブランチとそのサブブランチ内のルールの相対的な量を示しています。各ネストレベルでは、円のサイズと色は互いに独立しています。

ブランチの説明の右側には、オレンジ色の数字が表示される場合があります。これは、そのブランチでのルールの数（ネストされたルールではなく直接の子ルール）を示しています。数字が表示されていない場合、そのブランチは「仮想」であり、同様のサブブランチをグループ化するためにのみ使用されます。

ユーザーが使用できないルールがあるブランチは（権限モデルによる）、自動的に非表示になります。



## ルールの表示

各ブランチでは、ユーザーはそれに添付されたルールのリストを確認できます。ルールのリストが含まれるページに切り替えるには、対応するブランチの説明をクリックします。

![!Viewing branch rules][img-view-rules]

ブランチ内のルールは、*point*フィールドでグループ化されます。リクエスト全体に影響するルールは、個々のパラメーターではなく、1行にまとめられます。全リストを表示するには、その行をクリックします。

各ルールに対して、システムは最終更新時刻、数量、タイプ、およびポイントを表示します。

## 既定のルール

エンドポイントにリンクされていない指定されたアクションを持つルールを作成できます。これらは **デフォルトルール** と呼ばれます。このようなルールは、すべてのエンドポイントに適用されます。

* デフォルトルールを作成するには、[標準手順](add-rule.md)に従ってURIを空白のままにします。 新しいルールがエンドポイントにリンクされずに作成されます。
* 作成されたデフォルトルールのリストを表示するには、**デフォルトルール**ボタンをクリックします。

!!! info "トラフィックフィルタリングモードデフォルトルール"
    Wallarmは、[一般フィルタリングモード](../../admin-en/configure-wallarm-mode.md#setting-up-the-general-filtration-rule-in-wallarm-console)の設定に基づいて、すべてのクライアントの`Set filtration mode`デフォルトルールを自動的に[作成](wallarm-mode-rule.md#default-instance-of-rule)します。

デフォルトのルールは、すべてのブランチで[継承](#distinct-and-inherited-rules)されます。

## 明確なルールと継承されたルール

ルールは、ルールブランチを下に継承されます。原則：

* すべてのブランチが[既定](#default-rules)のルールを継承します。
* ブランチ内の子エンドポイントは親からルールを継承します。
* 明確は継承よりも優先されます。
* 直接指定されたものは、[regex](add-rule.md#condition-type-regex)よりも優先されます。
* ケース[センシティブ](add-rule.md#condition-type-equal)が、[インセンシティブ](add-rule.md#condition-type-iequal-aa) よりも優先されます。

ルールブランチでの作業方法の詳細をいくつか示します。

* エンドポイントを展開するには、青い円をクリックします。
* 明確なルールがないエンドポイントは灰色になり、クリックできなくなります。

    ![!Branch of endpoints](../../images/user-guides/rules/rules-branch.png)

* エンドポイントのルールを表示するには、それをクリックします。最初に、このエンドポイントに対する明確なルールが表示されます。
* 特定のエンドポイントのルールリストを表示している場合は、**Distinct and inherited rules**をクリックして継承されたものも表示させます。継承されたルールは、明確なルールとともに表示されますが、明確なものに比べて灰色に表示されます。

    ![!Distinct and inherited rules for endpoint][img-view-rules]

## ルールを取得するためのAPI呼び出し

カスタムルールを取得するには、WallarmコンソールUIを使用する他に、[Wallarm APIを直接呼び出す](../../api/overview.md)こともできます。以下は、対応するAPI呼び出しの例です。

**すべての設定済みルールを取得**

--8<-- "../include-ja/api-request-examples/get-all-configured-rules.md"

**すべてのルールの条件を取得**

--8<-- "../include-ja/api-request-examples/get-conditions.md"

**特定の条件に添付されたルールを取得**

特定の条件を指定するには、そのIDを使用します。これは、すべてのルールの条件をリクエストするときに取得できます。

--8<-- "../include-ja/api-request-examples/get-rules-by-condition-id.md"
