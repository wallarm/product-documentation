					# Wallarmクラウドがダウンしています

Wallarmクラウドがダウンした場合でも、Wallarmノードはいくつかの制約がありますが、攻撃の軽減を続けます。詳細はこのトラブルシューティングガイドをご覧ください。

## Wallarmクラウドがダウンしている場合、Wallarmノードはどのように動作しますか？

Wallarmクラウドは非常に安定しており、スケーラブルなサービスです。さらに、お客さまの会社のアカウントデータはすべて[バックアップ](#wallarmはどのようにしてクラウドデータを紛失から守るのか)により保護されています。

しかし、稀にWallarmクラウドが一時的にダウンする（たとえば、メンテナンスのために一時停止する）場合、Wallarmノードはいくつかの制限がありますが、動作を続けます。

!!! info "Wallarmクラウドのステータスをチェックする"
  Wallarmクラウドのステータスを確認するには、[status.wallarm.com](https://status.wallarm.com/)をご覧ください。常に情報を得るために、更新を購読してください。

続けて動作するもの：

* ノードとクラウド間の最後の成功した[同期](../admin-en/configure-cloud-node-synchronization-en.ja.md)中にノードにアップロードされたルールを使った設定[モード](../admin-en/configure-wallarm-mode.ja.md#利用可能なフィルタリングモード)でのトラフィック処理。ノードは次の要素の最新バージョンがスケジュールに従ってクラウドからアップロードされ、ノード上にローカルに保存されるため、作業を続けることができます：

    * [カスタムルールセット](../user-guides/rules/compiling.ja.md)
    * [proton.db](../about-wallarm/protecting-against-attacks.ja.md#library-libproton)

* [IPリスト](../user-guides/ip-lists/overview.ja.md)もノードにアップロードされ、それ自体に保存されます。アップロードされたアドレスは引き続き処理されますが、期限付きでのみです。

    これらの日付/時刻は、クラウドが復元されて同期されるまで更新されず、新規/削除されたアドレスもクラウドの復元/同期までありません。

    [ブルートフォース攻撃](../admin-en/configuration-guides/protecting-against-bruteforce.ja.md)からの保護を停止するために、リスト内の一部のIPアドレスの有効期限が切れることに注意してください。

動作を停止するもの：

* ノードは検出された攻撃と脆弱性に関するデータを収集しますが、そのデータをクラウドに送信することはできません。お客様のノードの[postanalyticsモジュール](../admin-en/installation-postanalytics-en.ja.md)は、クラウドへの送信前に収集したデータを一時的に保存するためのインメモリストレージ（Tarantool）を持っています。クラウドが復元されると、バッファ化されたデータがクラウドに送信されます。

    !!! warning "ノードのインメモリストレージの制限"
        バッファのサイズは[限定的](../admin-en/configuration-guides/allocate-resources-for-node.ja.md#tarantool)であり、超過すると古いデータが削除されます。したがって、クラウドがダウンしていた時間とその間に収集された情報の量によって、クラウドの復元後にWallarmコンソールで一部のデータのみが得られる状況が発生する可能性があります。

* ノードは処理されたトラフィックの[指標](../admin-en/monitoring/intro.ja.md)を収集しますが、それをクラウドに送信することはできません。
* [露出資産](../user-guides/scanner.ja.md)と[一般的な脆弱性](../user-guides/vulnerabilities.ja.md)のスキャンが停止します。
* [トリガー](../user-guides/triggers/triggers.ja.md)が動作を停止し、その結果として：
    * [IPリスト](../user-guides/ip-lists/overview.ja.md)の更新が停止します。
    * [トリガーベースの通知](../user-guides/triggers/triggers.ja.md)は表示されません。
* [APIインベントリの発見](../about-wallarm/api-discovery.ja.md)は機能しません。
* [アクティブな脅威の検証](../about-wallarm/detecting-vulnerabilities.ja.md#アクティブな脅威の検証)が停止します。
* [ブルートフォース攻撃](../admin-en/configuration-guides/protecting-against-bruteforce.ja.md)は検出されません。
* インテグレーションが停止し、以下が含まれます：
    * 即時およびメールによる[通知](../user-guides/settings/integrations/integrations-intro.ja.md)が表示されません。
    * レポートの作成が停止します。
* Wallarmコンソールへのアクセスがなくなります。
* [Wallarm API](../api/overview.ja.md)は応答しません。

上記のように全体がダウン状態になることがありますが、特定のサービスだけが一時的にアクセスできない場合もあり、他のサービスは動作を続けます。このような場合、[status.wallarm.com](https://status.wallarm.com/)サービスが該当する情報を提供します。

## クラウドが復元した後に何が起こりますか？

クラウドが復元された後：

* Wallarmコンソールへのアクセスが復元されます。
* ノードはバッファリングされた情報をクラウドに送信します（上記の制限を考慮してください）。
* トリガーは、通知を送信し、IPを更新することによって新しいデータに反応します。
* IPに変更があった場合、それらは次の同期中にノードに送信されます。
* [未完成のカスタムルールセット](#wallarmクラウドがダウンする前にwallarmコンソールに保存された設定をノードが取得しないケースはありますか)ビルドがあった場合、それは再開されます。
* クラウドとフィルタリングノードは通常通りスケジュールに従って同期します。

## Wallarmクラウドがダウンする前にWallarmコンソールに保存された設定をノードが取得しないケースはありますか？

はい、可能です。たとえば、[同期](../admin-en/configure-cloud-node-synchronization-en.ja.md)間隔が3分であるとします：

1. カスタムルールセットの最後のビルドがクラウドで21分前に終了し、それが20分前にノードにアップロードされました。
2. 次の6回の同期では、新しいものが何もなかったので、クラウドから何も取得しませんでした。
3. その後、クラウド上でルールが変更され、新しいビルドが開始されました - ビルドが終了するまでに4分必要でしたが、2分でクラウドがダウンしました。
4. ノードは完了したビルドのみを取得するため、2分間の同期ではノードにアップロードするためのものは何も得られません。
5. もう1分後、ノードが新しい同期要求で来ますが、クラウドは応答しません。
6. ノードは24分前のカスタムルールセットに従ってフィルタリングを続け、この期間はクラウドがダウンしている間に増大します。

## Wallarmはどのようにしてクラウドデータを紛失から守るのか？

Wallarmクラウドは、Wallarmコンソールから提供されるユーザーの**すべてのデータ**およびノードからアップロードされるデータを保存します。上記のように、Wallarmクラウドが一時的にダウンすることは極めてまれです。しかし、それが起こる場合でも、ダウン状態が保存されたデータに影響を与える確率は非常に低いです。つまり、復元後すぐにすべてのデータとともに作業を再開できます。

Wallarmクラウドの実際のデータを保存しているハードドライブが破壊されるという低確率の事態に対処するために、Wallarmは自動的にバックアップを作成し、必要に応じてそれから復元します。

* RPO: バックアップは24時間ごとに作成されます
* RTO: システムは48時間以内に再度利用可能になります
* 最新の14回分のバックアップが保管されます

!!! info "RPO/RTO保護と可用性パラメータ"
    * **RPO（リカバリーポイントオブジェクティブ）**は、データバックアップの頻度を決定するために使用されます：データが失われる可能性のある最大時間を定義します。
    * **RTO（リカバリータイムオブジェクティブ）**は、事業が災害後に許容可能なサービスレベルでそのプロセスを復元するのに必要な実時間の量です。これによって、中断に関連する許容できない結果を避けることができます。

Wallarmのディザスタリカバリ（DR）計画やお客様の会社にとってのその特性についての詳細は、[Wallarmサポート](mailto:support@wallarm.com)にお問い合わせください。