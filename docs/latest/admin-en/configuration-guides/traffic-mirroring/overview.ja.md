# ミラーリングされたトラフィックのフィルタリング

Wallarmノードのデプロイ方法の1つは、ミラーリングされたHTTPトラフィックのフィルタリングに基づく非同期デプロイメントです。 この記事では、このデプロイ実装のための必要な設定といくつかの例をご紹介します。

トラフィックミラーリングにより、オリジナルの入力トラフィックが複数のバックエンドに並行して送信されます。 Wallarmノードを追加のバックエンドとしてインストールすることで、クライアントに影響を与えることなくトラフィックミラー（コピー）のフィルタリングを実行できます - 任意の入力要求は、宛先のサーバーに届きます。

ミラーリングオプションが有効なトラフィックフローダイアグラムの例は以下のとおりです：

![!ミラースキーム](../../../images/waf-installation/aws/terraform/wallarm-for-mirrored-traffic.png)

## アプローチのユースケース

ミラーリングされたトラフィックをフィルタリングするためにWallarmノードをインストールすると、次のような利点があります。

* セキュリティソリューションがアプリケーションのパフォーマンスに影響を与えないことを確認します。
* 本番システムでモジュールを実行する前に、トラフィックのコピーでWallarmソリューションをトレーニングします。

## ミラーリングされたトラフィックのフィルタリングの制限事項

デプロイ方法の安全性にもかかわらず、いくつかの制限があります。

* ミラーリングされたトラフィックのフィルタリングは、NGINXベースのWallarmノードのみがサポートしています。
* Wallarmノードは、実際のトラフィックフローに関係なくトラフィック分析が進行しているため、悪意のあるリクエストを即座にブロックしません。
* Wallarmは、ノードが受信リクエストのコピーしか持っておらず、サーバーの応答がミラーリングされないため、アプリケーションとAPIの[脆弱性] (../../../about-wallarm/detecting-vulnerabilities.md) を検出しません。
* ソリューションには、追加のコンポーネントが必要です - トラフィックミラーリングまたはそれに類似したツール（例：NGINX、Envoy、Istio、Traefik、カスタムKongモジュールなど）を提供するウェブサーバー。

## 設定

ミラーリングされたトラフィックのフィルタリングにWallarmを実装するには：

1. 入力トラフィックを追加のバックエンドにミラーリングするようにウェブサーバーを設定します。
1. Wallarmノードを追加のバックエンドとして[インストール] (../../../installation/supported-deployment-options.md)し、ミラーリングされたトラフィックをフィルタリングするように設定します。

トラフィックミラーリングは、多くのウェブサーバーでサポートされています。以下のリンクの中には、最も人気のあるものの**サンプル設定**が含まれています。

* [NGINX](nginx-example.md)
* [Traefik](traefik-example.md)
* [Envoy](envoy-example.md)
* [Istio](istio-example.md)