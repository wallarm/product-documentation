# Running Attack Replays on Staging <a href="../../../about-wallarm/subscription-plans/#subscription-plans"><img src="../../../images/api-security-tag.svg" style="border: none;"></a>

Wallarm employs a unique approach to detect security vulnerabilities known as [**Active Threat Verification**](overview.md) which transforms attackers into penetration testers. After analyzing an attacker's request, it crafts and tests potential vulnerability‑exposing requests on your application. While it normally tests on the original request address, you can redirect these tests to a staging environment. This article guides you on how to set that up.

Testing on the production environment using real production data can pose risks, such as causing downtime due to extensive testing or compromising real user data. Testing on a staging environment eliminates these risks. This approach lets you test vulnerabilities using production-like data without the associated issues. In addition to that, it ensures the safety of your live systems while also identifying vulnerabilities during development.

## Configuring a rule to change the attack replay address

The **Rewrite attack before active verification** rule type lets you modify the attack replay address as follows:

* Replace the original `HOST` header value with an address of another application instance, such as a staging or testing setup.
* Replace the original request path with a test or staging environment or with a target server endpoint.

To change both the `HOST` header value and the original request path, you will need to set up two distinct **Rewrite attack before active verification** rules.

1. Proceed to Wallarm Console → **Rules** → create the rule **Rewrite attack before active verification**.
1. Fill in the rule creation form following the instructions:

      * **Condition** [describes](../../user-guides/rules/add-rule.md#branch-description) the endpoints to apply the rule to.
      * **Rules** sets the new value for the parameter selected in the **Part of request** field. A set value will be used when replaying the attack.

        The value must be decoded and set using the [template language Liquid](https://shopify.github.io/liquid/) as follows: placed in double curly braces `{{}}` and single quotes `''`. For example: `{{'example.com'}}`.

        To replace the path of the original request (`uri`), you should pass the full value of the new path.

      * **Part of request** points to the original request element that should be modified before replaying the attack.

        !!! warning "Possible values of the field **Part of request**"
            Possible values of the **Part of request** field are `header` (request header) and `uri` (request path).

1. Wait for the [rule compilation to complete](../../user-guides/rules/compiling.md).

## Rule example

For running attacks initially aimed at `example.com` on the test environment `example-test.env.srv.loc`:

![!Example of the rule modyfying HOST](../../images/user-guides/rules/rewrite-request-example-host.png)

The format of the address is `{{'example-test.env.srv.loc'}}`.
