[al-brute-force-attack]:      ../../attacks-vulns-list.md#bruteforce-attack
[al-forced-browsing]:         ../../attacks-vulns-list.md#forced-browsing

# Visão geral da Verificação de Ameaça Ativa <a href="../../../about-wallarm/subscription-plans/#subscription-plans"><img src="../../../images/api-security-tag.svg" style="border: none;"></a>

A Verificação de Ameaças Ativas do Wallarm transforma invasores em seus próprios testadores de penetração. Analisa tentativas de ataque iniciais e, então, explora outras maneiras pelas quais o mesmo ataque pode ser explorado. Isso expõe pontos fracos em seu ambiente que nem mesmo os invasores originais descobriram.

As capacidades de Verificação de Ameaças Ativas incluem:

* **Teste em tempo real**: usa dados de ataque ao vivo para identificar pontos fracos atuais e potenciais futuros, mantendo você um passo à frente dos hackers.
* **Simulação segura e inteligente**: omite detalhes de autenticação sensíveis e remove códigos prejudiciais nos testes. Simula técnicas de ataque para a máxima segurança, sem arriscar danos reais.
* **Testes seguros não produtivos**: permite que você [execute verificações de vulnerabilidade em uma configuração de teste ou desenvolvimento](running-test-on-staging.md) usando dados de produção reais, mas sem riscos como sobrecarga do sistema ou exposição de dados.

## Como funciona

O módulo de Verificação de Ameaças Ativas opera na Nuvem Wallarm. Inicialmente, o módulo coleta informações detalhadas sobre solicitações maliciosas que o [nó de filtragem Wallarm](../../installation/supported-deployment-options.md) detectou e enviou para a Nuvem. Aproveitando os dados adquiridos, o módulo gera dinamicamente um conjunto de aproximadamente 100-150 solicitações de teste. Esses pedidos de teste visam os mesmos tipos de vulnerabilidades que os maliciosos, mas empregam diferentes cargas úteis.

O conjunto resultante de simulações de ataque é dirigido ao mesmo endereço que o pedido malicioso original. No entanto, o módulo oferece flexibilidade para [redirecionar essas solicitações de teste para destinos alternativos](running-test-on-staging.md), como ambientes de teste ou desenvolvimento.

Ao analisar respostas aos pedidos de teste, o módulo determina a vulnerabilidade a determinados [tipos de ataque](../../attacks-vulns-list.md). As vulnerabilidades descobertas são catalogadas na seção [**Vulnerabilidades**](../../user-guides/vulnerabilities.md) da interface do usuário do Console Wallarm. Além disso, você tem a opção de receber [notificações](../../user-guides/settings/integrations/integrations-intro.md) sobre essas descobertas.

O diagrama a seguir mostra como o módulo funciona:

![Esquema de ATV](../../images/vulnerability-detection/active-threat-verification-scheme-prod.png)

As solicitações geradas carregam o cabeçalho `User-Agent: Wallarm Threat-Verification (v1.x)`, ajudando a diferenciá-las de outras solicitações.

### Segurança da solicitação de teste

O módulo de Verificação de Ameaça Ativa é projetado para criar solicitações de teste da maneira mais segura possível, apresentando as seguintes características-chave:

* As cargas úteis maliciosas das solicitações geradas não incluem sintaxe maliciosa real, elas são apenas para imitar o princípio do ataque. Como resultado, eles não prejudicam seus recursos.
* Cabeçalhos de autenticação como `Cookie`, `Authorization: Basic` e `Viewstate` são excluídos das solicitações reproduzidas. Além disso, conforme orientado pelos [cabeçalhos de autenticação personalizados](modify-requests-before-replay.md#replacing-original-authentication-data-with-test-data) e pela [regra de mascaramento](../../user-guides/rules/sensitive-data-rule.md), quaisquer cabeçalhos adicionais podem ser adaptados ou removidos conforme necessário.

### Exemplo

Considere a seguinte solicitação GET semelhante à do mundo real inicialmente detectada pelo nó de filtragem Wallarm e enviada para a Nuvem:

```bash
https://example.com/login&user=UNION SELECT username, password
```

A partir da solicitação, o módulo aprende os seguintes detalhes:

* A URL atacada é `https://example.com/login`
* O tipo de ataque usado é SQLi (de acordo com a carga útil `UNION SELECT username, password`)
* O parâmetro de string de consulta atacado é `user`
* Informação adicional fornecida na solicitação é o parâmetro de string de consulta `token=IyEvYmluL3NoCg` (provavelmente é usado pelo aplicativo para autenticar o usuário)

Com esses dados, o módulo cria uma série de solicitações de teste. Essas solicitações se concentram em possíveis vulnerabilidades de injeção de SQL usando cargas úteis variadas, como:

```bash
https://example.com/login&user=1')+WAITFOR+DELAY+'0 indexpt'+AND+('wlrm'='wlrm
https://example.com/login&user=1+AND+SLEEP(10)--+wlrm
https://example.com/login&user=1);SELECT+PG_SLEEP(10)--
https://example.com/login&user=1'+OR+SLEEP(10)+AND+'wlrm'='wlrm
https://example.com/login&user=1+AND+1=(SELECT+1+FROM+PG_SLEEP(10))
https://example.com/login&user=%23'%23\x22%0a-sleep(10)%23
https://example.com/login&user=1';+WAITFOR+DELAY+'0code:10'--
https://example.com/login&user=1%27%29+OR+SLEEP%280%29+AND+%28%27wlrm%27%3D%27wlrm
https://example.com/login&user=SLEEP(10)/*'XOR(SLEEP(10))OR'|\x22XOR(SLEEP(10))OR\x22*/
```

## Habilitando o módulo

Por padrão, o módulo está desabilitado. Para ativá-lo:

1. Certifique-se de ter um [plano de assinatura](../../about-wallarm/subscription-plans.md#subscription-plans) **Avançado em Segurança de API** ativo. O módulo está disponível apenas neste plano.

    Caso esteja em um plano diferente, entre em contato com nossa [equipe de vendas](mailto:sales@wallarm.com) para fazer a transição para o necessário.
1. Acesse Wallarm Console → **Vulnerabilidades** → **Configure** seguindo o link para [US Cloud](https://us1.my.wallarm.com/vulnerabilities/active?configure=true) or [EU Cloud](https://my.wallarm.com/vulnerabilities/active?configure=true), e ative o interruptor **Verificação de ameaça ativa**.

Você também tem a capacidade de [ajustar ou personalizar o comportamento do módulo](enable-disable-active-threat-verification.md) para pontos de extremidade específicos.

## Limitações

A verificação de ameaças ativas não está disponível para [ataques que consistem em acertos agrupados por IPs originários](../../user-guides/triggers/trigger-examples.md#group-hits-originating-from-the-same-ip-into-one-attack).
