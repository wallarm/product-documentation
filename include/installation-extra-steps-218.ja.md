					## 追加設定

フィルタリングノードは、インストール後に追加の設定が必要な場合があります。

以下のドキュメントには、必要に応じて適用できる典型的なセットアップがいくつか記載されています。

他の利用可能な設定について詳細を知りたい場合は、[アドミニストレータガイド](admin-intro-en.md)の**設定**セクションに進んでください。

### クライアントの実際のIPの表示の設定

フィルタリングノードがプロキシサーバーまたはロードバランサーの背後にデプロイされていて追加の設定がない場合、要求元のアドレスがクライアントの実際のIPアドレスと等しくない可能性があります。代わりに、プロキシサーバーまたはロードバランサーのIPアドレスのいずれかと等しくなる場合があります。

この場合、フィルタリングノードにリクエストの送信元アドレスとしてクライアントのIPアドレスを受け取らせるには、プロキシサーバーまたはロードバランサーの[追加設定](using-proxy-or-balancer-en.md)を実行する必要があります。

### Wallarmスキャナーアドレスを許可リストに追加する

Wallarmスキャナーは、企業のリソースに対して脆弱性を検査します。スキャンは、以下のリストのいずれか（Wallarm Cloudのタイプに応じて）からのIPアドレスを使用して実行されます。

* [USクラウドユーザー向けのUSスキャナーアドレス](scanner-address-us-cloud.md)
* [EUクラウドユーザー向けのEUスキャナーアドレス](scanner-address-eu-cloud.md)

Wallarmスキャナーを使用している場合、ネットワーク範囲のセキュリティソフトウェア（ファイアウォール、侵入検知システムなど）の許可リストにWallarmスキャナーのIPアドレスを含めるように設定する必要があります。

例えば、デフォルト設定のWallarmフィルタリングノードがブロッキングモードに設定されているため、Wallarmスキャナーはフィルタリングノードの背後にあるリソースをスキャンできません。

スキャナーを再び動作させるには、このフィルタリングノードで[スキャナーのIPアドレスを許可リスト](scanner-ips-allowlisting.md)に追加します。

### 単一リクエスト処理時間の制限

[`wallarm_process_time_limit`](configure-parameters-en.md#wallarm_process_time_limit) Wallarmディレクティブを使用して、フィルタリングノードによる1つのリクエストの処理時間の上限を指定します。

リクエストの処理に指定された時間よりも長い時間がかかる場合、エラー情報がログファイルに記録され、「overlimit_res」アタックとしてリクエストがマークされます。

### サーバー応答待ち時間の制限

[`proxy_read_timeout`](https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_read_timeout) NGINXディレクティブを使用して、プロキシサーバーの応答を読むためのタイムアウトを指定します。

サーバーがこの時間内に何も送信しない場合、接続が閉じられます。

### 最大リクエストサイズの制限

[`client_max_body_size`](https://nginx.org/en/docs/http/ngx_http_core_module.html#client_max_body_size) NGINXディレクティブを使用して、クライアントのリクエストの本文の最大サイズの制限を指定します。

この制限を超えると、NGINXはクライアントに対して、`413`（`Payload Too Large`）コード（`Request Entity Too Large`メッセージとも呼ばれる）を返します。